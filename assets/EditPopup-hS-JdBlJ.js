import{_ as q,p as te,r as A,j as w,x as H,w as m,o as G,c as I,a as t,n as M,k as Z,F as de,y as _e,t as j,v as S,g as F,M as ve,G as re,u as he,s as R,h as me,b as ge,e as i,d as T,A as x,K as fe,L as we}from"./index-LFuWRgYK.js";/* empty css                                                             */import{S as f,_ as z}from"./Dialog-C4zQjDOr.js";const ye={class:"menu_list"},be={class:"contents"},xe=["onClick","title"],Se={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(n,{emit:k}){const p=n,u=k,{getClientRect:r}=te(),c=A(null),B=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],d=w(()=>{const{width:_,height:L}=r(document.documentElement),{width:g,height:v}=r(c.value),{x:b,y:D,width:N,height:$}=p.positions??{},E=(D??0)+($??0)/2-(v??0)/2,U=(E<20?20:E)+"px",P=(L??0)-(v??0)-20+"px",W=`min(${U}, ${P})`,J=(b??0)+(g??0)>_,Q=(b??0)+(N??0)+2,K=(b??0)-(g??0)-9-2,V=(J?K:Q)+"px";return{top:W,left:V}}),h=w(()=>{const{width:_}=r(document.documentElement),{width:L}=r(c.value),{x:g,y:v,width:b,height:D}=p.positions??{},N=(v??0)+(D??0)/2,$=(g??0)+(L??0)>_,E=(g??0)+(b??0)+3,U=(g??0)-3.2,P=$?U:E;return{top:N+"px",left:P+"px",turn:$}}),y=_=>{_.target.matches(".menu, .menu *")||u("clear",null)},C=_=>{u("use",{type:_}),u("clear",null)};return(_,L)=>{const g=H("visible");return m((G(),I("div",{class:"menu_container",onClick:y},[t("div",{class:M(["menu_triangle",{"-scale-x-100":h.value.turn}]),style:Z(h.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:Z(d.value),ref_key:"menu",ref:c},[t("ul",ye,[(G(),I(de,null,_e(B,v=>t("li",be,[m(t("button",{class:M(["menu_item",v.class]),onClick:b=>C(v.type),title:v.title},j(v.title),11,xe),[[S,!(["copy","edit","delete"].includes(v.type)&&n.onlyAdd)]])])),64))])],4)])),[[g,n.positions]])}}},Ot=q(Se,[["__scopeId","data-v-e4cfe076"]]),ke={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),Le=[Ce];function $e(n,k){return G(),I("svg",ke,[...Le])}const Ue={name:"ic-round-close",render:$e},Be=["disabled","placeholder"],Ee={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(n,{emit:k}){const p=n,u=k,r=A(null),c=A(""),B=d=>{if(!d.ctrlKey)return;const{selectionStart:h,selectionEnd:y}=r.value;u("selected",{start:h,end:y})};return F(c,d=>u("update:value",d)),F(()=>p.value,d=>c.value=d,{immediate:!0}),(d,h)=>{const y=H("verify");return m((G(),I("textarea",{class:"scrollbar textarea","onUpdate:modelValue":h[0]||(h[0]=C=>c.value=C),disabled:n.disabled,placeholder:n.disabled?"":n.placeholder,onKeydown:re(B,["q"]),ref_key:"textarea",ref:r},null,40,Be)),[[ve,c.value,void 0,{lazy:!0,trim:!0}],[y,void 0,void 0,{check:!0}]])}}},ee=q(Ee,[["__scopeId","data-v-c1e57f9a"]]),l=n=>(fe("data-v-a30d51d8"),n=n(),we(),n),Oe={class:"popup_window"},Te={class:"popup_header"},Me={class:"popup_close",title:"キャンセル"},Ge={class:"popup_container scrollbar"},Ie={class:"contents"},De={class:"contents"},Ne={class:"popup_label"},Pe=l(()=>t("div",{class:"-col-2"},null,-1)),Ve={class:"contents"},je=l(()=>t("span",{class:"popup_label"},"内容",-1)),Ae={value:""},Ke={class:"contents"},Re={class:"contents"},ze=l(()=>t("span",{class:"popup_label"},"話し手",-1)),Fe={class:"popup_input"},qe={class:"contents"},He=l(()=>t("span",{class:"popup_label"},"話し手",-1)),We={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Je={class:"popup_group"},Qe=l(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Xe={class:"contents"},Ye=l(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),Ze=l(()=>t("option",{value:""},"無指定",-1)),et={class:"contents"},tt=l(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),st=l(()=>t("option",{value:""},"引き継ぎ",-1)),ot={class:"contents"},lt=l(()=>t("span",{class:"popup_label"},"エフェクト",-1)),at=l(()=>t("option",{value:""},"なし",-1)),nt={class:"popup_group"},it=l(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),pt={class:"contents"},ut=l(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),ct=l(()=>t("option",{value:""},"無指定",-1)),dt={class:"contents"},_t=l(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),vt=l(()=>t("option",{value:""},"引き継ぎ",-1)),rt={class:"contents"},ht=l(()=>t("span",{class:"popup_label"},"エフェクト",-1)),mt=l(()=>t("option",{value:""},"なし",-1)),gt={class:"contents"},ft=l(()=>t("span",{class:"popup_label"},"SE",-1)),wt={class:"contents"},yt=l(()=>t("span",{class:"popup_label"},"ボイス",-1)),bt={class:"contents"},xt=l(()=>t("span",{class:"popup_label"},"セリフ",-1)),St={class:"-col-3 grid gap-1"},kt=l(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Ct={class:"contents"},Lt=l(()=>t("span",{class:"popup_label"},"備考",-1)),$t={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(n,{emit:k}){const p=n,u=k,r=he(),{getCharacter:c}=r,{characterList:B,characterReals:d}=R(r),h=me(),{newLog:y}=h,{chapterData:C}=R(h),_=ge(),{blackList:L,getEffect:g,getBackground:v,getCg:b,getBgm:D,getSe:N,getShowList:$}=_,{uiList:E,effectList:U,backgroundList:P,cgList:W,bgmList:J,seList:Q}=R(_),{isDev:K,findData:V}=te(),e=A({}),se=w(()=>{var a;return(a=c(e.value.人物))==null?void 0:a.name}),oe=w(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform},{id:"動畫",show:e.value.is_perform}]),le=w(()=>$(e.value.show_time)),ae=w(()=>B.value.filter(a=>!a.disabled||a.unknown)),ne=w(()=>X(e.value.顯示角色)),ie=w(()=>X(e.value.立ち絵2)),X=a=>{var s;return((s=c(a))==null?void 0:s.sprite)??[]},pe=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},Y=a=>e.value[a]="",ue=()=>{const a={...e.value};if(p.id==="add")u("add",a);else{const O=V(C.value,p.id);Object.assign(O,a)}u("update:open",!1),(!a.is_showtime||a.show_time==="暗場")&&u("target",a.id)},ce=a=>{const s=a.target.matches(".popup_window, .popup_window *"),O=a.target.matches(".popup_close");(!s||O)&&u("update:open",!1)};return F(()=>p.open,a=>{a&&(p.id==="add"?e.value=y(p.type):e.value={...V(C.value,p.id)},K&&console.log({...e.value}))}),(a,s)=>{const O=H("visible");return m((G(),I("section",{class:"popup",onClick:ce},[t("div",Oe,[t("header",Te,[t("button",Me,[i(T(Ue),{class:"pointer-events-none"})])]),t("div",Ge,[m(t("div",Ie,[t("div",De,[t("span",Ne,j(e.value.人物),1),i(f,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:oe.value,onChange:pe},null,8,["value","options"])]),Pe,t("div",Ve,[je,m(i(z,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[S,e.value.show_time==="BGM"]]),m(i(f,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:le.value},{default:x(()=>[t("option",Ae,j(e.value.show_time==="暗場"?"フェード":"なし"),1)]),_:1},8,["value","options"]),[[S,e.value.show_time!=="BGM"]])])],512),[[S,e.value.is_showtime]]),m(t("div",Ke,[m(t("div",Re,[ze,t("span",Fe,j(se.value),1)],512),[[S,e.value.is_announce||e.value.is_system]]),m(t("div",qe,[He,i(f,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:ae.value},null,8,["value","options"])],512),[[S,!(e.value.is_announce||e.value.is_system)]]),t("div",We,[t("button",{class:M(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:M(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:M(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",Je,[Qe,t("div",Xe,[Ye,i(f,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),options:T(d),onChange:s[8]||(s[8]=o=>Y("角色差分"))},{default:x(()=>[Ze]),_:1},8,["value","options"])]),t("div",et,[tt,i(f,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:ne.value},{default:x(()=>[st]),_:1},8,["value","options"])]),t("div",ot,[lt,i(f,{class:"popup_select",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o),options:T(U)},{default:x(()=>[at]),_:1},8,["value","options"])])]),t("div",nt,[it,t("div",pt,[ut,i(f,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),options:T(d),onChange:s[12]||(s[12]=o=>Y("十六夜差分"))},{default:x(()=>[ct]),_:1},8,["value","options"])]),t("div",dt,[_t,i(f,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:ie.value},{default:x(()=>[vt]),_:1},8,["value","options"])]),t("div",rt,[ht,i(f,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o),options:T(U)},{default:x(()=>[mt]),_:1},8,["value","options"])])]),t("div",gt,[ft,i(z,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",wt,[yt,i(z,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",bt,[xt,t("div",St,[i(ee,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),kt])])],512),[[S,!e.value.is_showtime]]),t("div",Ct,[Lt,i(ee,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:ue,title:"保存"},"保存")])])])),[[O,n.open]])}}},Tt=q($t,[["__scopeId","data-v-a30d51d8"]]);export{Tt as E,Ot as M};
