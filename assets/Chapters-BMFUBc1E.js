import{_ as W,r as k,e as K,o as c,c as h,w as v,e7 as ce,a as s,n as _,t as l,e8 as ee,d as ie,s as N,J as re,f as de,j as _e,g as Q,e3 as ue,i as he,l as L,e4 as m,k as X,b as d,u as p,F as V,v as P,e9 as $,e1 as F,d$ as pe,e0 as ve}from"./index-vgp2cxHb.js";import{I as ge}from"./round-close-B-BAJ8Jd.js";import{W as me}from"./Wrap-DPhM4_18.js";import{C as R,D as Y,u as fe}from"./useDrag-Dcx4oOVA.js";import{D as be,M as ye,E as De}from"./Dialog-CQQ6jj2P.js";import{M as we}from"./Mark-BOgdUefH.js";const ke=["disabled"],xe={class:"whitespace-nowrap"},Se={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(i,{emit:D}){const x=i,A=D,g=k(0);return K(g,b=>A("update:value",b)),K(()=>x.value,b=>g.value=b,{immediate:!0}),(b,S)=>(c(),h("label",{class:_(["inline-flex items-center",i.disabled?"cursor-auto":"cursor-pointer"])},[v(s("input",{class:_(["checkbox",i.box]),"onUpdate:modelValue":S[0]||(S[0]=w=>g.value=w),disabled:i.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,ke),[[ce,g.value]]),s("span",xe,l(i.title),1),ee(b.$slots,"default",{},void 0,!0)],2))}},Z=W(Se,[["__scopeId","data-v-b7a95cdd"]]),Ce={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(i){return(D,x)=>(c(),h("button",{class:_(["switch",{"bg-current":i.active}])},[s("span",{class:_(["-mt-0.1em",{"text-white":i.active}])},[ee(D.$slots,"default",{},void 0,!0)],2)],2))}},U=W(Ce,[["__scopeId","data-v-8bd1e4e9"]]),f=i=>(pe("data-v-1b669738"),i=i(),ve(),i),Ie={class:"side_list"},Me={class:"flex"},Le=["onClick","title"],$e={class:"chapter_head"},Ue={class:"mr-9 grid xl:mr-0"},Ae=["title"],Be={class:"chapter_log"},Ee={class:"chapter_log_tr -lock"},Te={class:"mx-2 w-12 self-center"},Ne=f(()=>s("div",{class:"chapter_log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Ve=f(()=>s("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),Pe=f(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"話し手．主人公差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"脇役．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE＆ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),Fe={key:0,class:"contents"},Re=["draggable","onDragstart","onDragend"],We={class:"chapter_log_scene"},je=f(()=>s("div",{class:"chapter_log_switches xl:hidden"},null,-1)),ze={class:"chapter_log_tr_2"},Ge=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Je=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Oe=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),qe={class:"chapter_log_td -col"},He={class:"-inner"},Ke={key:1,class:"contents"},Qe=["draggable","onDragstart","onDragend"],Xe={class:"chapter_log_avatar"},Ye=["src"],Ze={class:"chapter_log_comment"},es={class:"chapter_log_switches"},ss={class:"chapter_log_tr_2"},ts={class:"chapter_log_td -col"},as={key:0,class:"-inner col-span-2"},os={key:1,class:"-inner col-span-2"},ls={class:"-inner"},ns={class:"-inner"},cs={class:"chapter_log_td -col"},is={class:"-inner col-span-2"},rs={class:"-inner"},ds={class:"-inner"},_s={class:"chapter_log_td -col"},us={class:"-inner"},hs={class:"-inner"},ps={class:"chapter_log_td -col"},vs={class:"-inner"},gs={__name:"Chapters",setup(i){const D=ie();N(D);const x=re(),{characterList:A}=N(x),g=de(),{newChapter:b,dialogType:S}=g,{chapterIndex:w,chapterNames:se,chapterTitle:j,chapterData:u}=N(g),{findData:z,findIndex:te}=_e(),{dragMove:ae,dropMove:oe}=fe(),B=o=>z(A.value,o.人物,"name")??{},G=Q(()=>u.value.some(o=>o.dragging)),E=Q(()=>u.value.filter(o=>o.is_selected).map(o=>o.id)),C=(o,t,r)=>{r&&ae(o,{index:t}),E.value.some(n=>u.value[t].id===n)||(u.value[t].is_selected=1),E.value.forEach(n=>{const a=z(u.value,n);a.dragging=r,r||(a.is_selected=0)})},J=(o,t)=>{E.value.forEach(r=>{const e=te(u.value,r);oe(u.value,e,t)})},O=k(!1),I=k(0),q=k(null),M=(o,t)=>{I.value=t,q.value=o,O.value=t===null},le=({type:o})=>{const t=I.value,r=u.value[t];o==="delete"?r.is_delete=!0:o==="edit"?H(r.id,{}):H("add",{type:o})},T=k(!1),y=ue({id:0,type:"",index:0}),H=(o,{type:t})=>{y.id=o,y.type=t??"",y.index=I.value,T.value=!0},ne=o=>{const t=I.value===null?u.value.length:y.index+1;u.value.splice(t,0,o)};return(o,t)=>{const r=he("visible");return c(),L(me,null,{side:m(()=>[s("ul",Ie,[(c(!0),h(V,null,X(p(se),(e,n)=>(c(),h("li",Me,[d(we,{class:"mt-0.6em bg-current/10",active:n===p(w)},null,8,["active"]),s("button",{class:_(["side_item",{"side_item-active":n===p(w)}]),onClick:a=>w.value=n,title:e},l(e),11,Le)]))),256))])]),main_head:m(()=>[s("header",$e,[s("div",Ue,[s("h1",{class:"chapter_head_title",title:p(j)},l(p(j)),9,Ae)])])]),default:m(()=>[s("div",Be,[s("div",Ee,[s("div",Te,[d(U,{class:"relative text-primary bg-primary/25"},{default:m(()=>[d(p(ge),{class:"mt-0.1em"}),d(R,{class:"absolute left-0 top-0 opacity-0",onMore:t[0]||(t[0]=e=>M(e,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Ne,Ve]),Pe,d(Y,{class:"chapter_log_dragline",onDrop:t[1]||(t[1]=e=>J(e,0)),dragging:G.value},null,8,["dragging"]),(c(!0),h(V,null,X(p(u),(e,n)=>(c(),h(V,{key:e.id},[e.is_showtime?v((c(),h("section",Fe,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:a=>C(a,n,!0),onDragend:a=>C(a,n,!1),onDrag:t[2]||(t[2]=$(()=>{},["prevent"])),onDrop:t[3]||(t[3]=$(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[d(Z,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),d(R,{class:"chapter_log_control",onMore:a=>M(a,n),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",We,[s("span",null,l(e.人物),1),s("span",null,l(e.show_time),1),s("span",null,l(e.show_name),1)])],2),je],42,Re),s("div",ze,[Ge,Je,Oe,s("div",qe,[s("div",He,l(e.備註),1)])])],512)),[[P,!e.is_delete]]):v((c(),h("section",Ke,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:a=>C(a,n,!0),onDragend:a=>C(a,n,!1),onDrag:t[4]||(t[4]=$(()=>{},["prevent"])),onDrop:t[5]||(t[5]=$(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[d(Z,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),d(R,{class:"chapter_log_control",onMore:a=>M(a,n),onDel:a=>e.is_delete=!0,hasDel:!1,hasAdd:!1},null,8,["onMore","onDel"]),s("div",{class:_(["chapter_log_info",{"flex-row-reverse":B(e).is_hero,"-replay":e.is_replay}])},[v((c(),h("div",Xe,[s("img",{src:B(e).image_head},null,8,Ye)])),[[r,B(e).image_head]]),s("div",Ze,[d(be,{class:"chapter_log_dialog",value:e.和訳,type:p(S)(e)},null,8,["value","type"])])],2)],2),s("div",es,[v((c(),L(U,{class:_(["chapter_log_switch",{"text-replay":e.is_replay}]),active:e.is_replay,title:"再放送"},{default:m(()=>[F("R")]),_:2},1032,["active","class"])),[[r,e.is_replay]]),v((c(),L(U,{class:_(["chapter_log_switch",{"text-unknown":e.is_unknown}]),active:e.is_unknown,title:"未紹介"},{default:m(()=>[F("U")]),_:2},1032,["active","class"])),[[r,e.is_unknown]]),v((c(),L(U,{class:_(["chapter_log_switch",{"-monolog":e.is_monolog}]),active:e.is_monolog,title:"独り言"},{default:m(()=>[F("S")]),_:2},1032,["active","class"])),[[r,e.is_monolog]])])],42,Qe),s("div",ss,[s("div",ts,[e.is_announce||e.is_system?(c(),h("div",as,l(e.人物),1)):(c(),h("div",os,l(e.人物),1)),s("div",ls,l(e.十六夜差分),1),s("div",ns,l(e.主角特效),1)]),s("div",cs,[s("div",is,l(e.顯示角色),1),s("div",rs,l(e.角色差分),1),s("div",ds,l(e.差分特效),1)]),s("div",_s,[s("div",us,l(e.SE),1),s("div",hs,l(e.Voice),1)]),s("div",ps,[s("div",vs,l(e.備註),1)])])],512)),[[P,!e.is_delete]]),v(d(Y,{class:"chapter_log_dragline",onDrop:a=>J(a,n+1),dragging:G.value},null,8,["onDrop","dragging"]),[[P,!e.is_delete]])],64))),128))]),d(ye,{positions:q.value,onClear:M,onUse:le,onlyAdd:O.value},null,8,["positions","onlyAdd"]),d(De,{open:T.value,"onUpdate:open":t[6]||(t[6]=e=>T.value=e),id:y.id,type:y.type,onAdd:ne},null,8,["open","id","type"])]),_:1})}}},ks=W(gs,[["__scopeId","data-v-1b669738"]]);export{ks as default};
