import{_ as P,l as Q,r as H,h as T,p as j,w as g,o as k,c as S,a as t,n as L,i as W,F as X,q as Y,t as A,v as U,L as Z,d as f,M as ee,f as V,C as te,G as se,N as oe,O as le,u as ae,s as q,g as ne,b as _,B as N,I as ie,J as ue,e as ce}from"./index-SMKVIrGu.js";/* empty css                                                             */import{_ as z}from"./Input-BqRows6N.js";const pe={class:"menu_list"},de={class:"contents"},re=["onClick","title"],ve={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(a,{emit:y}){const d=a,r=y,{getClientRect:h}=Q(),u=H(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],c=T(()=>{const{width:w,height:x}=h(document.documentElement),{width:e,height:m}=h(u.value),{x:$,y:I,width:M,height:B}=d.positions??{},O=(I??0)+(B??0)/2-(m??0)/2,E=(O<20?20:O)+"px",D=(x??0)-(m??0)-20+"px",R=`min(${E}, ${D})`,F=($??0)+(e??0)>w,K=($??0)+(M??0)+2,n=($??0)-(e??0)-9-2,s=(F?n:K)+"px";return{top:R,left:s}}),v=T(()=>{const{width:w}=h(document.documentElement),{width:x}=h(u.value),{x:e,y:m,width:$,height:I}=d.positions??{},M=(m??0)+(I??0)/2,B=(e??0)+(x??0)>w,O=(e??0)+($??0)+3,E=(e??0)-3.2,D=B?E:O;return{top:M+"px",left:D+"px",turn:B}}),l=w=>{w.target.matches(".menu, .menu *")||r("clear",null)},b=w=>{r("use",{type:w}),r("clear",null)};return(w,x)=>{const e=j("visible");return g((k(),S("div",{class:"menu_container",onClick:l},[t("div",{class:L(["menu_triangle",{"-scale-x-100":v.value.turn}]),style:W(v.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:W(c.value),ref_key:"menu",ref:u},[t("ul",pe,[(k(),S(X,null,Y(p,m=>t("li",de,[g(t("button",{class:L(["menu_item",m.class]),onClick:$=>b(m.type),title:m.title},A(m.title),11,re),[[U,!(["copy","edit","delete"].includes(m.type)&&a.onlyAdd)]])])),64))])],4)])),[[e,a.positions]])}}},$t=P(ve,[["__scopeId","data-v-e4cfe076"]]),_e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},he=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),me=[he];function fe(a,y){return k(),S("svg",_e,[...me])}const ge={name:"ic-round-close",render:fe},ye=["disabled","placeholder"],we=["value"],be={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:y}){Z(p=>({c45911e2:f(h).light.text}));const d=a,r=y,{colors:h}=ee(),u=H("");return V(u,p=>r("update:value",p)),V(()=>d.value,p=>u.value=p,{immediate:!0}),(p,c)=>{const v=j("verify");return g((k(),S("select",{class:"select","onUpdate:modelValue":c[0]||(c[0]=l=>u.value=l),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder},[se(p.$slots,"default",{},void 0,!0),(k(!0),S(X,null,Y(a.options,l=>g((k(),S("option",{key:l.id??l.name??l.title??l,value:l.id??l},A(l.name??l.title??l.id??l),9,we)),[[U,l.show??!0]])),128))],8,ye)),[[te,u.value,void 0,{lazy:!0,trim:!0}],[v,void 0,void 0,{check:!0}]])}}},C=P(be,[["__scopeId","data-v-8ba13645"]]),xe=["disabled","placeholder"],ke={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(a,{emit:y}){const d=a,r=y,h=H(null),u=H(""),p=c=>{if(!c.ctrlKey)return;const{selectionStart:v,selectionEnd:l}=h.value;r("selected",{start:v,end:l})};return V(u,c=>r("update:value",c)),V(()=>d.value,c=>u.value=c,{immediate:!0}),(c,v)=>{const l=j("verify");return g((k(),S("textarea",{class:"scrollbar textarea","onUpdate:modelValue":v[0]||(v[0]=b=>u.value=b),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder,onKeydown:le(p,["q"]),ref_key:"textarea",ref:h},null,40,xe)),[[oe,u.value,void 0,{lazy:!0,trim:!0}],[l,void 0,void 0,{check:!0}]])}}},J=P(ke,[["__scopeId","data-v-c1e57f9a"]]),i=a=>(ie("data-v-5f2e8a88"),a=a(),ue(),a),Se={class:"popup_window"},$e={class:"popup_header"},Ce={class:"popup_close",title:"キャンセル"},Ue={class:"popup_container scrollbar"},Te={class:"contents"},Le={class:"contents"},Be={class:"popup_label"},Oe=i(()=>t("div",{class:"-col-2"},null,-1)),Ee={class:"contents"},Ie=i(()=>t("span",{class:"popup_label"},"内容",-1)),Me={class:"contents"},De={class:"contents"},Ge=i(()=>t("span",{class:"popup_label"},"話し手",-1)),Ne={class:"popup_input"},He={class:"contents"},Ve=i(()=>t("span",{class:"popup_label"},"話し手",-1)),Pe={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Re={class:"popup_group"},ze=i(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Ae={class:"contents"},je=i(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),Fe=i(()=>t("option",{value:""},"無指定",-1)),Ke={class:"contents"},qe=i(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),We=i(()=>t("option",{value:""},"継ぐ",-1)),Je={class:"contents"},Qe=i(()=>t("span",{class:"popup_label"},"エフェクト",-1)),Xe={class:"popup_group"},Ye=i(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),Ze={class:"contents"},et=i(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),tt=i(()=>t("option",{value:""},"無指定",-1)),st={class:"contents"},ot=i(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),lt=i(()=>t("option",{value:""},"継ぐ",-1)),at={class:"contents"},nt=i(()=>t("span",{class:"popup_label"},"エフェクト",-1)),it=i(()=>t("option",{value:""},"なし",-1)),ut={class:"contents"},ct=i(()=>t("span",{class:"popup_label"},"SE",-1)),pt={class:"contents"},dt=i(()=>t("span",{class:"popup_label"},"ボイス",-1)),rt={class:"contents"},vt=i(()=>t("span",{class:"popup_label"},"セリフ",-1)),_t={class:"-col-3 grid gap-1"},ht=i(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),mt={class:"contents"},ft=i(()=>t("span",{class:"popup_label"},"備考",-1)),gt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(a,{emit:y}){const d=a,r=y,h=ae(),{getCharacter:u}=h,{characterList:p,characterReals:c}=q(h),v=ne(),{newLog:l}=v,{chapterData:b}=q(v),{isDev:w,findData:x}=Q(),e=H({}),m=T(()=>{var n;return(n=u(e.value.人物))==null?void 0:n.name}),$=T(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform}]),I=[{id:"",title:"全"},{id:"前"},{id:"後"},{id:"續"}],M=T(()=>p.value.filter(n=>!n.disabled||n.unknown)),B=T(()=>E(e.value.顯示角色)),O=T(()=>E(e.value.立ち絵2)),E=n=>{var s;return((s=u(n))==null?void 0:s.sprite)??[]},D=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},R=n=>e.value[n]="",F=()=>{const n={...e.value};if(d.id==="add")r("add",n);else{const G=x(b.value,d.id);Object.assign(G,n)}r("update:open",!1),(!n.is_showtime||n.show_time==="暗場")&&r("target",n.id)},K=n=>{const s=n.target.matches(".popup_window, .popup_window *"),G=n.target.matches(".popup_close");(!s||G)&&r("update:open",!1)};return V(()=>d.open,n=>{n&&(d.id==="add"?e.value=l(d.type):e.value={...x(b.value,d.id)},w&&console.log({...e.value}))}),(n,s)=>{const G=j("visible");return g((k(),S("section",{class:"popup",onClick:K},[t("div",Se,[t("header",$e,[t("button",Ce,[_(f(ge),{class:"pointer-events-none"})])]),t("div",Ue,[g(t("div",Te,[t("div",Le,[t("span",Be,A(e.value.人物),1),_(C,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:$.value,onChange:D},null,8,["value","options"])]),Oe,t("div",Ee,[Ie,g(_(z,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[U,e.value.show_time!=="暗場"]]),g(_(C,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:I},null,8,["value"]),[[U,e.value.show_time==="暗場"]])])],512),[[U,e.value.is_showtime]]),g(t("div",Me,[g(t("div",De,[Ge,t("span",Ne,A(m.value),1)],512),[[U,e.value.is_announce||e.value.is_system]]),g(t("div",He,[Ve,_(C,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:M.value},null,8,["value","options"])],512),[[U,!(e.value.is_announce||e.value.is_system)]]),t("div",Pe,[t("button",{class:L(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:L(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:L(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",Re,[ze,t("div",Ae,[je,_(C,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),options:f(c),onChange:s[8]||(s[8]=o=>R("角色差分"))},{default:N(()=>[Fe]),_:1},8,["value","options"])]),t("div",Ke,[qe,_(C,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:B.value},{default:N(()=>[We]),_:1},8,["value","options"])]),t("div",Je,[Qe,_(z,{class:"popup_input",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o)},null,8,["value"])])]),t("div",Xe,[Ye,t("div",Ze,[et,_(C,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),options:f(c),onChange:s[12]||(s[12]=o=>R("十六夜差分"))},{default:N(()=>[tt]),_:1},8,["value","options"])]),t("div",st,[ot,_(C,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:O.value},{default:N(()=>[lt]),_:1},8,["value","options"])]),t("div",at,[nt,_(C,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o)},{default:N(()=>[it]),_:1},8,["value"])])]),t("div",ut,[ct,_(z,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",pt,[dt,_(z,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",rt,[vt,t("div",_t,[_(J,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),ht])])],512),[[U,!e.value.is_showtime]]),t("div",mt,[ft,_(J,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:F,title:"保存"},"保存")])])])),[[G,a.open]])}}},Ct=P(gt,[["__scopeId","data-v-5f2e8a88"]]),yt={class:"dialog_wrap"},wt=["data-content","innerHTML"],bt={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(a){Z(l=>({"35896f63":f(u).lineHeight,"4d5ca058":f(u).letterSpace,"15be853d":f(u).fontLength,f66c4386:f(p).keyword.dark,"729921a5":f(p).monolog.dark,"0085a039":f(p).announce.dark}));const y=a,d=ce(),{fontFamily:r,fontWeight:h,fontStyle:u}=q(d),{colors:p}=ee(),c=T(()=>{const l=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),b=v("keyword"),x=y.value.replace(l,`<span class="${b}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:y.value.replace(/\[|\]/g,""),html:x}}),v=l=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[l]??"text-white";return(l,b)=>(k(),S("div",{class:L(["dialog",[f(r).dialog,f(h).dialog]])},[t("div",yt,[t("pre",{class:L(v(a.type)),"data-content":c.value.value,innerHTML:c.value.html},null,10,wt)])],2))}},Ut=P(bt,[["__scopeId","data-v-0b46230a"]]);export{Ut as D,Ct as E,$t as M};
