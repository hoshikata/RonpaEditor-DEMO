import{_ as M,E as R,r as z,d as T,k as F,j as H,o as $,c as C,a as c,n as w,G as L,F as j,i as A,t as I,v as P,m as V,H as N,s as W,p as q,h as n}from"./index-lahQZADd.js";import"./Menu.vue_vue_type_style_index_0_scoped_460a9451_lang-DT9hWEFc.js";const J={class:"menu_list"},K={class:"contents"},Q=["onClick"],U={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(i,{emit:h}){const _=i,d=h,{getClientRect:r}=R(),o=z(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：動画",type:"perform_anime"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],f=T(()=>{const{width:e,height:a}=r(document.documentElement),{width:t,height:s}=r(o.value),{x:u,y:x,width:k,height:y}=_.positions??{},v=(x??0)+(y??0)/2-(s??0)/2,b=(v<20?20:v)+"px",S=(a??0)-(s??0)-20+"px",B=`min(${b}, ${S})`,D=(u??0)+(t??0)>e,E=(u??0)+(k??0)+2,G=(u??0)-(t??0)-9-2,O=(D?G:E)+"px";return{top:B,left:O}}),m=T(()=>{const{width:e}=r(document.documentElement),{width:a}=r(o.value),{x:t,y:s,width:u,height:x}=_.positions??{},k=(s??0)+(x??0)/2,y=(t??0)+(a??0)>e,v=(t??0)+(u??0)+3,b=(t??0)-3.2,S=y?b:v;return{top:k+"px",left:S+"px",turn:y}}),l=e=>{e.target.matches(".menu, .menu *")||d("clear",null)},g=e=>{d("use",{type:e}),d("clear",null)};return(e,a)=>{const t=F("visible");return H(($(),C("div",{class:"fixed inset-0 z-50 h-dvh w-dvw overflow-hidden",onClick:l},[c("div",{class:w(["menu_triangle",{"-scale-x-100":m.value.turn}]),style:L(m.value)},null,6),c("div",{class:"menu scrollbar overflow-y-auto",style:L(f.value),ref_key:"menu",ref:o},[c("ul",J,[($(),C(j,null,A(p,s=>c("li",K,[H(c("button",{class:w(["menu_item",s.class]),onClick:u=>g(s.type)},I(s.title),11,Q),[[P,!(s.type==="delete"&&i.onlyAdd)]])])),64))])],4)])),[[t,i.positions]])}}},se=M(U,[["__scopeId","data-v-460a9451"]]),X={class:"dialog_wrap"},Y=["data-content","innerHTML"],Z={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(i){V(l=>({"24a5c46f":n(o).lineHeight,"41caeccc":n(o).letterSpace,"04dada49":n(o).fontLength,a4ee909e:n(p).keyword.dark,c95009ce:n(p).monolog.dark,"20bc1576":n(p).announce.dark}));const h=i,_=N(),{fontFamily:d,fontWeight:r,fontStyle:o}=W(_),{colors:p}=q(),f=T(()=>{const l=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),g=m("keyword"),a=h.value.replace(l,`<span class="${g}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:h.value.replace(/\[|\]/g,""),html:a}}),m=l=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[l]??"text-white";return(l,g)=>($(),C("div",{class:w(["dialog",[n(d).dialog,n(r).dialog]])},[c("div",X,[c("pre",{class:w(m(i.type)),"data-content":f.value.value,innerHTML:f.value.html},null,10,Y)])],2))}},ne=M(Z,[["__scopeId","data-v-f7f8c651"]]);export{ne as D,se as M};
