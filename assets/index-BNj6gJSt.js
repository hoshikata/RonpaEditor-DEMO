import{_ as G,o,c as r,a as c,u as de,b as se,w,v as H,F as R,t as z,d as e,e as u,n as V,f as pe,s as C,r as T,g as B,h as he,i as fe,j as g,k as ie,l as Se,m as ke,p as ce,q as Ce,x as j,y as F,z as oe,A as Ie,B as Be,C as te,D as Q,E as ye,G as De,H as Te}from"./index-CyJrGj8D.js";import{I as we,a as Me,D as Le}from"./IconDelete-CJ2MkJpE.js";import{D as Ne,S as Ee}from"./Dialog-CESR4OxB.js";import{W as He}from"./Wrap-BFrSN4i_.js";import{M as Ue,E as ze}from"./EditPopup-CJ7CgR6S.js";import{A as Re}from"./Aspect-BTyVbZIs.js";import{I as be,U as Ve}from"./UiItem-D-rzUE-A.js";import{R as Ae}from"./Range-Rdt3blBJ.js";import{_ as ne}from"./Image-DSnKcMXH.js";/* empty css                                                             */const je={name:"MdiTarget"},Ge={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Oe=c("path",{fill:"currentColor",d:"M11 2v2.07A8 8 0 0 0 4.07 11H2v2h2.07A8 8 0 0 0 11 19.93V22h2v-2.07A8 8 0 0 0 19.93 13H22v-2h-2.07A8 8 0 0 0 13 4.07V2m-2 4.08V8h2V6.09c2.5.41 4.5 2.41 4.92 4.91H16v2h1.91c-.41 2.5-2.41 4.5-4.91 4.92V16h-2v1.91C8.5 17.5 6.5 15.5 6.08 13H8v-2H6.09C6.5 8.5 8.5 6.5 11 6.08M12 11a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1"},null,-1),Pe=[Oe];function Fe(t,i,n,d,p,m){return o(),r("svg",Ge,Pe)}const qe=G(je,[["render",Fe]]),We={name:"RiShiningFill"},Ke={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Je=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),Qe=[Je];function Xe(t,i,n,d,p,m){return o(),r("svg",Ke,Qe)}const Ye=G(We,[["render",Xe]]),Ze={name:"RiShiningLine"},et={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},tt=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),nt=[tt];function st(t,i,n,d,p,m){return o(),r("svg",et,nt)}const ot=G(Ze,[["render",st]]),at={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},lt=c("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),it=[lt];function ct(t,i){return o(),r("svg",at,[...it])}const rt={name:"ic-round-queue-music",render:ct},ut={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},dt=c("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),pt=[dt];function vt(t,i){return o(),r("svg",ut,[...pt])}const _t={name:"ic-sharp-keyboard-voice",render:vt},gt={class:"contents"},mt={class:"preview_log_head"},ht={class:"preview_log_title"},ft={class:"preview_log_subtitle !text-base"},yt={class:"preview_log_content"},wt={class:"preview_log_foot"},bt={class:"preview_log_head"},$t={class:"shrink-0 font-medium"},xt={class:"preview_log_subtitle text-xs leading-none"},St={class:"h-1em"},kt={class:"h-1em"},Ct={class:"preview_log_content"},It={class:"preview_log_foot"},Bt={class:"preview_log_mark_1"},Dt={class:"preview_log_mark_1"},Tt={class:"preview_log_mark_1"},Mt={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:i}){const n=i,d=de(),{getCharacter:p,getSprite:m}=d,f=se(),{getShowName:v}=f;return(h,a)=>w((o(),r("article",{class:V(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(o(),r(R,{key:0},[c("div",gt,[c("header",mt,[c("h6",ht,z(t.log.人物),1),c("p",ft,z(t.log.show_time),1)]),c("p",yt,z(e(v)(t.log.show_time,t.log.show_name)),1)]),c("footer",wt,[c("button",{class:"preview_button ml-auto",onClick:a[0]||(a[0]=s=>n("edit")),title:"編集"},[u(be,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:a[1]||(a[1]=s=>n("delete")),title:"削除"},[u(we,{class:"text-[0.9em]"})])])],64)):(o(),r(R,{key:1},[c("button",{class:"group contents",onClick:a[2]||(a[2]=s=>{n("update:id",t.log.id),n("stop")})},[c("header",bt,[c("h6",$t,z(e(p)(t.log.人物).name),1),c("p",xt,[c("span",St,z(e(p)(t.log.顯示角色).name)+" / "+z(e(m)(t.log.顯示角色,t.log.十六夜差分).name),1),c("span",kt,z(e(p)(t.log.立ち絵2).name)+" / "+z(e(m)(t.log.立ち絵2,t.log.角色差分).name),1)])]),c("p",Ct,z(t.log.和訳),1)]),c("footer",It,[w(c("span",Bt,"R",512),[[H,t.log.is_replay]]),w(c("span",Dt,"U",512),[[H,t.log.is_unknown]]),w(c("span",Tt,"S",512),[[H,t.log.is_monolog]]),w(u(Ye,{class:"preview_log_mark_2"},null,512),[[H,t.log.差分特效]]),w(u(ot,{class:"preview_log_mark_2"},null,512),[[H,t.log.主角特效]]),w(u(e(rt),{class:"preview_log_mark_2"},null,512),[[H,t.log.SE]]),w(u(e(_t),{class:"preview_log_mark_2"},null,512),[[H,t.log.Voice]]),c("button",{class:"preview_button ml-auto",onClick:a[3]||(a[3]=s=>n("edit")),title:"編集"},[u(be,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:a[4]||(a[4]=s=>n("delete")),title:"削除"},[u(we,{class:"text-[0.9em]"})])])],64))],2)),[[H,!t.log.is_delete]])}},Lt=G(Mt,[["__scopeId","data-v-57d4ef86"]]),Nt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Et=c("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),Ht=[Et];function Ut(t,i){return o(),r("svg",Nt,[...Ht])}const zt={name:"ic-baseline-stop",render:Ut},Rt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Vt=c("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),At=[Vt];function jt(t,i){return o(),r("svg",Rt,[...At])}const Gt={name:"ic-baseline-play-arrow",render:jt},Ot={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pt=c("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),Ft=[Pt];function qt(t,i){return o(),r("svg",Ot,[...Ft])}const $e={name:"ic-baseline-skip-previous",render:qt},Wt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Kt=c("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),Jt=[Kt];function Qt(t,i){return o(),r("svg",Wt,[...Jt])}const Xt={name:"ic-baseline-fullscreen",render:Qt},Yt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Zt=c("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),en=[Zt];function tn(t,i){return o(),r("svg",Yt,[...en])}const nn={name:"ic-baseline-fullscreen-exit",render:tn},sn={class:"preview_control"},on=["disabled"],an=["disabled"],ln={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:i}){const n=t,d=i,p=pe(),{fullscreen:m,fontIntervals:f}=C(p),v=T(0);B(v,a=>d("update:index",a)),B(()=>n.index,a=>v.value=a,{immediate:!0});const h=()=>{const a=v.value;!n.play||n.black||setTimeout(()=>{const s=v.value>=n.length&&!n.black;n.index===a&&n.play&&!n.black&&!n.typing&&!s&&(v.value+=1),s&&d("update:play",!1),h()},f.value.sentence)};return B(()=>n.play,h),B(()=>n.typing,h),(a,s)=>(o(),r("div",sn,[c("button",{class:"preview_button",onClick:s[0]||(s[0]=y=>{v.value-=1,d("stop")}),disabled:v.value===0,title:"前へ"},[u(e($e))],8,on),c("button",{class:"preview_button",onClick:s[1]||(s[1]=y=>d("update:play",!t.play)),title:"プレイ"},[w(u(e(Gt),null,null,512),[[H,!t.play]]),w(u(e(zt),null,null,512),[[H,t.play]])]),c("button",{class:"preview_button",onClick:s[2]||(s[2]=y=>{v.value+=1,d("stop")}),disabled:v.value===t.length,title:"次へ"},[u(e($e),{class:"-scale-x-100"})],8,an),u(Ae,{class:"mx-3 grow !bg-dark-text",value:v.value,"onUpdate:value":s[3]||(s[3]=y=>v.value=y),onChange:s[4]||(s[4]=y=>d("stop")),min:0,max:t.length,step:1},null,8,["value","max"]),c("button",{class:"preview_button",onClick:s[5]||(s[5]=y=>m.value=!e(m)),title:"全画面モード"},[w(u(e(Xt),null,null,512),[[H,!e(m)]]),w(u(e(nn),null,null,512),[[H,e(m)]])])]))}},cn=G(ln,[["__scopeId","data-v-643d0245"]]),rn={__name:"Comment",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:i}){const n=t,d=i,p=pe(),{fontIntervals:m}=C(p),f=he(),{dialogType:v}=f,{getDialogStyle:h}=fe(),a=T({}),s=T(0),y=g(()=>a.value.和訳??""),x=g(()=>n.play?y.value.slice(0,s.value):y.value),L=g(()=>h(n.ui)),M=()=>{y.value&&(d("update:typing",!0),s.value=0)},I=()=>{if(!n.play||n.black)return;if(s.value===y.value.length)return d("update:typing",!1);setTimeout(()=>{n.typing?s.value+=1:s.value=y.value.length},m.value.word)};return B(()=>n.data,b=>{b.is_showtime||(a.value=b)}),B(a,M),B(y,I),B(x,I),B(s,I),B(()=>n.black,b=>{b||I()}),(b,N)=>(o(),r("article",{class:"preview_dialog",style:ie(L.value)},[u(Ne,{value:x.value,type:e(v)(t.data)},null,8,["value","type"])],4))}},un=G(rn,[["__scopeId","data-v-7dd70b74"]]),ae=Se("log",()=>{const t=ke(),i=he(),{chapterData:n}=C(i),d=de(),{characterHero:p}=C(d),m=se(),{getUI:f,getHistoryList:v}=m,{defaultUI:h,defaultUIForCG:a}=C(m),{findData:s,findIndex:y}=ce(),x=T(0),L=T(0),M=T({}),I=g(()=>n.value.filter(l=>!l.is_delete)),b=g(()=>I.value.filter(l=>{const S=!l.is_showtime,U=l.is_perform&&l.show_time==="暗場";return S||U})),N=g(()=>{const l=y(I.value,x.value)+1,S=I.value.slice(0,l),U=I.value.slice(l);return U.every(O=>O.is_showtime&&O.show_time!=="暗場")&&S.push(...U),S});B(x,l=>{const S=s(n.value,l)??{};S.is_scene||(M.value=S,L.value=y(b.value,S.id))}),B(L,l=>{var S;return x.value=((S=b.value[l])==null?void 0:S.id)??0}),B(n,()=>{var l;return x.value=((l=b.value[0])==null?void 0:l.id)??0}),Ce(()=>{var l;return x.value=((l=b.value[0])==null?void 0:l.id)??0});const D=g(()=>{const l=v(N.value,"CG");return((l==null?void 0:l.show_name)??"")!==""&&(l==null?void 0:l.show_name)!=="結束"}),E=g(()=>{const l=v(N.value,"UI"),S=(l==null?void 0:l.show_name)??h.value??"";return D.value?a.value:S}),X=g(()=>f(E.value)),Y=g(()=>{const l=X.value,S=M.value,U=p.value.name,K=S.人物,O=l.sprite_number===2,ue=S.is_monolog&&l.name_tag_solo_show,_e=K===U&&l.name_tag_hero_right,ge=K===S.顯示角色&&l.name_tag_sprite_1_right,k=K===S.立ち絵2&&l.name_tag_sprite_2_right;return O&&(ue||_e||ge||k)}),J=g(()=>{const l=M.value,S=l.is_system||l.is_announce||l.is_monolog,U=l.is_monolog&&X.value.name_tag_solo_show;return!S||U}),q=g(()=>!Y.value&&J.value),W=g(()=>Y.value&&J.value),A=T(!1),ve=T(!1),re=T(!1),Z=g(()=>({"":A.value}));return B(()=>t.name,()=>A.value=!1),{logId:x,logIndex:L,logData:M,logShowing:I,logContents:b,logHistory:N,logCGMode:D,logUIId:E,logUI:X,isNameRight:Y,isNameShow:J,nameTag1Show:q,nameTag2Show:W,logPlay:A,logTyping:ve,logBlack:re,playEase:Z}}),dn={class:"-ui bg-black",id:"Background"},pn={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,n=ae(),{playEase:d}=C(n),p=se(),{getHistoryList:m}=p,{backgroundList:f}=C(p),v=g(()=>{var h;return(h=m(i.contents,"BG"))==null?void 0:h.show_name});return(h,a)=>{const s=j("opacity");return o(),r("div",dn,[(o(!0),r(R,null,F(e(f),y=>w((o(),oe(ne,{class:V(["-ui",e(d)]),src:y.path},null,8,["src","class"])),[[s,y.id===v.value]])),256))])}}},vn={class:"-ui",id:"Effect"},_n={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const i=ae(),{playEase:n}=C(i),d=se(),{effectList:p}=C(d);return(m,f)=>{const v=j("opacity");return o(),r("div",vn,[(o(!0),r(R,null,F(e(p),h=>w((o(),oe(ne,{class:V(["-ui",e(n)]),src:h.path,alt:h.name},null,8,["src","class","alt"])),[[v,h.id===t.data[t.name]]])),256))])}}},gn=["data-name"],mn={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Object],default:()=>({})},num:{type:[Number],default:1}},setup(t){const i=t,n=de(),{getSpriteNow:d}=n,{characterList:p}=C(n),m=ae(),{logCGMode:f,playEase:v}=C(m);ce();const{getMask:h,geSpritePosition:a,geSpriteSize:s}=fe(),y={1:{name:"顯示角色",sprite:"角色差分",effect:"差分特效"},2:{name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"}},x=g(()=>y[i.num]??{}),L=g(()=>f.value?"人物":x.value.name),M=g(()=>d(i.contents,i.data[x.value.name],L.value,x.value.sprite)),I=g(()=>i.num===2?i.ui.sprite_number===2:!0),b=g(()=>"sprite_"+i.num),N=g(()=>h(i.ui[b.value].mask)),D=g(()=>a(i.ui[b.value])),E=g(()=>s(i.ui[b.value]));return(X,Y)=>{const J=j("visible"),q=j("opacity");return w((o(),r("div",{class:V(["-ui -mask",e(v)]),id:"Sprite",style:ie(N.value)},[c("div",{class:"sprite_container",style:ie(D.value)},[c("div",{class:"sprite_inner",style:ie(E.value)},[(o(!0),r(R,null,F(e(p),W=>w((o(),r("div",{key:W.id,class:V(["-ui",e(v)]),"data-name":W.name},[(o(!0),r(R,null,F(W.sprite??[],A=>w((o(),oe(ne,{key:A.id,class:"sprite",src:A.path},null,8,["src"])),[[J,A.id===M.value]])),128))],10,gn)),[[q,W.id===t.data[L.value]]])),128))],4)],4),u(_n,{name:x.value.effect,data:t.data},null,8,["name","data"])],6)),[[q,I.value]])}}},xe=G(mn,[["__scopeId","data-v-7cc679fc"]]),hn={class:"-ui bg-black",id:"CG"},fn={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,n=se(),{getHistoryList:d}=n,{cgList:p}=C(n),m=g(()=>{var f;return(f=d(i.contents,"CG"))==null?void 0:f.show_name});return(f,v)=>{const h=j("opacity");return o(),r("div",hn,[(o(!0),r(R,null,F(e(p),a=>w((o(),oe(ne,{class:"-ui !object-cover",src:a.path},null,8,["src"])),[[h,a.id===m.value]])),256))])}}},yn={class:"-ui",id:"UI"},wn={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Number,String],default:()=>""}},setup(t){const i=ae(),{nameTag1Show:n,nameTag2Show:d,playEase:p}=C(i),m=se(),{uiList:f}=C(m);return ce(),(v,h)=>{const a=j("opacity");return o(),r("div",yn,[(o(!0),r(R,null,F(e(f),s=>w((o(),oe(Ve,{class:V(["-ui",e(p)]),data:s,nameTag1Show:e(n),nameTag2Show:e(d)},null,8,["data","nameTag1Show","nameTag2Show","class"])),[[a,s.id===t.ui]])),256)),w(c("div",{class:V(["-ui -replay",e(p)])},null,2),[[a,t.data.is_replay]])])}}},bn=G(wn,[["__scopeId","data-v-40cdaa15"]]),$n={class:"-ui",id:"NameTag"},xn={class:"-ui"},Sn={class:"name_tag -font"},kn={class:"-ui"},Cn={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})}},setup(t){const i=t,n=pe(),{fontFamily:d,fontWeight:p}=C(n),m=de(),{getCharacter:f}=m,{characterList:v}=C(m),h=ae(),{isNameRight:a,isNameShow:s}=C(h),{findData:y}=ce(),{getNameTagStyle:x}=fe(),L=g(()=>f(i.data.人物)),M=g(()=>y(v.value,0)),I=g(()=>{const b=a.value?"name_tag_2":"name_tag_1";return x(i.ui[b])});return(b,N)=>{const D=j("opacity");return o(),r("div",$n,[w((o(),r("div",{class:V(["absolute",[e(d).nameTag,e(p).nameTag]]),style:ie(I.value)},[w((o(),r("div",xn,[(o(!0),r(R,null,F(e(v),E=>w((o(),r("div",{key:E.id,class:"-ui"},[w((o(),r("p",Sn,[Ie(z(E.name),1)])),[[D,!E.image_name]]),w(u(ne,{class:"name_tag",src:E.image_name},null,8,["src"]),[[D,E.image_name]])])),[[D,E.id===L.value.id]])),128))])),[[D,!t.data.is_unknown]]),w((o(),r("div",kn,[u(ne,{class:"name_tag",src:M.value.image_name},null,8,["src"])])),[[D,t.data.is_unknown]])],6)),[[D,e(s)]])])}}},In=G(Cn,[["__scopeId","data-v-2434f77d"]]),Bn=3e3,Dn={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:black"],setup(t,{emit:i}){const n=t,d=i,p=g(()=>n.data.show_time==="暗場"),m=T({}),f=g(()=>(m.value.show_name??"").split(",")),v=g(()=>!f.value.includes("前")),h=g(()=>!f.value.includes("後"));g(()=>f.value.includes("續"));const a=T(!1),s=T(!1),y=()=>{if(p.value){if(m.value={...n.data},s.value=n.play&&v.value,a.value=!0,d("update:black",!0),!n.play)return;setTimeout(()=>{n.index>=n.length||d("update:index",n.index+1)},Bn)}else s.value=n.play&&h.value,a.value=!1,d("update:black",!1)};return B(p,y),B(()=>n.play,y),(x,L)=>{const M=j("opacity");return w((o(),r("div",{class:V(["-ui z-20 bg-black",{"duration-1000":s.value}]),id:"Black"},null,2)),[[M,a.value]])}}},Tn={class:"preview_title"},Mn=["value"],Ln=["onDragstart","onDragend","data-id"],Nn={class:"-ui"},En={__name:"index",setup(t){const i=pe(),{fullscreen:n}=C(i),d=he(),{chapterIndex:p,chapterNames:m,chapterData:f}=C(d),v=ae(),{logId:h,logIndex:a,logData:s,logContents:y,logHistory:x,logCGMode:L,logUIId:M,logUI:I,logPlay:b,logTyping:N,logBlack:D,playEase:E}=C(v),{getClientRect:X}=ce(),{dragMove:Y,dropMove:J}=Te(),q=()=>{b.value=!1,N.value=!1};B(p,q);const W=g(()=>f.value.some(k=>k.dragging)),A=(k,_,ee)=>{ee&&Y(k,{index:_}),f.value[_].dragging=ee},ve=(k,_)=>J(f.value,k.index,_),re=T(null),Z=()=>{const k=[...re.value].find(me=>me.dataset.id*1===h.value);if(!k)return;const{height:_,top:ee}=X(k);k.parentElement.scrollBy({top:ee-_,behavior:"smooth"})};B(h,()=>{b.value&&Z()});const l=T(null);B(n,k=>{window.api?window.api.fullscreen(k):k?l.value.requestFullscreen():document.exitFullscreen()});const S=T(null),U=k=>S.value=k,K=T(!1),O=Be({id:0,type:""}),ue=(k,{type:_})=>{O.id=k,O.type=_??"",K.value=!0},_e=k=>f.value.push(k),ge=k=>{h.value=k,setTimeout(Z,100)};return(k,_)=>{const ee=j("opacity"),me=j("visible");return o(),oe(He,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:te(()=>[u(Ue,{positions:S.value,onClear:U,onUse:_[0]||(_[0]=$=>ue("add",$)),onlyAdd:!0},null,8,["positions"]),c("section",Tn,[u(Ee,{class:"preview_title_select",value:e(p),"onUpdate:value":_[1]||(_[1]=$=>Q(p)?p.value=$:null)},{default:te(()=>[(o(!0),r(R,null,F(e(m),($,le)=>(o(),r("option",{value:le},z($),9,Mn))),256))]),_:1},8,["value"]),w(c("button",{class:"preview_button",onClick:Z,title:"今の画面のセリフへ"},[u(qe)],512),[[H,!e(n)]]),c("button",{class:"preview_button",onClick:U,title:"新規"},[u(e(Me))])])]),side:te(()=>[(o(!0),r(R,null,F(e(f),($,le)=>(o(),r("div",{key:$.id,class:V(["relative",{"-dragging":$.dragging}]),draggable:!0,onDragstart:P=>A(P,le,!0),onDragend:P=>A(P,le,!1),onDrag:_[3]||(_[3]=ye(()=>{},["prevent"])),onDrop:_[4]||(_[4]=ye(()=>{},["prevent"])),"data-id":$.id,ref_for:!0,ref_key:"logElem",ref:re},[u(Lt,{id:e(h),"onUpdate:id":_[2]||(_[2]=P=>Q(h)?h.value=P:null),log:$,onEdit:P=>ue($.id,{}),onDelete:P=>$.is_delete=!0,onStop:q},null,8,["id","log","onEdit","onDelete"]),u(Le,{class:"preview_dragline !h-1 !text-secondary/50",onDrop:P=>ve(P,le+1),dragging:W.value},null,8,["onDrop","dragging"])],42,Ln))),128))]),default:te(()=>[c("div",{class:"preview",onKeydown:_[10]||(_[10]=De($=>b.value=!e(b),["space"])),tabindex:"0",ref_key:"preview",ref:l},[u(Re,{box:"lattice"},{outer:te(()=>[u(cn,{index:e(a),"onUpdate:index":_[8]||(_[8]=$=>Q(a)?a.value=$:null),play:e(b),"onUpdate:play":_[9]||(_[9]=$=>Q(b)?b.value=$:null),typing:e(N),black:e(D),length:e(y).length-1,onTarget:Z,onStop:q},null,8,["index","play","typing","black","length"])]),default:te(()=>[w((o(),r("div",Nn,[u(pn,{contents:e(x)},null,8,["contents"]),u(xe,{data:e(s),contents:e(x),ui:e(I),num:1},null,8,["data","contents","ui"]),u(xe,{data:e(s),contents:e(x),ui:e(I),num:2},null,8,["data","contents","ui"]),w(u(fn,{contents:e(x),class:V(e(E))},null,8,["contents","class"]),[[ee,e(L)]]),u(bn,{data:e(s),contents:e(x),ui:e(M)},null,8,["data","contents","ui"])])),[[me,e(f).length]]),u(In,{data:e(s),ui:e(I)},null,8,["data","ui"]),u(un,{data:e(s),ui:e(I),play:e(b),typing:e(N),"onUpdate:typing":_[5]||(_[5]=$=>Q(N)?N.value=$:null),black:e(D)},null,8,["data","ui","play","typing","black"]),u(Dn,{index:e(a),"onUpdate:index":_[6]||(_[6]=$=>Q(a)?a.value=$:null),data:e(s),play:e(b),black:e(D),"onUpdate:black":_[7]||(_[7]=$=>Q(D)?D.value=$:null),length:e(y).length-1},null,8,["index","data","play","black","length"])]),_:1})],544),u(ze,{open:K.value,"onUpdate:open":_[11]||(_[11]=$=>K.value=$),id:O.id,type:O.type,onAdd:_e,onTarget:ge},null,8,["open","id","type"])]),_:1})}}},Fn=G(En,[["__scopeId","data-v-90155ebc"]]);export{Fn as default};
