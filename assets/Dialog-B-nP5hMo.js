import{_ as L,h as j,r as D,g as G,i as H,w as h,o as k,c as $,a as t,n as E,U as z,F as R,j as A,t as B,v as T,e as I,e9 as F,ea as K,u as b,eb as W,e3 as Z,e6 as ee,ec as te,H as se,s as N,f as oe,b as m,d_ as le,d$ as ae,d as ne}from"./index-D6QnUoO4.js";import{a as ie}from"./round-close-PnnluxDo.js";const ue={class:"menu_list"},ce={class:"contents"},pe=["onClick"],de={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(l,{emit:f}){const d=l,r=f,{getClientRect:u}=j(),a=D(null),i=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],c=G(()=>{const{width:e,height:x}=u(document.documentElement),{width:y,height:g}=u(a.value),{x:C,y:M,width:O,height:p}=d.positions??{},s=(M??0)+(p??0)/2-(g??0)/2,S=(s<20?20:s)+"px",o=(x??0)-(g??0)-20+"px",q=`min(${S}, ${o})`,J=(C??0)+(y??0)>e,Q=(C??0)+(O??0)+2,X=(C??0)-(y??0)-9-2,Y=(J?X:Q)+"px";return{top:q,left:Y}}),v=G(()=>{const{width:e}=u(document.documentElement),{width:x}=u(a.value),{x:y,y:g,width:C,height:M}=d.positions??{},O=(g??0)+(M??0)/2,p=(y??0)+(x??0)>e,s=(y??0)+(C??0)+3,S=(y??0)-3.2,o=p?S:s;return{top:O+"px",left:o+"px",turn:p}}),n=e=>{e.target.matches(".menu, .menu *")||r("clear",null)},w=e=>{r("use",{type:e}),r("clear",null)};return(e,x)=>{const y=H("visible");return h((k(),$("div",{class:"menu_container",onClick:n},[t("div",{class:E(["menu_triangle",{"-scale-x-100":v.value.turn}]),style:z(v.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:z(c.value),ref_key:"menu",ref:a},[t("ul",ue,[(k(),$(R,null,A(i,g=>t("li",ce,[h(t("button",{class:E(["menu_item",g.class]),onClick:C=>w(g.type)},B(g.title),11,pe),[[T,!(["edit","delete"].includes(g.type)&&l.onlyAdd)]])])),64))])],4)])),[[y,l.positions]])}}},it=L(de,[["__scopeId","data-v-dfb3886d"]]),re=["disabled","placeholder"],U={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){const d=l,r=f,u=D("");return I(u,a=>r("update:value",a)),I(()=>d.value,a=>u.value=a,{immediate:!0}),(a,i)=>{const c=H("verify");return h((k(),$("input",{"onUpdate:modelValue":i[0]||(i[0]=v=>u.value=v),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},null,8,re)),[[F,u.value,void 0,{lazy:!0,trim:!0}],[c,void 0,void 0,{check:!0}]])}}},ve=["disabled","placeholder"],_e=["value"],me={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){K(i=>({"4ad1a84a":b(u).light.text}));const d=l,r=f,{colors:u}=W(),a=D("");return I(a,i=>r("update:value",i)),I(()=>d.value,i=>a.value=i,{immediate:!0}),(i,c)=>{const v=H("verify");return h((k(),$("select",{class:"select","onUpdate:modelValue":c[0]||(c[0]=n=>a.value=n),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},[ee(i.$slots,"default",{},void 0,!0),(k(!0),$(R,null,A(l.options,n=>h((k(),$("option",{value:n.id??n},B(n.title??n.id??n),9,_e)),[[T,n.show??!0]])),256))],8,ve)),[[Z,a.value,void 0,{lazy:!0,trim:!0}],[v,void 0,void 0,{check:!0}]])}}},V=L(me,[["__scopeId","data-v-1b98bee5"]]),he=["disabled","placeholder"],P={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(l,{emit:f}){const d=l,r=f,u=D(null),a=D(""),i=c=>{if(!c.ctrlKey)return;const{selectionStart:v,selectionEnd:n}=u.value;r("selected",{start:v,end:n})};return I(a,c=>r("update:value",c)),I(()=>d.value,c=>a.value=c,{immediate:!0}),(c,v)=>{const n=H("verify");return h((k(),$("textarea",{class:"scrollbar min-h-0 resize-none","onUpdate:modelValue":v[0]||(v[0]=w=>a.value=w),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder,onKeydown:te(i,["q"]),ref_key:"textarea",ref:u},null,40,he)),[[F,a.value,void 0,{lazy:!0,trim:!0}],[n,void 0,void 0,{check:!0}]])}}},_=l=>(le("data-v-d3fa0fe4"),l=l(),ae(),l),fe={class:"popup_window"},ye={class:"popup_header"},ge={class:"popup_close",title:"キャンセル"},we={class:"popup_container scrollbar"},be={class:"contents"},xe={class:"contents"},Se={class:"popup_label"},ke=_(()=>t("div",{class:"-col-2"},null,-1)),$e={class:"contents"},Ce=_(()=>t("span",{class:"popup_label"},"内容",-1)),Ue={class:"contents"},Te={class:"contents"},Be=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Ee={class:"popup_input"},Ie={class:"contents"},De=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Me=_(()=>t("div",{class:"-col-2"},null,-1)),Oe={class:"contents"},Ge=_(()=>t("span",{class:"popup_label"},B(`主人公
差分`),-1)),He={class:"contents"},Le=_(()=>t("span",{class:"popup_label"},B(`主人公
エフェクト`),-1)),Ve={class:"contents"},Ne=_(()=>t("span",{class:"popup_label"},"脇役",-1)),ze={class:"contents"},Pe=_(()=>t("span",{class:"popup_label"},B(`脇役
差分`),-1)),je={class:"contents"},Re=_(()=>t("span",{class:"popup_label"},B(`脇役
エフェクト`),-1)),Ae={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Fe={class:"contents"},Ke=_(()=>t("span",{class:"popup_label"},"セリフ",-1)),We={class:"-col-3 grid gap-1"},qe=_(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Je={class:"contents"},Qe=_(()=>t("span",{class:"popup_label"},"SE",-1)),Xe={class:"contents"},Ye=_(()=>t("span",{class:"popup_label"},"ボイス",-1)),Ze={class:"contents"},et=_(()=>t("span",{class:"popup_label"},"備考",-1)),tt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(l,{emit:f}){const d=l,r=f,u=se(),{characterList:a}=N(u),i=oe(),{newChapter:c}=i,{chapterData:v}=N(i),{isDev:n,findData:w}=j(),e=D({}),x=G(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform},{id:"動畫",show:e.value.is_perform}]),y=[{id:"",title:"全"},{id:"前"},{id:"後"},{id:"續"}],g=G(()=>a.value.map(p=>({id:p.name}))),C=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},M=()=>{const p={...e.value};if(d.id==="add")r("add",p);else{const S=w(v.value,d.id);Object.assign(S,p)}r("update:open",!1),(!p.is_showtime||p.show_time==="暗場")&&r("target",p.id)},O=p=>{const s=p.target.matches(".popup_window, .popup_window *"),S=p.target.matches(".popup_close");(!s||S)&&r("update:open",!1)};return I(()=>d.open,p=>{p&&(d.id==="add"?e.value=c(d.type):e.value={...w(v.value,d.id)},n&&console.log({...e.value}))}),(p,s)=>{const S=H("visible");return h((k(),$("div",{class:"popup",onClick:O},[t("section",fe,[t("header",ye,[t("button",ge,[m(b(ie),{class:"pointer-events-none"})])]),t("div",we,[h(t("div",be,[t("div",xe,[t("span",Se,B(e.value.人物),1),m(V,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:x.value,onChange:C},null,8,["value","options"])]),ke,t("div",$e,[Ce,h(m(U,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[T,e.value.show_time!=="暗場"]]),h(m(V,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:y},null,8,["value"]),[[T,e.value.show_time==="暗場"]])])],512),[[T,e.value.is_showtime]]),h(t("div",Ue,[h(t("div",Te,[Be,t("span",Ee,B(e.value.人物),1)],512),[[T,e.value.is_announce||e.value.is_system]]),h(t("div",Ie,[De,m(V,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:g.value},null,8,["value","options"])],512),[[T,!(e.value.is_announce||e.value.is_system)]]),Me,t("div",Oe,[Ge,m(U,{class:"popup_input",value:e.value.十六夜差分,"onUpdate:value":s[4]||(s[4]=o=>e.value.十六夜差分=o)},null,8,["value"])]),t("div",He,[Le,m(U,{class:"popup_input",value:e.value.主角特效,"onUpdate:value":s[5]||(s[5]=o=>e.value.主角特效=o)},null,8,["value"])]),t("div",Ve,[Ne,m(U,{class:"popup_input",value:e.value.顯示角色,"onUpdate:value":s[6]||(s[6]=o=>e.value.顯示角色=o)},null,8,["value"])]),t("div",ze,[Pe,m(U,{class:"popup_input",value:e.value.角色差分,"onUpdate:value":s[7]||(s[7]=o=>e.value.角色差分=o)},null,8,["value"])]),t("div",je,[Re,m(U,{class:"popup_input",value:e.value.差分特效,"onUpdate:value":s[8]||(s[8]=o=>e.value.差分特效=o)},null,8,["value"])]),t("div",Ae,[t("button",{class:E(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[9]||(s[9]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:E(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[10]||(s[10]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未紹介"},"未紹介",2),t("button",{class:E(["popup_switch -monolog",{"-active":e.value.is_solo}]),onClick:s[11]||(s[11]=o=>e.value.is_solo=!e.value.is_solo),title:"独り言"},"独り言",2)]),t("div",Fe,[Ke,t("div",We,[m(P,{class:"popup_input h-24",value:e.value.和訳,"onUpdate:value":s[12]||(s[12]=o=>e.value.和訳=o)},null,8,["value"]),qe])]),t("div",Je,[Qe,m(U,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[13]||(s[13]=o=>e.value.SE=o)},null,8,["value"])]),t("div",Xe,[Ye,m(U,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[14]||(s[14]=o=>e.value.Voice=o)},null,8,["value"])])],512),[[T,!e.value.is_showtime]]),t("div",Ze,[et,m(P,{class:"popup_input -col-3 h-24",value:e.value.備註,"onUpdate:value":s[15]||(s[15]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:M,title:"セーフ"},"セーフ")])])])),[[S,l.open]])}}},ut=L(tt,[["__scopeId","data-v-d3fa0fe4"]]),st={class:"dialog_wrap"},ot=["data-content","innerHTML"],lt={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(l){K(n=>({"35896f63":b(a).lineHeight,"4d5ca058":b(a).letterSpace,"15be853d":b(a).fontLength,f66c4386:b(i).keyword.dark,"729921a5":b(i).monolog.dark,"0085a039":b(i).announce.dark}));const f=l,d=ne(),{fontFamily:r,fontWeight:u,fontStyle:a}=N(d),{colors:i}=W(),c=G(()=>{const n=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),w=v("keyword"),x=f.value.replace(n,`<span class="${w}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:f.value.replace(/\[|\]/g,""),html:x}}),v=n=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[n]??"text-white";return(n,w)=>(k(),$("div",{class:E(["dialog",[b(r).dialog,b(u).dialog]])},[t("div",st,[t("pre",{class:E(v(l.type)),"data-content":c.value.value,innerHTML:c.value.html},null,10,ot)])],2))}},ct=L(lt,[["__scopeId","data-v-0b46230a"]]);export{ct as D,ut as E,it as M};
