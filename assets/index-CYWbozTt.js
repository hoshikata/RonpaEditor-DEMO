import{o as m,c as x,a as t,_ as z,I as Oe,n as A,J as He,i as _e,s as V,u as ge,b as me,x as ye,h as j,B as Me,r as te,K as Pe,p as Ue,w as U,d as e,e as a,v as W,y as E,F as ae,l as be,L as Ce,M as xe,t as ve,m as X,z as we,A as Ne,N as je,g as Re,D as Le,H as Fe,G as Ge}from"./index-DBARMjmE.js";import{I as We,a as Ee,D as qe}from"./IconDelete-BsHnlf2I.js";import{W as ze}from"./Wrap-DsHyu44a.js";import{C as ke}from"./Control-sDiVfQBu.js";import{C as Ve,I as Je,u as Ke,M as Qe,E as Xe}from"./EditPopup-ClxmCY4b.js";import{M as Ye}from"./Mark-ZxPvN643.js";import{R as Ze,_ as $e}from"./Radio-tpYqKclP.js";import{S as Q,D as et}from"./Dialog-6znKXEuY.js";import{A as tt}from"./Avatar-DiDTwhA4.js";import"./round-drag-indicator-yHH11VNL.js";/* empty css                                                             */import"./Image-BmY2dVDH.js";const st={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ot=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),lt=[ot];function nt(s,g){return m(),x("svg",st,[...lt])}const at={name:"ic-round-close",render:nt},it={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(s){return(g,h)=>(m(),x("button",{class:A(["switch",{"bg-current":s.active}])},[t("span",{class:A(["-mt-0.1em",{"text-white":s.active}])},[Oe(g.$slots,"default",{},void 0,!0)],2)],2))}},pe=z(it,[["__scopeId","data-v-8bd1e4e9"]]),ct={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},rt=t("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"},null,-1),ut=[rt];function dt(s,g){return m(),x("svg",ct,[...ut])}const he={name:"ic-round-search",render:dt},pt={name:"MaterialSymbolsFindReplaceRounded"},ht={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},vt=t("path",{fill:"currentColor",d:"M11 6q-1.575 0-2.838.863T6.35 9.125q-.15.375-.487.563t-.738.112t-.638-.387t-.112-.663q.675-2.1 2.475-3.425T11 4q1.475 0 2.763.562T16 6.1V5q0-.425.288-.712T17 4t.713.288T18 5v4q0 .425-.288.713T17 10h-4q-.425 0-.712-.288T12 9t.288-.712T13 8h2q-.725-.9-1.737-1.45T11 6m0 12q-1.475 0-2.762-.562T6 15.9V17q0 .425-.288.713T5 18t-.712-.288T4 17v-4q0-.425.288-.712T5 12h4q.425 0 .713.288T10 13t-.288.713T9 14H7q.725.9 1.738 1.45T11 16q1.55 0 2.788-.825T15.6 13q.175-.4.513-.638t.762-.162q.425.1.625.45t.075.75q-.175.5-.413.938t-.562.862l3.7 3.7q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-3.7-3.7q-.9.675-1.962 1.038T11 18"},null,-1),_t=[vt];function gt(s,g,h,w,k,q){return m(),x("svg",ht,_t)}const Se=z(pt,[["render",gt]]),Ie=He("search",()=>{const s=_e(),{initSelected:g}=s,{chapterData:h}=V(s),w=ge(),{getCharacter:k,getSprite:q}=w,{characterList:T}=V(w),y=me(),{getShowList:D}=y,{effectList:J,seList:R}=V(y),{copyObject:f,findData:_}=ye(),I=j(()=>{let o=h.value;const{type:l,result:p}=Y.value;return l===0&&(o=ee(p)),l===1&&(o=ce(p)),l===2&&(o=re(p)),o}),i=j(()=>I.value.map(o=>o.id)),B=Me({type:0,keyword:{value:"",rep:""},show:{parent:"",child:"",rep:""},items:[{parent:"",child:""}],itemsRep:{parent:"",child:"",rep:""},open:!1}),Y=te({}),se=j(()=>{const o=[];return T.value.forEach(l=>{const p=(l.sprite??[]).map(v=>({id:l.id+"_"+v.id,name:l.name+"："+v.name}));o.push(...p)}),o}),F=o=>{let l=[];const p=["人物","顯示角色","立ち絵2"].includes(o),v=["角色差分","十六夜差分"].includes(o),S=["差分特效","主角特效"].includes(o);return p&&(l=T.value),v&&(l=se.value),S&&(l=J.value),o==="SE"&&(l=R.value),l},oe=()=>{B.keyword={value:"",rep:""},B.show={parent:"",child:"",rep:""},B.items=[{parent:"",child:""}],B.itemsRep={parent:"",child:"",value:""},B.type=0,Z()},le=()=>{const{type:o,keyword:l,show:p,items:v,itemsRep:S}=B;let C={};return o===0&&(C={result:l.value,rep:l.rep}),o===1&&(C={result:f(p),rep:p.rep}),o===2&&(C={result:f(v),rep:f(S)}),{type:o,...C}},Z=()=>{Y.value=le(),g(h.value),B.open=!1},O=()=>{const o=le();o.value=o;const{type:l,result:p,rep:v}=o;l===0&&fe(p,v),l===1&&ie(p,v),l===2&&K(p,v),g(h.value),oe(),B.open=!1};Pe(Z);const u=(o,l)=>{const p=D(o)??[],v=_(p,l);return p.length?l!==""&&!v:!1},N=(o,l)=>{const p=F(o)??[],v=_(p,l);return p.length?l!==""&&!v:!1},c=(o,l)=>{const p={角色差分:"顯示角色",十六夜差分:"立ち絵2"},v=o[p[l]],S=o[l],C=k(v).sprite??[],d=q(v,S),r=C.length?S!==""&&d.id===void 0:!1;return{name:p[l],group:v,value:S,isErr:r}},H=o=>o.some(l=>!(l.parent===""&&l.child==="")),M=o=>{let[l,p]=o.split("_");return[l*1,p*1]},G=(o,l,p)=>o===""?!0:o==="err"?l:p,ee=o=>(o=o??"",o===""?h.value:h.value.filter(l=>l.和訳.match(o))),ce=({parent:o,child:l})=>o===""&&l===""?h.value:h.value.filter(p=>{const{is_showtime:v,show_time:S,show_name:C}=p;if(!v||!(o===""?!0:S===o))return!1;const r=u(S,C);return G(l,r,C===l)}),re=o=>H(o)?h.value.filter(p=>p.is_showtime?!1:o.every(v=>{const{parent:S,child:C}=v;if(["角色差分","十六夜差分"].includes(S)){const[r,n]=M(C),{group:L,value:b,isErr:ue}=c(p,S);return G(C,ue,L===r&&b===n)}else{const r=p[S],n=N(S,r);return G(C,n,r===C)}})):h.value,fe=(o,l)=>{o=o??"",o!==""&&i.value.forEach(p=>{const v=_(h.value,p);v.和訳=v.和訳.replace(o,l)})},ie=({parent:o,child:l},p)=>{if(o===""&&l==="")return h.value;i.value.forEach(v=>{const S=_(h.value,v),{is_showtime:C,show_time:d,show_name:r}=S;if(!C)return;const n=u(d,r);G(l,n,d===o&&r===l)&&(S.show_name=p)})},K=(o,{parent:l,child:p,rep:v})=>{H(o)&&i.value.forEach(C=>{const d=_(h.value,C);if(d.is_showtime)return;if(["角色差分","十六夜差分"].includes(l)){const[n,L]=M(p),[b,ue]=M(v),{name:ne,group:de,value:Be,isErr:Ae}=c(d,l);G(p,Ae,de===n&&Be===L)&&(d[ne]=b,d[l]=ue)}else{const n=d[l],L=N(l,n);G(p,L,n===p)&&(d[l]=v)}})};return{chapterFilter:I,search:B,searchResult:Y,getSpriteEmpty:H,getChildOptions:F,initSearch:oe,submitSearch:Z,submitReplace:O,keywordSearch:ee,showSearch:ce,itemsSearch:re}}),$=s=>(Ce("data-v-6203deb1"),s=s(),xe(),s),mt={class:"popup_window"},ft={class:"popup_container scrollbar"},wt={class:"mb-8 flex justify-center"},St={class:"popup_keyword_group"},bt=$(()=>t("span",null,null,-1)),$t=["disabled"],yt=$(()=>t("span",null,"を",-1)),Ct=$(()=>t("span",null,"に置き換える",-1)),xt=["disabled"],kt={class:"popup_show_group"},It=$(()=>t("span",null,null,-1)),Tt=$(()=>t("option",{value:""},"全て",-1)),Rt=$(()=>t("span",null,"の",-1)),Lt=$(()=>t("option",{value:""},"全て",-1)),Et=$(()=>t("option",{class:"-error",value:"err"},"エラーバリュー",-1)),qt=["disabled"],Dt=$(()=>t("span",null,"を",-1)),Mt=$(()=>t("option",{value:""},"全て",-1)),Ut=$(()=>t("option",{class:"-error",value:"err"},"エラーバリュー",-1)),Vt=$(()=>t("span",{class:"col-span-2"},"に置き換える",-1)),Bt=["disabled"],At={class:"contents"},Ot={class:"popup_items_group"},Ht={class:"popup_search_group"},Pt={class:"text-right"},Nt=$(()=>t("option",{value:""},"全て",-1)),jt=$(()=>t("span",null,"の",-1)),Ft=$(()=>t("option",{value:""},"全て",-1)),Gt={class:"-error",value:"err"},Wt=["onClick"],zt={class:"popup_search"},Jt=["disabled"],Kt={class:"popup_replace"},Qt=$(()=>t("option",{value:""},"全て",-1)),Xt=$(()=>t("span",null,"の",-1)),Yt=$(()=>t("option",{value:""},"全て",-1)),Zt={class:"-error",value:"err"},es=$(()=>t("span",null,"を",-1)),ts=$(()=>t("option",{value:""},"なし",-1)),ss=$(()=>t("span",null,"に置き換える",-1)),os=["disabled"],ls={class:"popup_footer"},ns={__name:"Search",emits:["goTop"],setup(s,{emit:g}){const h=ge();V(h);const w=me(),{getEffect:k,getSe:q,getVoice:T,getShowList:y}=w;V(w);const D=Ie(),{getSpriteEmpty:J,getChildOptions:R,initSearch:f,submitSearch:_,submitReplace:I}=D,{search:i,chapterFilter:B}=V(D),Y=j(()=>J(i.value.items)),se=[{id:"UI"},{id:"BG"},{id:"BGM"},{id:"CG"},{id:"暗場"}],F=[{id:"人物",name:"話し手"},{id:"顯示角色",name:"立ち絵1名前"},{id:"角色差分",name:"立ち絵1差分"},{id:"差分特效",name:"立ち絵1エフェクト"},{id:"立ち絵2",name:"立ち絵2名前"},{id:"十六夜差分",name:"立ち絵2差分"},{id:"主角特效",name:"立ち絵2エフェクト"},{id:"SE"},{id:"Voice"}],oe=()=>i.value.items.push({parent:"",child:""}),le=O=>i.value.items.splice(O,1),Z=O=>{const u=O.target.matches(".popup_window, .popup_window *"),N=O.target.matches(".popup_close");!O.target.matches(".popup_remove")&&(!u||N)&&(i.value.open=!1)};return(O,u)=>{const N=Ue("visible");return U((m(),x("section",{class:"popup",onClick:Z},[t("div",mt,[t("div",ft,[t("div",wt,[a(Ze,{class:"popup_radio",value:e(i).type,"onUpdate:value":u[0]||(u[0]=c=>e(i).type=c),list:[{id:0,title:"セリフ"},{id:1,title:"切り替え＆演出"},{id:2,title:"項目"}],name:"type"},null,8,["value"])]),U(t("div",St,[bt,a($e,{class:"popup_input col-span-2",value:e(i).keyword.value,"onUpdate:value":u[1]||(u[1]=c=>e(i).keyword.value=c),placeholder:"キーワード"},null,8,["value"]),t("button",{class:"popup_submit",onClick:u[2]||(u[2]=(...c)=>e(_)&&e(_)(...c)),disabled:e(i).keyword.value==="",title:"サーチ"},[a(e(he))],8,$t),yt,a($e,{class:"popup_input",value:e(i).keyword.rep,"onUpdate:value":u[3]||(u[3]=c=>e(i).keyword.rep=c)},null,8,["value"]),Ct,t("button",{class:"popup_submit",onClick:u[4]||(u[4]=(...c)=>e(I)&&e(I)(...c)),disabled:e(i).keyword.value==="",title:"置き換える"},[a(Se,{class:"text-[1.2em]"})],8,xt)],512),[[W,e(i).type===0]]),U(t("div",kt,[It,a(Q,{class:"popup_select",value:e(i).show.parent,"onUpdate:value":u[5]||(u[5]=c=>e(i).show.parent=c),options:se,onChange:u[6]||(u[6]=c=>{e(i).show.child="",e(i).show.rep=""})},{default:E(()=>[Tt]),_:1},8,["value"]),Rt,a(Q,{class:"popup_select",value:e(i).show.child,"onUpdate:value":u[7]||(u[7]=c=>e(i).show.child=c),options:e(y)(e(i).show.parent)},{default:E(()=>[Lt,Et]),_:1},8,["value","options"]),t("button",{class:"popup_submit",onClick:u[8]||(u[8]=(...c)=>e(_)&&e(_)(...c)),disabled:e(i).show.parent===""&&e(i).show.child==="",title:"サーチ"},[a(e(he))],8,qt),Dt,a(Q,{class:"popup_select",value:e(i).show.rep,"onUpdate:value":u[9]||(u[9]=c=>e(i).show.rep=c),options:e(y)(e(i).show.parent)},{default:E(()=>[Mt,Ut]),_:1},8,["value","options"]),Vt,t("button",{class:"popup_submit",onClick:u[10]||(u[10]=(...c)=>e(I)&&e(I)(...c)),disabled:e(i).show.rep==="",title:"置き換える"},[a(Se,{class:"text-[1.2em]"})],8,Bt)],512),[[W,e(i).type===1]]),U(t("div",At,[t("div",Ot,[(m(!0),x(ae,null,be(e(i).items,(c,H)=>(m(),x("div",Ht,[U(t("button",{class:"popup_submit",onClick:oe,title:"条件を追加"},"条件を追加",512),[[W,!H]]),U(t("span",Pt,"と",512),[[W,H]]),a(Q,{class:"popup_select",value:c.parent,"onUpdate:value":M=>c.parent=M,options:F,onChange:M=>c.child=""},{default:E(()=>[Nt]),_:2},1032,["value","onUpdate:value","onChange"]),jt,a(Q,{class:"popup_select",value:c.child,"onUpdate:value":M=>c.child=M,options:e(R)(c.parent)},{default:E(()=>[Ft,U(t("option",Gt,"エラーバリュー",512),[[W,c.parent!==""]])]),_:2},1032,["value","onUpdate:value","options"]),U((m(),x("button",{class:"popup_remove",onClick:M=>le(H),title:"削除"},[a(e(at))],8,Wt)),[[N,H]])]))),256)),t("div",zt,[t("button",{class:"popup_submit",onClick:u[11]||(u[11]=(...c)=>e(_)&&e(_)(...c)),disabled:!Y.value,title:"サーチ"},[a(e(he))],8,Jt)])]),t("div",Kt,[a(Q,{class:"popup_select",value:e(i).itemsRep.parent,"onUpdate:value":u[12]||(u[12]=c=>e(i).itemsRep.parent=c),options:F,onChange:u[13]||(u[13]=c=>{e(i).itemsRep.child="",e(i).itemsRep.rep=""})},{default:E(()=>[Qt]),_:1},8,["value"]),Xt,a(Q,{class:"popup_select",value:e(i).itemsRep.child,"onUpdate:value":u[14]||(u[14]=c=>e(i).itemsRep.child=c),options:e(R)(e(i).itemsRep.parent)},{default:E(()=>[Yt,U(t("option",Zt,"エラーバリュー",512),[[W,e(i).itemsRep.parent!==""]])]),_:1},8,["value","options"]),es,a(Q,{class:"popup_select",value:e(i).itemsRep.rep,"onUpdate:value":u[15]||(u[15]=c=>e(i).itemsRep.rep=c),options:e(R)(e(i).itemsRep.parent)},{default:E(()=>[ts]),_:1},8,["value","options"]),ss,t("button",{class:"popup_submit",onClick:u[16]||(u[16]=(...c)=>e(I)&&e(I)(...c)),disabled:e(i).itemsRep.parent===""&&e(i).itemsRep.child===""||e(i).itemsRep.rep==="",title:"置き換える"},[a(Se,{class:"text-[1.2em]"})],8,os)])],512),[[W,e(i).type===2]])]),t("footer",ls,[t("button",{class:"popup_submit -cancel",onClick:u[17]||(u[17]=(...c)=>e(f)&&e(f)(...c)),title:"キャンセル"},"キャンセル")])])])),[[N,e(i).open]])}}},as=z(ns,[["__scopeId","data-v-6203deb1"]]),is={name:"MaterialSymbolsArrowWarmUpRounded"},cs={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},rs=t("path",{fill:"currentColor",d:"M12 13q-.425 0-.712-.288T11 12V5.825L7.1 9.7q-.275.275-.687.288T5.7 9.7q-.275-.275-.275-.7t.275-.7l5.6-5.6q.15-.15.325-.212T12 2.425t.375.063t.325.212l5.6 5.6q.275.275.275.688T18.3 9.7q-.3.3-.712.3t-.713-.3L13 5.825V12q0 .425-.288.713T12 13m0 5q-.425 0-.712-.288T11 17v-1q0-.425.288-.712T12 15t.713.288T13 16v1q0 .425-.288.713T12 18m0 4q-.425 0-.712-.288T11 21t.288-.712T12 20t.713.288T13 21t-.288.713T12 22"},null,-1),us=[rs];function ds(s,g,h,w,k,q){return m(),x("svg",cs,us)}const De=z(is,[["render",ds]]),ps={class:"chapter_head"},hs=["disabled"],vs=["disabled"],_s={__name:"Head",setup(s){const g=_e(),{deleteChapter:h,moveChapter:w}=g,{chapterIndex:k,chapterLength:q,chapterTarget:T,chapterData:y}=V(g),D=Ie(),{search:J,searchResult:R}=V(D);return(f,_)=>(m(),x("header",ps,[a($e,{class:"chapter_head_title",value:e(T).title,"onUpdate:value":_[0]||(_[0]=I=>e(T).title=I),placeholder:"タイトル"},null,8,["value"]),t("button",{class:A(["chapter_head_button",{"-active":e(R).result}]),onClick:_[1]||(_[1]=I=>e(J).open=!0),title:"サーチ"},[a(e(he),{class:"!text-xl"})],2),t("button",{class:"chapter_head_button",onClick:_[2]||(_[2]=I=>e(w)(-1)),disabled:!e(k),title:"上に移動"},[a(De)],8,hs),t("button",{class:"chapter_head_button",onClick:_[3]||(_[3]=I=>e(w)(1)),disabled:!e(q)||e(k)===e(q)-1,title:"下に移動"},[a(De,{class:"-scale-y-100"})],8,vs),t("button",{class:"chapter_head_button",onClick:_[4]||(_[4]=(...I)=>e(h)&&e(h)(...I)),title:"削除"},[a(We)])]))}},gs=z(_s,[["__scopeId","data-v-23626d87"]]),ms={__name:"Inner",props:{value:{type:[Number,String],default:void 0},list:{type:[Array],default:()=>[]},type:{type:[String],default:""}},setup(s){const g=s,{findData:h}=ye(),w=j(()=>h(g.list,g.value)),k=j(()=>g.list.length?g.value!==""&&!w.value:!1),q=j(()=>({"-showtime":g.type==="showtime","!bg-red-500/50":k.value}));return(T,y)=>{var D;return m(),x("div",{class:A(["inner",q.value])},ve(((D=w.value)==null?void 0:D.name)??s.value),3)}}},P=z(ms,[["__scopeId","data-v-11a9e61f"]]),fs=s=>(Ce("data-v-f1131323"),s=s(),xe(),s),ws={class:"chapter log_scene"},Ss=fs(()=>t("div",{class:"chapter log_switches xl:!hidden"},null,-1)),bs={__name:"logShowHead",props:{log:{type:[Object],default:()=>({})}},emits:["more"],setup(s,{emit:g}){const h=g,w=me(),{getShowList:k}=w;return(q,T)=>(m(),x(ae,null,[t("div",{class:A(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[a(Ve,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":T[0]||(T[0]=y=>s.log.is_selected=y)},null,8,["value"]),a(ke,{class:"chapter log_control",onMore:T[1]||(T[1]=y=>h("more",y)),hasDel:!1,hasAdd:!1}),t("div",ws,[t("span",null,ve(s.log.人物),1),t("span",null,ve(s.log.show_time),1),a(P,{value:s.log.show_name,list:e(k)(s.log.show_time),type:"showtime"},null,8,["value","list"])])],2),Ss],64))}},$s=z(bs,[["__scopeId","data-v-f1131323"]]),ys={class:"chapter log_tr_2"},Cs=t("div",{class:"chapter log_td -col"},null,-1),xs=t("div",{class:"chapter log_td -col"},null,-1),ks=t("div",{class:"chapter log_td -col"},null,-1),Is={class:"chapter log_td -col"},Ts={__name:"logShowBody",props:{log:{type:[Object],default:()=>({})}},setup(s){return(g,h)=>(m(),x("div",ys,[Cs,xs,ks,t("div",Is,[a(P,{value:s.log.備註},null,8,["value"])])]))}},Rs={class:"chapter log_comment"},Ls={class:"chapter log_switches"},Es={__name:"logCommentHead",props:{log:{type:[Object],default:()=>({})}},emits:["more","target"],setup(s,{emit:g}){const h=s,w=g,k=ge(),{getCharacter:q}=k,T=_e(),{dialogType:y}=T,D=j(()=>q(h.log.人物));return(J,R)=>{const f=Ue("visible");return m(),x(ae,null,[t("div",{class:A(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[a(Ve,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":R[0]||(R[0]=_=>s.log.is_selected=_)},null,8,["value"]),a(ke,{class:"chapter log_control",onMore:R[2]||(R[2]=_=>w("more",_)),onDel:R[3]||(R[3]=_=>s.log.is_delete=!0),hasAdd:!1},{top:E(()=>[t("button",{class:"control_button",onClick:R[1]||(R[1]=_=>w("target")),title:"プレビューのセリフ画面へ"},[a(Je,{class:"text-xl"})])]),_:1}),t("div",{class:A(["chapter log_info",{"flex-row-reverse":D.value.is_hero,"-replay":s.log.is_replay}])},[a(tt,{class:"chapter log_avatar",name:D.value.name??s.log.人物},null,8,["name"]),t("div",Rs,[a(et,{class:"chapter log_dialog",value:s.log.和訳,type:e(y)(s.log)},null,8,["value","type"])])],2)],2),t("div",Ls,[U((m(),X(pe,{class:A(["chapter log_switch",{"text-replay":s.log.is_replay}]),active:s.log.is_replay,title:"再放送"},{default:E(()=>[we("R")]),_:1},8,["active","class"])),[[f,s.log.is_replay]]),U((m(),X(pe,{class:A(["chapter log_switch",{"text-unknown":s.log.is_unknown}]),active:s.log.is_unknown,title:"未解明"},{default:E(()=>[we("U")]),_:1},8,["active","class"])),[[f,s.log.is_unknown]]),U((m(),X(pe,{class:A(["chapter log_switch",{"-monolog":s.log.is_monolog}]),active:s.log.is_monolog,title:"独り言"},{default:E(()=>[we("S")]),_:1},8,["active","class"])),[[f,s.log.is_monolog]])])],64)}}},qs=z(Es,[["__scopeId","data-v-60d9644e"]]),Ds={class:"chapter log_tr_2"},Ms={class:"chapter log_td -col"},Us={class:"chapter log_td -col"},Vs={class:"chapter log_td -col"},Bs={class:"chapter log_td -col"},As={__name:"logCommentBody",props:{log:{type:[Object],default:()=>({})}},setup(s){const g=ge(),{getCharacter:h}=g,{characterList:w}=V(g),k=me(),{effectList:q,seList:T,voiceList:y}=V(k);return(D,J)=>(m(),x("div",Ds,[t("div",Ms,[a(P,{class:"col-span-2",value:s.log.顯示角色,list:e(w)},null,8,["value","list"]),a(P,{value:s.log.角色差分,list:e(h)(s.log.顯示角色).sprite},null,8,["value","list"]),a(P,{value:s.log.差分特效,list:e(q)},null,8,["value","list"])]),t("div",Us,[a(P,{class:"col-span-2",value:s.log.立ち絵2,list:e(w)},null,8,["value","list"]),a(P,{value:s.log.十六夜差分,list:e(h)(s.log.立ち絵2).sprite},null,8,["value","list"]),a(P,{value:s.log.主角特效,list:e(q)},null,8,["value","list"])]),t("div",Vs,[a(P,{value:s.log.SE,list:e(T)},null,8,["value","list"]),a(P,{value:s.log.Voice,list:e(y)},null,8,["value","list"])]),t("div",Bs,[a(P,{value:s.log.備註},null,8,["value"])])]))}},Te=s=>(Ce("data-v-d18e9c6a"),s=s(),xe(),s),Os={class:"side_list"},Hs={class:"flex"},Ps=["onClick","title"],Ns={class:"chapter log"},js={class:"chapter log_tr -lock"},Fs={class:"mx-1 w-14 self-center"},Gs=Te(()=>t("div",{class:"chapter log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Ws=Te(()=>t("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),zs=Te(()=>t("div",{class:"chapter log_tr_2 -lock"},[t("div",{class:"chapter log_th -col"},"立ち絵1．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"立ち絵2．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"SE＆ボイス"),t("div",{class:"chapter log_th -col"},"備考")],-1)),Js={class:"contents"},Ks=["onDragstart","onDragend"],Qs={__name:"index",setup(s){const g=Ne(),h=je(),w=_e(),{newChapter:k,deleteChapter:q,moveChapter:T}=w,{chapterIndex:y,chapterNames:D,chapterLength:J,chapterTarget:R,chapterData:f}=V(w),_=Ke(),{newLogId:I}=_,{logId:i}=V(_),B=Ie(),{chapterFilter:Y}=V(B),{findData:se,findIndex:F,getClientRect:oe}=ye(),{dragMove:le,dropMove:Z}=Fe(),O=j(()=>f.value.some(d=>d.dragging)),u=j(()=>f.value.filter(d=>d.is_selected&&!d.is_delete).map(d=>d.id)),N=(d,r,n)=>{const L=se(f.value,r),b=f.value.indexOf(L);n&&le(d,{index:b}),u.value.some(ne=>ne===r)||(L.is_selected=1),u.value.forEach(ne=>{const de=se(f.value,ne);de.dragging=n,n||(de.is_selected=0)})},c=(d,r)=>{const n=r===null?0:F(f.value,r)+1;u.value.forEach(L=>{const b=F(f.value,L);Z(f.value,b,n)})},H=te(!1),M=te(0),G=te(null),ee=(d,r)=>{const n=F(f.value,r);M.value=r!==void 0&&n===-1?null:n,G.value=d,H.value=r===null},ce=({type:d})=>{const r=M.value,n=f.value[r];d==="delete"?fe(n):d==="edit"?o(n.id,{}):d==="copy"?re(n,r+1):o("add",{type:d})},re=(d,r)=>{f.value.splice(r+1,0,{...d,id:I()})},fe=d=>{d.is_delete=!0,u.value.forEach(r=>r.is_delete=!0)},ie=te(!1),K=Me({id:0,type:"",index:0}),o=(d,{type:r})=>{K.id=d,K.type=r??"",K.index=M.value,ie.value=!0},l=d=>{const r=M.value===null?f.value.length:K.index+1;f.value.splice(r,0,d)},p=te(null),v=te({}),S=()=>{Ge(()=>{const d=v.value[i.value];if(!d)return;const{height:r,top:n}=oe(d);p.value.mainScroll({top:n-r*2,left:0})})},C=d=>{i.value=d,h.push({name:"Preview"})};return Re(y,S),Re(()=>g.name,d=>{d==="Chapters"&&S()}),(d,r)=>(m(),X(ze,{ref_key:"wrap",ref:p},{side_foot:E(()=>[t("button",{class:"chapter_add",onClick:r[0]||(r[0]=(...n)=>e(k)&&e(k)(...n)),title:"新規"},[a(e(Ee))])]),side:E(()=>[t("ul",Os,[(m(!0),x(ae,null,be(e(D),(n,L)=>(m(),x("li",Hs,[a(Ye,{class:"chapter_mark",active:L===e(y)},null,8,["active"]),t("button",{class:A(["side_item",{"side_item-active":L===e(y)}]),onClick:b=>y.value=L,title:n},ve(n),11,Ps)]))),256))])]),main_head:E(()=>[a(gs)]),default:E(()=>[t("div",Ns,[t("div",js,[t("div",Fs,[a(pe,{class:"chapter_plus",title:"新規"},{default:E(()=>[a(e(Ee),{class:"mt-0.1em"}),a(ke,{class:"absolute left-0 top-0 opacity-0",onMore:r[1]||(r[1]=n=>ee(n,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Gs,Ws]),zs,a(qe,{class:"chapter log_dragline",onDrop:r[2]||(r[2]=n=>c(n,null)),dragging:O.value},null,8,["dragging"]),(m(!0),x(ae,null,be(e(Y),(n,L)=>(m(),x(ae,{key:n.id},[U(t("section",Js,[t("div",{class:A(["chapter log_tr",{"-dragging":n.dragging}]),draggable:!0,onDragstart:b=>N(b,n.id,!0),onDragend:b=>N(b,n.id,!1),onDrag:r[3]||(r[3]=Le(()=>{},["prevent"])),onDrop:r[4]||(r[4]=Le(()=>{},["prevent"])),ref_for:!0,ref:b=>v.value[n.id]=b},[n.is_showtime?(m(),X($s,{key:0,log:n,onMore:b=>ee(b,n.id)},null,8,["log","onMore"])):(m(),X(qs,{key:1,log:n,onMore:b=>ee(b,n.id),onTarget:b=>C(n.id)},null,8,["log","onMore","onTarget"]))],42,Ks),n.is_showtime?(m(),X(Ts,{key:0,log:n},null,8,["log"])):(m(),X(As,{key:1,log:n},null,8,["log"]))],512),[[W,!n.is_delete]]),U(a(qe,{class:"chapter log_dragline",onDrop:b=>c(b,n.id),dragging:O.value},null,8,["onDrop","dragging"]),[[W,!n.is_delete]])],64))),128))]),a(Qe,{positions:G.value,onClear:ee,onUse:ce,onlyAdd:H.value},null,8,["positions","onlyAdd"]),a(as),a(Xe,{open:ie.value,"onUpdate:open":r[5]||(r[5]=n=>ie.value=n),id:K.id,type:K.type,onAdd:l},null,8,["open","id","type"])]),_:1},512))}},po=z(Qs,[["__scopeId","data-v-d18e9c6a"]]);export{po as default};
