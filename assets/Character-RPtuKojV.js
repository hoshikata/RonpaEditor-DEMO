import{o as p,d as m,e as t,_ as V,B as N,i as M,c as E,C as z,v as b,D as U,F as L,j as R,n as F,t as j,h as y,f as S,E as B,G,s as A,w as J,A as w,p as X,k as q}from"./index-DwCLTrdJ.js";import{I,C as K}from"./Control-C2z0SFKV.js";import{H as Q}from"./Header-zxoLnZ47.js";const W={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Y=t("path",{fill:"currentColor",d:"m12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72l3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41l-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08z"},null,-1),Z=[Y];function ee(d,g){return p(),m("svg",W,[...Z])}const te={name:"ic-round-star",render:ee},se={class:"menu_list"},ne={class:"contents"},oe=["onClick"],ae={__name:"Menu",props:{positions:{type:[Object],default:null}},emits:["use","clear"],setup(d,{emit:g}){const a=d,u=g,{getClientRect:_}=N(),v=M(null),s=[{title:"セリフ：主人公",type:""},{title:"セリフ：独り言",type:"",class:"!text-cyan-400 !dark:text-monolog"},{title:"セリフ：脇役",type:""},{title:"切り替え：背景",type:""},{title:"切り替え：BGM",type:""},{title:"演出：CG",type:""},{title:"演出：CG終了",type:""},{title:"演出：動画",type:""},{title:"演出：暗転",type:""},{title:"アナウンス",type:"",class:"!text-announce"},{title:"システム",type:"",class:"!text-announce"},{title:"削除",type:"",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],o=E(()=>{const{height:r}=_(document.documentElement),{height:x}=_(v.value),{x:D,y:i,width:c,height:h}=a.positions??{},e=(i??0)+(h??0)/2-(x??0)/2,k=(e<20?20:e)+"px",n=(r??0)-(x??0)-20+"px",H=`min(${k}, ${n})`,P=(D??0)+(c??0)+2+"px";return{top:H,left:P}}),l=E(()=>{const{x:r,y:x,width:D,height:i}=a.positions??{},c=(x??0)+(i??0)/2,h=(r??0)+(D??0)+3;return{top:c+"px",left:h+"px"}}),f=r=>{r.target.matches(".menu, .menu *")||u("clear",null)},C=r=>{u("use",{type:r}),u("clear",null)};return(r,x)=>{const D=z("visible");return b((p(),m("div",{class:"fixed inset-0 z-50 h-dvh w-dvw overflow-hidden",onClick:f},[t("div",{class:"menu_triangle",style:U(l.value)},null,4),t("div",{class:"menu scrollbar overflow-y-auto",style:U(o.value),ref_key:"menu",ref:v},[t("ul",se,[(p(),m(L,null,R(s,i=>t("li",ne,[t("button",{class:F(["menu_item",i.class]),onClick:c=>C(i.type)},j(i.title),11,oe)])),64))])],4)])),[[D,d.positions]])}}},le=V(ae,[["__scopeId","data-v-a51af57a"]]);function ie(){const{findData:d}=N(),g=(s,o)=>{const l=o.replace(/\s/g,"").toLowerCase().split(","),f=s.name.slice(s.name.lastIndexOf(".")).toLowerCase();return o!==""?l.includes(f):!0},a=s=>s instanceof Blob;return{isFileType:g,isBlobFile:a,blobUrl:(s,o)=>{const l=f=>f.slice(-1)==="/"?"":f;return a(s)?URL.createObjectURL(s):l(o??"")},getFileName:s=>{var l;s=s??"";const o=(l=s.lastIndexOf)==null?void 0:l.call(s,"/");return a(s)||o===-1?s:s.slice(o).slice(1)},getFilesData:(s,o)=>{const l=o.filter(r=>!r.id),f=s.filter(r=>!d(o,r.id)).map(r=>r.name),C=s.filter(r=>d(o,r.id));return{addList:l,delList:f,resultList:C}}}}const de={class:"upload"},re={class:"upload_input"},ce={class:"upload_image"},ue=["src"],_e={__name:"Upload",props:{value:{type:[String],default:""},type:{type:[String],default:"contain"}},emits:["update:value"],setup(d,{emit:g}){const{blobUrl:a}=ie(),u=g,_=s=>{const o=s.target.files[0],l=a(o,"");u("update:value",l)},v=()=>u("update:value","");return(s,o)=>{const l=z("visible");return p(),m("div",de,[b((p(),m("label",re,[y(S(I)),t("input",{class:"hidden",onChange:_,type:"file",accept:"image/*"},null,32)])),[[l,!d.value]]),b((p(),m("div",ce,[t("img",{class:F(["size-full",d.type==="cover"?"object-cover":"object-contain"]),src:d.value},null,10,ue),t("button",{class:"upload_remove",onClick:v},[y(S(I),{class:"rotate-45"})])])),[[l,d.value]])])}}},T=V(_e,[["__scopeId","data-v-7bd1348d"]]),ge={__name:"DropLine",props:{dragging:{type:[Boolean],default:!1}},emits:["drop"],setup(d,{emit:g}){const a=g,u=M(null),_=s=>{u.value.style.opacity=s?1:""},v=s=>{const o=s.dataTransfer.getData("text/plain");let l=null;try{l=JSON.parse(o)}catch{}_(!1),l!==null&&a("drop",l)};return(s,o)=>(p(),m("div",{class:F(["drag_line invisible opacity-0",{"!visible":d.dragging}]),onDragenter:o[0]||(o[0]=B(l=>_(!0),["prevent"])),onDragleave:o[1]||(o[1]=B(l=>_(!1),["prevent"])),onDragover:o[2]||(o[2]=B(()=>{},["prevent"])),onDrop:v,ref_key:"line",ref:u},null,34))}},O=V(ge,[["__scopeId","data-v-55dbec76"]]),pe="/RonpaEditor-DEMO/assets/headshot_1-CxnizMm5.png",me="/RonpaEditor-DEMO/assets/headshot_2-xVBmaB3M.png",ve="/RonpaEditor-DEMO/assets/nametag_1-gPs7u1zN.png",fe="/RonpaEditor-DEMO/assets/nametag_2-UDMsHms1.png",he=G("character",()=>{const d=M([{id:0,name:"？？？？",katakana:"？？？？",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",unknown:!0,is_drag:!0,dragging:!1},{id:1,name:"十六夜魔除",katakana:"イザヨイマヨ",name_bg:"#a64d79",name_text:"#ffff00",image_head:pe,image_name:ve,is_hero:!0,is_drag:!0,dragging:!1},{id:2,name:"観月星知",katakana:"カンゲツセシル",name_bg:"#674ea7",name_text:"#d4c1a6",image_head:me,image_name:fe,is_hero:!1,is_drag:!0,dragging:!1}]),g=M({name:"",katakana:"",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",is_hero:!1,is_drag:!0,dragging:!1});return{characterList:d,characterNew:g}});function ye(){return{dragMove:(a,u)=>{a.dataTransfer.dropEffect="move",a.dataTransfer.setData("text/plain",JSON.stringify(u))},dropMove:(a,u,_)=>{const[v]=a.splice(u,1),s=u>=_?_:_-1,o=s<0?0:s;a.splice(o,0,v)}}}const $=d=>(X("data-v-979c9855"),d=d(),q(),d),be={class:"setting_wrap"},xe=$(()=>t("div",null,null,-1)),ke=$(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"アイコン"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc highlight"},"★ = 主人公")],-1)),De=$(()=>t("div",{class:"setting_head col-span-2"},[t("h2",{class:"setting_title"},"お名前"),t("p",{class:"setting_desc"},"EXCEL内表示")],-1)),Ce=$(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"名札"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc"},"（画像のない場合はカタカナ表示になります）")],-1)),$e=["draggable","onDragstart","onDragend"],we={key:0,class:"setting_avatar setting_unknown"},Ue={key:1,class:"setting_avatar"},Be=["onClick"],Me={class:"setting_detail",draggable:"false"},Fe=["onUpdate:modelValue","onFocus","onBlur"],Le={class:"setting_col"},Ee=$(()=>t("p",{class:"ml-0.5"},"名前の色",-1)),Se=["onUpdate:modelValue","onFocus","onBlur"],Ve=["onUpdate:modelValue"],ze={class:"setting_detail"},Ie=["onUpdate:modelValue","onFocus","onBlur"],Te={class:"setting_col"},Oe=$(()=>t("p",{class:"ml-0.5"},"名前の背景色",-1)),Ne=["onUpdate:modelValue","onFocus","onBlur"],Re=["onUpdate:modelValue"],He=$(()=>t("div",{class:"col-span-5 mb-4"},null,-1)),Pe={__name:"Character",setup(d){const g=he(),{characterList:a,characterNew:u}=A(g),{dragMove:_,dropMove:v}=ye(),s=E(()=>a.value.some(i=>i.is_hero)),o=E(()=>a.value.some(i=>i.dragging)),l=i=>{const c={...u.value},h=[...a.value].sort((e,k)=>k.id-e.id)[0];c.id=h?h.id+1:0,a.value.splice(i+1,0,c)},f=i=>a.value.splice(i,1),C=(i,c,h)=>{h&&_(i,{index:c}),a.value[c].dragging=h},r=(i,c)=>v(a.value,i.index,c),x=M(null),D=i=>x.value=i;return(i,c)=>{const h=z("visible");return p(),m(L,null,[y(le,{positions:x.value,onClear:D},null,8,["positions"]),t("div",be,[y(Q,{col:"col-span-5"},{default:J(()=>[xe,ke,De,Ce]),_:1}),y(O,{class:"setting_dragline",onDrop:c[0]||(c[0]=e=>r(e,0)),dragging:o.value},null,8,["dragging"]),(p(!0),m(L,null,R(S(a),(e,k)=>(p(),m(L,{key:e.id},[t("div",{class:F(["setting_container",{dragging:e.dragging}]),draggable:e.is_drag,onDragstart:n=>C(n,k,!0),onDragend:n=>C(n,k,!1),onDrag:c[1]||(c[1]=B(()=>{},["prevent"])),onDrop:c[2]||(c[2]=B(()=>{},["prevent"]))},[y(K,{class:"row-span-2 -mr-6",hasDel:!e.unknown,onAdd:n=>l(k),onDel:n=>f(k),onMore:D},null,8,["hasDel","onAdd","onDel"]),e.unknown?(p(),m("div",we)):(p(),m("div",Ue,[y(T,{class:"size-full",value:e.image_head,"onUpdate:value":n=>e.image_head=n,type:"cover"},null,8,["value","onUpdate:value"]),b((p(),m("button",{class:F(["setting_star",{"setting_star-active":e.is_hero}]),onClick:n=>e.is_hero=!e.is_hero},[y(S(te))],10,Be)),[[h,!(s.value&&!e.is_hero)]])])),t("div",Me,[b(t("input",{class:"setting_name last","onUpdate:modelValue":n=>e.name=n,style:U({"--name-bg":e.name_bg,"--name-text":e.name_text}),onFocus:n=>e.is_drag=!1,onBlur:n=>e.is_drag=!0},null,44,Fe),[[w,e.name,void 0,{lazy:!0,trim:!0}]]),t("div",Le,[Ee,b(t("input",{class:"setting_input","onUpdate:modelValue":n=>e.name_text=n,onFocus:n=>e.is_drag=!1,onBlur:n=>e.is_drag=!0},null,40,Se),[[w,e.name_text,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:U({"background-color":e.name_text})},[b(t("input",{class:"hidden","onUpdate:modelValue":n=>e.name_text=n,type:"color"},null,8,Ve),[[w,e.name_text,void 0,{lazy:!0}]])],4)])]),t("div",ze,[b(t("input",{class:"setting_name first","onUpdate:modelValue":n=>e.katakana=n,onFocus:n=>e.is_drag=!1,onBlur:n=>e.is_drag=!0},null,40,Ie),[[w,e.katakana,void 0,{lazy:!0,trim:!0}]]),t("div",Te,[Oe,b(t("input",{class:"setting_input","onUpdate:modelValue":n=>e.name_bg=n,onFocus:n=>e.is_drag=!1,onBlur:n=>e.is_drag=!0},null,40,Ne),[[w,e.name_bg,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:U({"background-color":e.name_bg})},[b(t("input",{class:"hidden","onUpdate:modelValue":n=>e.name_bg=n,type:"color"},null,8,Re),[[w,e.name_bg,void 0,{lazy:!0}]])],4)])]),y(T,{class:"setting_nametag",value:e.image_name,"onUpdate:value":n=>e.image_name=n},null,8,["value","onUpdate:value"])],42,$e),y(O,{class:"setting_dragline",onDrop:n=>r(n,k+1),dragging:o.value},null,8,["onDrop","dragging"])],64))),128)),He])],64)}}},Je=V(Pe,[["__scopeId","data-v-979c9855"]]);export{Je as default};
