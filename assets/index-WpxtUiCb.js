import{_ as F,o as f,c as I,a as t,H as Me,n as M,I as Oe,h as ve,s as V,u as _e,b as ge,q as me,j,A as Ue,r as Y,J as He,l as Ve,w as L,d as e,e as i,v as W,x as T,F as oe,m as ye,K as Ce,L as ke,g as he,M as Ne,t as ce,p as Z,y as be,z as Pe,N as je,C as Ee,G as Fe,E as Ge}from"./index-8IppmzXs.js";import{I as We,a as qe,D as De}from"./IconDelete-cf8OSuWC.js";import{W as ze}from"./Wrap-C0j3Jykv.js";import{C as Ie}from"./Control-Qt9ksXvB.js";import{I as Je,u as Ke,M as Qe,E as Xe}from"./EditPopup-CEcok4QV.js";import{M as Ye}from"./Mark-CUP7fZ1P.js";import{_ as xe,S as X,D as Ze}from"./Dialog-6LMIdeH0.js";import{R as et}from"./Radio-xO1AtvgO.js";import{A as tt}from"./Avatar-tU6eNTDR.js";import"./round-drag-indicator-MNw4GVEB.js";/* empty css                                                             */import"./Image-D6g_P4Zd.js";const st={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(s){return(_,h)=>(f(),I("button",{class:M(["switch",{"bg-current":s.active}])},[t("span",{class:M(["-mt-0.1em",{"text-white":s.active}])},[Me(_.$slots,"default",{},void 0,!0)],2)],2))}},de=F(st,[["__scopeId","data-v-8bd1e4e9"]]),ot={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},lt=t("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"},null,-1),at=[lt];function nt(s,_){return f(),I("svg",ot,[...at])}const pe={name:"ic-round-search",render:nt},it={name:"MaterialSymbolsFindReplaceRounded"},ct={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},rt=t("path",{fill:"currentColor",d:"M11 6q-1.575 0-2.838.863T6.35 9.125q-.15.375-.487.563t-.738.112t-.638-.387t-.112-.663q.675-2.1 2.475-3.425T11 4q1.475 0 2.763.562T16 6.1V5q0-.425.288-.712T17 4t.713.288T18 5v4q0 .425-.288.713T17 10h-4q-.425 0-.712-.288T12 9t.288-.712T13 8h2q-.725-.9-1.737-1.45T11 6m0 12q-1.475 0-2.762-.562T6 15.9V17q0 .425-.288.713T5 18t-.712-.288T4 17v-4q0-.425.288-.712T5 12h4q.425 0 .713.288T10 13t-.288.713T9 14H7q.725.9 1.738 1.45T11 16q1.55 0 2.788-.825T15.6 13q.175-.4.513-.638t.762-.162q.425.1.625.45t.075.75q-.175.5-.413.938t-.562.862l3.7 3.7q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-3.7-3.7q-.9.675-1.962 1.038T11 18"},null,-1),ut=[rt];function dt(s,_,h,m,b,$){return f(),I("svg",ct,ut)}const $e=F(it,[["render",dt]]),Te=Oe("search",()=>{const s=ve(),{initSelected:_}=s,{chapterData:h}=V(s),m=_e(),{getCharacter:b,getSprite:$}=m,{characterList:y}=V(m),x=ge(),{getShowList:R}=x,{effectList:z,seList:k}=V(x),{copyObject:g,findData:o}=me(),B=j(()=>{let l=h.value;const{type:a,result:c}=K.value;return a===0&&(l=ae(c)),a===1&&(l=ee(c)),a===2&&(l=re(c)),console.log(l),l}),J=j(()=>B.value.map(l=>l.id)),U=Ue({type:0,keyword:{value:"",rep:""},show:{parent:"",child:"",rep:""},items:[{parent:"",child:""}],itemsRep:{parent:"",child:"",rep:""},open:!1}),K=Y({}),te=j(()=>{const l=[];return y.value.forEach(a=>{const c=(a.sprite??[]).map(v=>({id:a.id+"_"+v.id,name:a.name+"："+v.name}));l.push(...c)}),l}),Q=l=>{let a=[];const c=["人物","顯示角色","立ち絵2"].includes(l),v=["角色差分","十六夜差分"].includes(l),w=["差分特效","主角特效"].includes(l);return c&&(a=y.value),v&&(a=te.value),w&&(a=z.value),l==="SE"&&(a=k.value),a},A=()=>{U.keyword={value:"",rep:""},U.show={parent:"",child:"",rep:""},U.items=[{parent:"",child:""}],U.itemsRep={parent:"",child:"",value:""},U.type=0,G()},p=()=>{const{type:l,keyword:a,show:c,items:v,itemsRep:w}=U;let S={};return l===0&&(S={result:a.value,rep:a.rep}),l===1&&(S={result:g(c),rep:c.rep}),l===2&&(S={result:g(v),rep:g(w)}),{type:l,...S}},G=()=>{K.value=p(),_(h.value),U.open=!1},r=()=>{const l=p();l.value=l;const{type:a,result:c,rep:v}=l;a===0&&fe(c,v),a===1&&we(c,v),a===2&&ne(c,v),_(h.value),A(),U.open=!1};He(G);const N=(l,a)=>{const c=R(l)??[],v=o(c,a);return c.length?a!==""&&!v:!1},P=(l,a)=>{const c=Q(l)??[],v=o(c,a);return c.length?a!==""&&!v:!1},le=(l,a)=>{const c={角色差分:"顯示角色",十六夜差分:"立ち絵2"},v=l[c[a]],w=l[a],S=b(v).sprite??[],E=$(v,w),d=S.length?w!==""&&E.id===void 0:!1;return{name:c[a],group:v,value:w,isErr:d}},se=l=>{let[a,c]=l.split("_");return[a*1,c*1]},O=(l,a,c)=>l===""?!0:l==="err"?a:c,ae=l=>(l=l??"",l===""?h.value:h.value.filter(a=>a.和訳.match(l))),ee=({parent:l,child:a})=>l===""&&a===""?h.value:h.value.filter(c=>{const{is_showtime:v,show_time:w,show_name:S}=c;if(!v||!(l===""?!0:w===l))return!1;const d=N(w,S);return O(a,d,S===a)}),re=l=>l.some(c=>!(c.parent===""&&c.child===""))?h.value.filter(c=>c.is_showtime?!1:l.every(v=>{const{parent:w,child:S}=v;if(["角色差分","十六夜差分"].includes(w)){const[d,u]=se(S),{group:n,value:D,isErr:C}=le(c,w);return O(S,C,n===d&&D===u)}else{const d=c[w],u=P(w,d);return O(S,u,d===S)}})):h.value,fe=(l,a)=>{l=l??"",l!==""&&J.value.forEach(c=>{const v=o(h.value,c);v.和訳=v.和訳.replace(l,a)})},we=({parent:l,child:a},c)=>{if(l===""&&a==="")return h.value;J.value.forEach(v=>{const w=o(h.value,v),{is_showtime:S,show_time:E,show_name:d}=w;if(!S)return;const u=N(E,d);O(a,u,E===l&&d===a)&&(w.show_name=c)})},ne=(l,{parent:a,child:c,rep:v})=>{l.some(S=>!(S.parent===""&&S.child===""))&&J.value.forEach(S=>{const E=o(h.value,S);if(E.is_showtime)return;if(["角色差分","十六夜差分"].includes(a)){const[u,n]=se(c),[D,C]=se(v),{name:Se,group:ie,value:ue,isErr:Ae}=le(E,a);O(c,Ae,ie===u&&ue===n)&&(E[Se]=D,E[a]=C)}else{const u=E[a],n=P(a,u);O(c,n,u===c)&&(E[a]=v)}})};return{chapterFilter:B,search:U,searchResult:K,getChildOptions:Q,initSearch:A,submitSearch:G,submitReplace:r,keywordSearch:ae,showSearch:ee,itemsSearch:re}}),q=s=>(Ce("data-v-51daf03c"),s=s(),ke(),s),pt={class:"popup_window"},ht={class:"popup_container scrollbar"},vt={class:"mb-8 flex justify-center"},_t={class:"popup_keyword_group"},gt=q(()=>t("span",null,null,-1)),mt=["disabled"],ft=q(()=>t("span",{class:"text-right"},"取代成",-1)),wt=["disabled"],St={class:"popup_show_group"},bt=q(()=>t("option",{value:""},"全て",-1)),$t=q(()=>t("option",{value:""},"全て",-1)),yt=q(()=>t("option",{value:"err"},"錯誤值",-1)),xt=["disabled"],Ct=q(()=>t("span",{class:"text-right"},"取代成",-1)),kt=q(()=>t("option",{value:""},"全て",-1)),It=q(()=>t("option",{value:"err"},"錯誤值",-1)),Tt=["disabled"],Rt={class:"contents"},Et={class:"popup_items_group"},qt={class:"popup_search_group"},Dt={class:"text-right"},Lt=q(()=>t("option",{value:""},"全て",-1)),Mt=q(()=>t("option",{value:""},"全て",-1)),Ut={value:"err"},Vt={class:"popup_search"},Bt=["disabled"],At={class:"popup_replace"},Ot=q(()=>t("span",null,"以上",-1)),Ht=q(()=>t("option",{value:""},"全て",-1)),Nt=q(()=>t("option",{value:""},"全て",-1)),Pt={value:"err"},jt=q(()=>t("span",null,"取代成",-1)),Ft=q(()=>t("option",{value:""},"なし",-1)),Gt=["disabled"],Wt={class:"popup_footer"},zt={__name:"Search",emits:["goTop"],setup(s,{emit:_}){const h=_e();V(h);const m=ge(),{getEffect:b,getSe:$,getShowList:y}=m;V(m);const x=Te(),{getChildOptions:R,initSearch:z,submitSearch:k,submitReplace:g}=x,{search:o,chapterFilter:B}=V(x);me();const J=j(()=>o.value.items.some(A=>!(A.parent===""&&A.child===""))),U=[{id:"UI"},{id:"BG"},{id:"BGM"},{id:"CG"},{id:"暗場"}],K=[{id:"人物",name:"話し手"},{id:"顯示角色",name:"立ち絵1名前"},{id:"角色差分",name:"立ち絵1差分"},{id:"差分特效",name:"立ち絵1エフェクト"},{id:"立ち絵2",name:"立ち絵2名前"},{id:"十六夜差分",name:"立ち絵2差分"},{id:"主角特效",name:"立ち絵2エフェクト"},{id:"SE"},{id:"Voice"}],te=()=>o.value.items.push({parent:"",child:""}),Q=A=>{const p=A.target.matches(".popup_window, .popup_window *"),G=A.target.matches(".popup_close");(!p||G)&&(o.value.open=!1)};return(A,p)=>{const G=Ve("visible");return L((f(),I("section",{class:"popup",onClick:Q},[t("div",pt,[t("div",ht,[t("div",vt,[i(et,{class:"popup_radio",value:e(o).type,"onUpdate:value":p[0]||(p[0]=r=>e(o).type=r),list:[{id:0,title:"セリフ"},{id:1,title:"切り替え＆演出"},{id:2,title:"項目"}],name:"type"},null,8,["value"])]),L(t("div",_t,[gt,i(xe,{class:"popup_input",value:e(o).keyword.value,"onUpdate:value":p[1]||(p[1]=r=>e(o).keyword.value=r),placeholder:"キーワード"},null,8,["value"]),t("button",{class:"popup_submit",onClick:p[2]||(p[2]=(...r)=>e(k)&&e(k)(...r)),disabled:e(o).keyword.value==="",title:"サーチ"},[i(e(pe))],8,mt),ft,i(xe,{class:"popup_input",value:e(o).keyword.rep,"onUpdate:value":p[3]||(p[3]=r=>e(o).keyword.rep=r)},null,8,["value"]),t("button",{class:"popup_submit",onClick:p[4]||(p[4]=(...r)=>e(g)&&e(g)(...r)),disabled:e(o).keyword.value==="",title:"取代"},[i($e,{class:"text-[1.2em]"})],8,wt)],512),[[W,e(o).type===0]]),L(t("div",St,[i(X,{class:"popup_select",value:e(o).show.parent,"onUpdate:value":p[5]||(p[5]=r=>e(o).show.parent=r),options:U,onChange:p[6]||(p[6]=r=>{e(o).show.child="",e(o).show.rep=""})},{default:T(()=>[bt]),_:1},8,["value"]),i(X,{class:"popup_select",value:e(o).show.child,"onUpdate:value":p[7]||(p[7]=r=>e(o).show.child=r),options:e(y)(e(o).show.parent)},{default:T(()=>[$t,yt]),_:1},8,["value","options"]),t("button",{class:"popup_submit",onClick:p[8]||(p[8]=(...r)=>e(k)&&e(k)(...r)),disabled:e(o).show.parent===""&&e(o).show.child==="",title:"サーチ"},[i(e(pe))],8,xt),Ct,i(X,{class:"popup_select",value:e(o).show.rep,"onUpdate:value":p[9]||(p[9]=r=>e(o).show.rep=r),options:e(y)(e(o).show.parent)},{default:T(()=>[kt,It]),_:1},8,["value","options"]),t("button",{class:"popup_submit",onClick:p[10]||(p[10]=(...r)=>e(g)&&e(g)(...r)),disabled:e(o).show.rep==="",title:"取代"},[i($e,{class:"text-[1.2em]"})],8,Tt)],512),[[W,e(o).type===1]]),L(t("div",Rt,[t("div",Et,[(f(!0),I(oe,null,ye(e(o).items,(r,N)=>(f(),I("div",qt,[L(t("button",{class:"popup_submit",onClick:te,title:"条件を増やし"},"条件を増やし",512),[[W,!N]]),L(t("span",Dt,"と",512),[[W,N]]),i(X,{class:"popup_select",value:r.parent,"onUpdate:value":P=>r.parent=P,options:K,onChange:P=>r.child=""},{default:T(()=>[Lt]),_:2},1032,["value","onUpdate:value","onChange"]),i(X,{class:"popup_select",value:r.child,"onUpdate:value":P=>r.child=P,options:e(R)(r.parent)},{default:T(()=>[Mt,L(t("option",Ut,"錯誤值",512),[[W,r.parent!==""]])]),_:2},1032,["value","onUpdate:value","options"])]))),256)),t("div",Vt,[t("button",{class:"popup_submit",onClick:p[11]||(p[11]=(...r)=>e(k)&&e(k)(...r)),disabled:!J.value,title:"サーチ"},[i(e(pe))],8,Bt)])]),t("div",At,[Ot,i(X,{class:"popup_select",value:e(o).itemsRep.parent,"onUpdate:value":p[12]||(p[12]=r=>e(o).itemsRep.parent=r),options:K,onChange:p[13]||(p[13]=r=>{e(o).itemsRep.child="",e(o).itemsRep.rep=""})},{default:T(()=>[Ht]),_:1},8,["value"]),i(X,{class:"popup_select",value:e(o).itemsRep.child,"onUpdate:value":p[14]||(p[14]=r=>e(o).itemsRep.child=r),options:e(R)(e(o).itemsRep.parent)},{default:T(()=>[Nt,L(t("option",Pt,"錯誤值",512),[[W,e(o).itemsRep.parent!==""]])]),_:1},8,["value","options"]),jt,i(X,{class:"popup_select",value:e(o).itemsRep.rep,"onUpdate:value":p[15]||(p[15]=r=>e(o).itemsRep.rep=r),options:e(R)(e(o).itemsRep.parent)},{default:T(()=>[Ft]),_:1},8,["value","options"]),t("button",{class:"popup_submit",onClick:p[16]||(p[16]=(...r)=>e(g)&&e(g)(...r)),disabled:e(o).itemsRep.parent===""&&e(o).itemsRep.child===""||e(o).itemsRep.rep==="",title:"取代"},[i($e,{class:"text-[1.2em]"})],8,Gt)])],512),[[W,e(o).type===2]])]),t("footer",Wt,[t("button",{class:"popup_submit -cancel",onClick:p[17]||(p[17]=(...r)=>e(z)&&e(z)(...r)),title:"キャンセル"},"キャンセル")])])])),[[G,e(o).open]])}}},Jt=F(zt,[["__scopeId","data-v-51daf03c"]]),Kt={name:"MaterialSymbolsArrowWarmUpRounded"},Qt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Xt=t("path",{fill:"currentColor",d:"M12 13q-.425 0-.712-.288T11 12V5.825L7.1 9.7q-.275.275-.687.288T5.7 9.7q-.275-.275-.275-.7t.275-.7l5.6-5.6q.15-.15.325-.212T12 2.425t.375.063t.325.212l5.6 5.6q.275.275.275.688T18.3 9.7q-.3.3-.712.3t-.713-.3L13 5.825V12q0 .425-.288.713T12 13m0 5q-.425 0-.712-.288T11 17v-1q0-.425.288-.712T12 15t.713.288T13 16v1q0 .425-.288.713T12 18m0 4q-.425 0-.712-.288T11 21t.288-.712T12 20t.713.288T13 21t-.288.713T12 22"},null,-1),Yt=[Xt];function Zt(s,_,h,m,b,$){return f(),I("svg",Qt,Yt)}const Le=F(Kt,[["render",Zt]]),es={class:"chapter_head"},ts=["disabled"],ss=["disabled"],os={__name:"Head",setup(s){const _=ve(),{deleteChapter:h,moveChapter:m}=_,{chapterIndex:b,chapterLength:$,chapterTarget:y,chapterData:x}=V(_),R=Te(),{search:z,searchResult:k}=V(R);return(g,o)=>(f(),I("header",es,[i(xe,{class:"chapter_head_title",value:e(y).title,"onUpdate:value":o[0]||(o[0]=B=>e(y).title=B),placeholder:"タイトル"},null,8,["value"]),t("button",{class:M(["chapter_head_button",{"-active":e(k).result}]),onClick:o[1]||(o[1]=B=>e(z).open=!0),title:"サーチ"},[i(e(pe),{class:"!text-xl"})],2),t("button",{class:"chapter_head_button",onClick:o[2]||(o[2]=B=>e(m)(-1)),disabled:!e(b),title:"上に移動"},[i(Le)],8,ts),t("button",{class:"chapter_head_button",onClick:o[3]||(o[3]=B=>e(m)(1)),disabled:!e($)||e(b)===e($)-1,title:"下に移動"},[i(Le,{class:"-scale-y-100"})],8,ss),t("button",{class:"chapter_head_button",onClick:o[4]||(o[4]=(...B)=>e(h)&&e(h)(...B)),title:"削除"},[i(We)])]))}},ls=F(os,[["__scopeId","data-v-23626d87"]]),as=["disabled"],ns={class:"whitespace-nowrap"},is={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(s,{emit:_}){const h=s,m=_,b=Y(0);return he(b,$=>m("update:value",$)),he(()=>h.value,$=>b.value=$,{immediate:!0}),($,y)=>(f(),I("label",{class:M(["inline-flex items-center",s.disabled?"cursor-auto":"cursor-pointer"])},[L(t("input",{class:M(["checkbox",s.box]),"onUpdate:modelValue":y[0]||(y[0]=x=>b.value=x),disabled:s.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,as),[[Ne,b.value]]),t("span",ns,ce(s.title),1),Me($.$slots,"default",{},void 0,!0)],2))}},Be=F(is,[["__scopeId","data-v-b7a95cdd"]]),cs={__name:"Inner",props:{value:{type:[Number,String],default:void 0},list:{type:[Array],default:()=>[]},type:{type:[String],default:""}},setup(s){const _=s,{findData:h}=me(),m=j(()=>h(_.list,_.value)),b=j(()=>_.list.length?_.value!==""&&!m.value:!1),$=j(()=>({"-showtime":_.type==="showtime","!bg-red-500/50":b.value}));return(y,x)=>{var R;return f(),I("div",{class:M(["inner",$.value])},ce(((R=m.value)==null?void 0:R.name)??s.value),3)}}},H=F(cs,[["__scopeId","data-v-11a9e61f"]]),rs=s=>(Ce("data-v-f1131323"),s=s(),ke(),s),us={class:"chapter log_scene"},ds=rs(()=>t("div",{class:"chapter log_switches xl:!hidden"},null,-1)),ps={__name:"logShowHead",props:{log:{type:[Object],default:()=>({})}},emits:["more"],setup(s,{emit:_}){const h=_,m=ge(),{getShowList:b}=m;return($,y)=>(f(),I(oe,null,[t("div",{class:M(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[i(Be,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":y[0]||(y[0]=x=>s.log.is_selected=x)},null,8,["value"]),i(Ie,{class:"chapter log_control",onMore:y[1]||(y[1]=x=>h("more",x)),hasDel:!1,hasAdd:!1}),t("div",us,[t("span",null,ce(s.log.人物),1),t("span",null,ce(s.log.show_time),1),i(H,{value:s.log.show_name,list:e(b)(s.log.show_time),type:"showtime"},null,8,["value","list"])])],2),ds],64))}},hs=F(ps,[["__scopeId","data-v-f1131323"]]),vs={class:"chapter log_tr_2"},_s=t("div",{class:"chapter log_td -col"},null,-1),gs=t("div",{class:"chapter log_td -col"},null,-1),ms=t("div",{class:"chapter log_td -col"},null,-1),fs={class:"chapter log_td -col"},ws={__name:"logShowBody",props:{log:{type:[Object],default:()=>({})}},setup(s){return(_,h)=>(f(),I("div",vs,[_s,gs,ms,t("div",fs,[i(H,{value:s.log.備註},null,8,["value"])])]))}},Ss={class:"chapter log_comment"},bs={class:"chapter log_switches"},$s={__name:"logCommentHead",props:{log:{type:[Object],default:()=>({})}},emits:["more","target"],setup(s,{emit:_}){const h=s,m=_,b=_e(),{getCharacter:$}=b,y=ve(),{dialogType:x}=y,R=j(()=>$(h.log.人物));return(z,k)=>{const g=Ve("visible");return f(),I(oe,null,[t("div",{class:M(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[i(Be,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":k[0]||(k[0]=o=>s.log.is_selected=o)},null,8,["value"]),i(Ie,{class:"chapter log_control",onMore:k[2]||(k[2]=o=>m("more",o)),onDel:k[3]||(k[3]=o=>s.log.is_delete=!0),hasAdd:!1},{top:T(()=>[t("button",{class:"control_button",onClick:k[1]||(k[1]=o=>m("target")),title:"プレビューのセリフ画面へ"},[i(Je,{class:"text-xl"})])]),_:1}),t("div",{class:M(["chapter log_info",{"flex-row-reverse":R.value.is_hero,"-replay":s.log.is_replay}])},[i(tt,{class:"chapter log_avatar",name:R.value.name??s.log.人物},null,8,["name"]),t("div",Ss,[i(Ze,{class:"chapter log_dialog",value:s.log.和訳,type:e(x)(s.log)},null,8,["value","type"])])],2)],2),t("div",bs,[L((f(),Z(de,{class:M(["chapter log_switch",{"text-replay":s.log.is_replay}]),active:s.log.is_replay,title:"再放送"},{default:T(()=>[be("R")]),_:1},8,["active","class"])),[[g,s.log.is_replay]]),L((f(),Z(de,{class:M(["chapter log_switch",{"text-unknown":s.log.is_unknown}]),active:s.log.is_unknown,title:"未解明"},{default:T(()=>[be("U")]),_:1},8,["active","class"])),[[g,s.log.is_unknown]]),L((f(),Z(de,{class:M(["chapter log_switch",{"-monolog":s.log.is_monolog}]),active:s.log.is_monolog,title:"独り言"},{default:T(()=>[be("S")]),_:1},8,["active","class"])),[[g,s.log.is_monolog]])])],64)}}},ys=F($s,[["__scopeId","data-v-60d9644e"]]),xs={class:"chapter log_tr_2"},Cs={class:"chapter log_td -col"},ks={class:"chapter log_td -col"},Is={class:"chapter log_td -col"},Ts={class:"chapter log_td -col"},Rs={__name:"logCommentBody",props:{log:{type:[Object],default:()=>({})}},setup(s){const _=_e(),{getCharacter:h}=_,{characterList:m}=V(_),b=ge(),{effectList:$,seList:y}=V(b);return(x,R)=>(f(),I("div",xs,[t("div",Cs,[i(H,{class:"col-span-2",value:s.log.顯示角色,list:e(m)},null,8,["value","list"]),i(H,{value:s.log.角色差分,list:e(h)(s.log.顯示角色).sprite},null,8,["value","list"]),i(H,{value:s.log.差分特效,list:e($)},null,8,["value","list"])]),t("div",ks,[i(H,{class:"col-span-2",value:s.log.立ち絵2,list:e(m)},null,8,["value","list"]),i(H,{value:s.log.十六夜差分,list:e(h)(s.log.立ち絵2).sprite},null,8,["value","list"]),i(H,{value:s.log.主角特效,list:e($)},null,8,["value","list"])]),t("div",Is,[i(H,{value:s.log.SE},null,8,["value"]),i(H,{value:s.log.Voice},null,8,["value"])]),t("div",Ts,[i(H,{value:s.log.備註},null,8,["value"])])]))}},Re=s=>(Ce("data-v-419d5ed1"),s=s(),ke(),s),Es={class:"side_list"},qs={class:"flex"},Ds=["onClick","title"],Ls={class:"chapter log"},Ms={class:"chapter log_tr -lock"},Us={class:"mx-1 w-14 self-center"},Vs=Re(()=>t("div",{class:"chapter log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Bs=Re(()=>t("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),As=Re(()=>t("div",{class:"chapter log_tr_2 -lock"},[t("div",{class:"chapter log_th -col"},"立ち絵1．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"立ち絵2．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"SE＆ボイス"),t("div",{class:"chapter log_th -col"},"備考")],-1)),Os={class:"contents"},Hs=["onDragstart","onDragend"],Ns={__name:"index",setup(s){const _=Pe(),h=je(),m=ve(),{newChapter:b,deleteChapter:$,moveChapter:y}=m,{chapterIndex:x,chapterNames:R,chapterLength:z,chapterTarget:k,chapterData:g}=V(m),o=Ke(),{newLogId:B}=o,{logId:J}=V(o),U=Te(),{chapterFilter:K}=V(U),{findData:te,findIndex:Q,getClientRect:A}=me(),{dragMove:p,dropMove:G}=Fe(),r=j(()=>g.value.some(d=>d.dragging)),N=j(()=>g.value.filter(d=>d.is_selected&&!d.is_delete).map(d=>d.id)),P=(d,u,n)=>{const D=te(g.value,u),C=g.value.indexOf(D);n&&p(d,{index:C}),N.value.some(ie=>ie===u)||(D.is_selected=1),N.value.forEach(ie=>{const ue=te(g.value,ie);ue.dragging=n,n||(ue.is_selected=0)})},le=(d,u)=>{const n=u===null?0:Q(g.value,u)+1;N.value.forEach(D=>{const C=Q(g.value,D);G(g.value,C,n)})},se=Y(!1),O=Y(0),ae=Y(null),ee=(d,u)=>{const n=Q(g.value,u);O.value=n===-1?null:n,ae.value=d,se.value=u===null},re=({type:d})=>{const u=O.value,n=g.value[u];d==="delete"?we(n):d==="edit"?a(n.id,{}):d==="copy"?fe(n,u+1):a("add",{type:d})},fe=(d,u)=>{g.value.splice(u,0,{...d,id:B()})},we=d=>{d.is_delete=!0,N.value.forEach(u=>u.is_delete=!0)},ne=Y(!1),l=Ue({id:0,type:"",index:0}),a=(d,{type:u})=>{l.id=d,l.type=u??"",l.index=O.value,ne.value=!0},c=d=>{const u=O.value===null?g.value.length:l.index+1;g.value.splice(u,0,d)},v=Y(null),w=Y({}),S=()=>{Ge(()=>{const d=w.value[J.value];if(!d)return;const{height:u,top:n}=A(d);v.value.mainScroll({top:n-u,left:0,behavior:"smooth"})})},E=d=>{J.value=d,h.push({name:"Preview"})};return he(x,S),he(()=>_.name,d=>{d==="Chapters"&&S()}),(d,u)=>(f(),Z(ze,{ref_key:"wrap",ref:v},{side_foot:T(()=>[t("button",{class:"chapter_add",onClick:u[0]||(u[0]=(...n)=>e(b)&&e(b)(...n)),title:"新規"},[i(e(qe))])]),side:T(()=>[t("ul",Es,[(f(!0),I(oe,null,ye(e(R),(n,D)=>(f(),I("li",qs,[i(Ye,{class:"chapter_mark",active:D===e(x)},null,8,["active"]),t("button",{class:M(["side_item",{"side_item-active":D===e(x)}]),onClick:C=>x.value=D,title:n},ce(n),11,Ds)]))),256))])]),main_head:T(()=>[i(ls)]),default:T(()=>[t("div",Ls,[t("div",Ms,[t("div",Us,[i(de,{class:"chapter_plus",title:"新規"},{default:T(()=>[i(e(qe),{class:"mt-0.1em"}),i(Ie,{class:"absolute left-0 top-0 opacity-0",onMore:u[1]||(u[1]=n=>ee(n,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Vs,Bs]),As,i(De,{class:"chapter log_dragline",onDrop:u[2]||(u[2]=n=>le(n,null)),dragging:r.value},null,8,["dragging"]),(f(!0),I(oe,null,ye(e(K),(n,D)=>(f(),I(oe,{key:n.id},[L(t("section",Os,[t("div",{class:M(["chapter log_tr",{"-dragging":n.dragging}]),draggable:!0,onDragstart:C=>P(C,n.id,!0),onDragend:C=>P(C,n.id,!1),onDrag:u[3]||(u[3]=Ee(()=>{},["prevent"])),onDrop:u[4]||(u[4]=Ee(()=>{},["prevent"])),ref_for:!0,ref:C=>w.value[n.id]=C},[n.is_showtime?(f(),Z(hs,{key:0,log:n,onMore:C=>ee(C,n.id)},null,8,["log","onMore"])):(f(),Z(ys,{key:1,log:n,onMore:C=>ee(C,n.id),onTarget:C=>E(n.id)},null,8,["log","onMore","onTarget"]))],42,Hs),n.is_showtime?(f(),Z(ws,{key:0,log:n},null,8,["log"])):(f(),Z(Rs,{key:1,log:n},null,8,["log"]))],512),[[W,!n.is_delete]]),L(i(De,{class:"chapter log_dragline",onDrop:C=>le(C,n.id),dragging:r.value},null,8,["onDrop","dragging"]),[[W,!n.is_delete]])],64))),128))]),i(Qe,{positions:ae.value,onClear:ee,onUse:re,onlyAdd:se.value},null,8,["positions","onlyAdd"]),i(Jt),i(Xe,{open:ne.value,"onUpdate:open":u[5]||(u[5]=n=>ne.value=n),id:l.id,type:l.type,onAdd:c},null,8,["open","id","type"])]),_:1},512))}},so=F(Ns,[["__scopeId","data-v-419d5ed1"]]);export{so as default};
