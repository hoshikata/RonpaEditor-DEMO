import{o as i,c as f,a as l,_ as C,H as ce,n as m,r as k,g as V,w as T,I as Ce,t as q,q as ie,j as L,b as re,e as a,d as n,F as M,J as de,K as ue,u as ge,h as ve,l as Ie,x,p as S,y as N,s as P,z as De,L as Te,A as Le,m as te,v as le,C as se,G as Me,E as qe}from"./index-BaxGs0xB.js";import{a as oe,I as Ae,D as ae}from"./IconDelete-DcAke0Bt.js";import{D as Be,_ as Ee}from"./Dialog-p9iWz92F.js";import{W as Ue}from"./Wrap-D04RJj_E.js";import{C as j}from"./Control-BSjuP1RG.js";import{I as Ve,u as Pe,M as Re,E as Ne}from"./logStore-vsTlkEC4.js";import{M as je}from"./Mark-Dx4mWBO0.js";import{A as He}from"./Avatar-DMrmLBvB.js";import"./round-drag-indicator-BPXXFrSi.js";/* empty css                                                             */import"./Image-D9sBdGKD.js";const Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ze=l("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"},null,-1),We=[ze];function Fe(e,c){return i(),f("svg",Oe,[...We])}const Ge={name:"ic-round-search",render:Fe},Je={name:"MaterialSymbolsArrowWarmUpRounded"},Ke={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Qe=l("path",{fill:"currentColor",d:"M12 13q-.425 0-.712-.288T11 12V5.825L7.1 9.7q-.275.275-.687.288T5.7 9.7q-.275-.275-.275-.7t.275-.7l5.6-5.6q.15-.15.325-.212T12 2.425t.375.063t.325.212l5.6 5.6q.275.275.275.688T18.3 9.7q-.3.3-.712.3t-.713-.3L13 5.825V12q0 .425-.288.713T12 13m0 5q-.425 0-.712-.288T11 17v-1q0-.425.288-.712T12 15t.713.288T13 16v1q0 .425-.288.713T12 18m0 4q-.425 0-.712-.288T11 21t.288-.712T12 20t.713.288T13 21t-.288.713T12 22"},null,-1),Xe=[Qe];function Ye(e,c,v,g,h,r){return i(),f("svg",Ke,Xe)}const ne=C(Je,[["render",Ye]]),Ze={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(e){return(c,v)=>(i(),f("button",{class:m(["switch",{"bg-current":e.active}])},[l("span",{class:m(["-mt-0.1em",{"text-white":e.active}])},[ce(c.$slots,"default",{},void 0,!0)],2)],2))}},U=C(Ze,[["__scopeId","data-v-8bd1e4e9"]]),et=["disabled"],tt={class:"whitespace-nowrap"},lt={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(e,{emit:c}){const v=e,g=c,h=k(0);return V(h,r=>g("update:value",r)),V(()=>v.value,r=>h.value=r,{immediate:!0}),(r,_)=>(i(),f("label",{class:m(["inline-flex items-center",e.disabled?"cursor-auto":"cursor-pointer"])},[T(l("input",{class:m(["checkbox",e.box]),"onUpdate:modelValue":_[0]||(_[0]=w=>h.value=w),disabled:e.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,et),[[Ce,h.value]]),l("span",tt,q(e.title),1),ce(r.$slots,"default",{},void 0,!0)],2))}},he=C(lt,[["__scopeId","data-v-b7a95cdd"]]),st={__name:"Inner",props:{value:{type:[Number,String],default:void 0},list:{type:[Array],default:()=>[]},type:{type:[String],default:""}},setup(e){const c=e,{findData:v}=ie(),g=L(()=>v(c.list,c.value)),h=L(()=>c.list.length?c.value!==""&&!g.value:!1),r=L(()=>({"-showtime":c.type==="showtime","!bg-red-500/50":h.value}));return(_,w)=>{var p;return i(),f("div",{class:m(["inner",r.value])},q(((p=g.value)==null?void 0:p.name)??e.value),3)}}},y=C(st,[["__scopeId","data-v-11a9e61f"]]),ot=e=>(de("data-v-f1131323"),e=e(),ue(),e),at={class:"chapter log_scene"},nt=ot(()=>l("div",{class:"chapter log_switches xl:!hidden"},null,-1)),ct={__name:"logShowHead",props:{log:{type:[Object],default:()=>({})}},emits:["more"],setup(e,{emit:c}){const v=c,g=re(),{getShowList:h}=g;return(r,_)=>(i(),f(M,null,[l("div",{class:m(["chapter log_td -first",{"bg-secondary/60":e.log.is_selected}])},[a(he,{class:"chapter log_check",value:e.log.is_selected,"onUpdate:value":_[0]||(_[0]=w=>e.log.is_selected=w)},null,8,["value"]),a(j,{class:"chapter log_control",onMore:_[1]||(_[1]=w=>v("more",w)),hasDel:!1,hasAdd:!1}),l("div",at,[l("span",null,q(e.log.人物),1),l("span",null,q(e.log.show_time),1),a(y,{value:e.log.show_name,list:n(h)(e.log.show_time),type:"showtime"},null,8,["value","list"])])],2),nt],64))}},it=C(ct,[["__scopeId","data-v-f1131323"]]),rt={class:"chapter log_tr_2"},dt=l("div",{class:"chapter log_td -col"},null,-1),ut=l("div",{class:"chapter log_td -col"},null,-1),gt=l("div",{class:"chapter log_td -col"},null,-1),vt={class:"chapter log_td -col"},ht={__name:"logShowBody",props:{log:{type:[Object],default:()=>({})}},setup(e){return(c,v)=>(i(),f("div",rt,[dt,ut,gt,l("div",vt,[a(y,{value:e.log.備註},null,8,["value"])])]))}},_t={class:"chapter log_comment"},pt={class:"chapter log_switches"},mt={__name:"logCommentHead",props:{log:{type:[Object],default:()=>({})}},emits:["more","target"],setup(e,{emit:c}){const v=e,g=c,h=ge(),{getCharacter:r}=h,_=ve(),{dialogType:w}=_,p=L(()=>r(v.log.人物));return(O,$)=>{const I=Ie("visible");return i(),f(M,null,[l("div",{class:m(["chapter log_td -first",{"bg-secondary/60":e.log.is_selected}])},[a(he,{class:"chapter log_check",value:e.log.is_selected,"onUpdate:value":$[0]||($[0]=d=>e.log.is_selected=d)},null,8,["value"]),a(j,{class:"chapter log_control",onMore:$[2]||($[2]=d=>g("more",d)),hasAdd:!1},{bottom:x(()=>[l("button",{class:"control_button",onClick:$[1]||($[1]=d=>g("target")),title:"プレビューのセリフ画面へ"},[a(Ve)])]),_:1}),l("div",{class:m(["chapter log_info",{"flex-row-reverse":p.value.is_hero,"-replay":e.log.is_replay}])},[a(He,{class:"chapter log_avatar",name:p.value.name??e.log.人物},null,8,["name"]),l("div",_t,[a(Be,{class:"chapter log_dialog",value:e.log.和訳,type:n(w)(e.log)},null,8,["value","type"])])],2)],2),l("div",pt,[T((i(),S(U,{class:m(["chapter log_switch",{"text-replay":e.log.is_replay}]),active:e.log.is_replay,title:"再放送"},{default:x(()=>[N("R")]),_:1},8,["active","class"])),[[I,e.log.is_replay]]),T((i(),S(U,{class:m(["chapter log_switch",{"text-unknown":e.log.is_unknown}]),active:e.log.is_unknown,title:"未解明"},{default:x(()=>[N("U")]),_:1},8,["active","class"])),[[I,e.log.is_unknown]]),T((i(),S(U,{class:m(["chapter log_switch",{"-monolog":e.log.is_monolog}]),active:e.log.is_monolog,title:"独り言"},{default:x(()=>[N("S")]),_:1},8,["active","class"])),[[I,e.log.is_monolog]])])],64)}}},ft=C(mt,[["__scopeId","data-v-99200057"]]),wt={class:"chapter log_tr_2"},bt={class:"chapter log_td -col"},yt={class:"chapter log_td -col"},$t={class:"chapter log_td -col"},xt={class:"chapter log_td -col"},St={__name:"logCommentBody",props:{log:{type:[Object],default:()=>({})}},setup(e){const c=ge(),{getCharacter:v}=c,{characterList:g}=P(c),h=re(),{effectList:r,seList:_}=P(h);return(w,p)=>(i(),f("div",wt,[l("div",bt,[a(y,{class:"col-span-2",value:e.log.顯示角色,list:n(g)},null,8,["value","list"]),a(y,{value:e.log.角色差分,list:n(v)(e.log.顯示角色).sprite},null,8,["value","list"]),a(y,{value:e.log.差分特效,list:n(r)},null,8,["value","list"])]),l("div",yt,[a(y,{class:"col-span-2",value:e.log.立ち絵2,list:n(g)},null,8,["value","list"]),a(y,{value:e.log.十六夜差分,list:n(v)(e.log.立ち絵2).sprite},null,8,["value","list"]),a(y,{value:e.log.主角特效,list:n(r)},null,8,["value","list"])]),l("div",$t,[a(y,{value:e.log.SE},null,8,["value"]),a(y,{value:e.log.Voice},null,8,["value"])]),l("div",xt,[a(y,{value:e.log.備註},null,8,["value"])])]))}},H=e=>(de("data-v-7cc8bf80"),e=e(),ue(),e),kt={class:"side_list"},Ct={class:"flex"},It=["onClick","title"],Dt={class:"chapter_head"},Tt=["disabled"],Lt=["disabled"],Mt={class:"chapter log"},qt={class:"chapter log_tr -lock"},At={class:"mx-1 w-14 self-center"},Bt=H(()=>l("div",{class:"chapter log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Et=H(()=>l("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),Ut=H(()=>l("div",{class:"chapter log_tr_2 -lock"},[l("div",{class:"chapter log_th -col"},"立ち絵1．差分＆エフェクト"),l("div",{class:"chapter log_th -col"},"立ち絵2．差分＆エフェクト"),l("div",{class:"chapter log_th -col"},"SE＆ボイス"),l("div",{class:"chapter log_th -col"},"備考")],-1)),Vt={class:"contents"},Pt=["onDragstart","onDragend"],Rt={__name:"index",setup(e){const c=De(),v=Te(),g=ve(),{newId:h,newChapter:r,deleteChapter:_,moveChapter:w}=g,{chapterIndex:p,chapterNames:O,chapterLength:$,chapterTarget:I,chapterData:d}=P(g),_e=Pe(),{logId:z}=P(_e),{findData:pe,findIndex:me,getClientRect:fe}=ie(),{dragMove:we,dropMove:be}=Me(),W=L(()=>d.value.some(o=>o.dragging)),A=L(()=>d.value.filter(o=>o.is_selected&&!o.is_delete).map(o=>o.id)),F=(o,t,s)=>{s&&we(o,{index:t}),A.value.some(u=>d.value[t].id===u)||(d.value[t].is_selected=1),A.value.forEach(u=>{const ee=pe(d.value,u);ee.dragging=s,s||(ee.is_selected=0)})},G=(o,t)=>{A.value.forEach(s=>{const b=me(d.value,s);be(d.value,b,t)})},J=k(!1),B=k(0),K=k(null),E=(o,t)=>{B.value=t,K.value=o,J.value=t===null},ye=({type:o})=>{const t=B.value,s=d.value[t];o==="delete"?xe(s):o==="edit"?Q(s.id,{}):o==="copy"?$e(s,t):Q("add",{type:o})},$e=(o,t)=>{d.value.splice(t,0,{...o,id:h()})},xe=o=>{o.is_delete=!0,A.value.forEach(t=>t.is_delete=!0)},R=k(!1),D=Le({id:0,type:"",index:0}),Q=(o,{type:t})=>{D.id=o,D.type=t??"",D.index=B.value,R.value=!0},Se=o=>{const t=B.value===null?d.value.length:D.index+1;d.value.splice(t,0,o)},X=k(null),Y=k({}),Z=()=>{qe(()=>{const o=Y.value[z.value];if(!o)return;const{height:t,top:s}=fe(o);X.value.mainScroll({top:s-t,behavior:"smooth"})})},ke=o=>{z.value=o,v.push({name:"Preview"})};return V(p,Z),V(()=>c.name,o=>{o==="Chapters"&&Z()}),(o,t)=>(i(),S(Ue,{ref_key:"wrap",ref:X},{side_foot:x(()=>[l("button",{class:"chapter_add",onClick:t[0]||(t[0]=(...s)=>n(r)&&n(r)(...s)),title:"新規"},[a(n(oe))])]),side:x(()=>[l("ul",kt,[(i(!0),f(M,null,te(n(O),(s,b)=>(i(),f("li",Ct,[a(je,{class:"chapter_mark",active:b===n(p)},null,8,["active"]),l("button",{class:m(["side_item",{"side_item-active":b===n(p)}]),onClick:u=>p.value=b,title:s},q(s),11,It)]))),256))])]),main_head:x(()=>[l("header",Dt,[a(Ee,{class:"chapter_head_title",value:n(I).title,"onUpdate:value":t[1]||(t[1]=s=>n(I).title=s),placeholder:"タイトル"},null,8,["value"]),l("button",{class:"chapter_head_button",onClick:t[2]||(t[2]=()=>{}),title:"サーチ"},[a(n(Ge),{class:"!text-xl"})]),l("button",{class:"chapter_head_button",onClick:t[3]||(t[3]=s=>n(w)(-1)),disabled:!n(p),title:"上に移動"},[a(ne)],8,Tt),l("button",{class:"chapter_head_button",onClick:t[4]||(t[4]=s=>n(w)(1)),disabled:!n($)||n(p)===n($)-1,title:"下に移動"},[a(ne,{class:"-scale-y-100"})],8,Lt),l("button",{class:"chapter_head_button",onClick:t[5]||(t[5]=(...s)=>n(_)&&n(_)(...s)),title:"削除"},[a(Ae)])])]),default:x(()=>[l("div",Mt,[l("div",qt,[l("div",At,[a(U,{class:"chapter_plus",title:"新規"},{default:x(()=>[a(n(oe),{class:"mt-0.1em"}),a(j,{class:"absolute left-0 top-0 opacity-0",onMore:t[6]||(t[6]=s=>E(s,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Bt,Et]),Ut,a(ae,{class:"chapter log_dragline",onDrop:t[7]||(t[7]=s=>G(s,0)),dragging:W.value},null,8,["dragging"]),(i(!0),f(M,null,te(n(d),(s,b)=>(i(),f(M,{key:s.id},[T(l("section",Vt,[l("div",{class:m(["chapter log_tr",{"-dragging":s.dragging}]),draggable:!0,onDragstart:u=>F(u,b,!0),onDragend:u=>F(u,b,!1),onDrag:t[8]||(t[8]=se(()=>{},["prevent"])),onDrop:t[9]||(t[9]=se(()=>{},["prevent"])),ref_for:!0,ref:u=>Y.value[s.id]=u},[s.is_showtime?(i(),S(it,{key:0,log:s,onMore:u=>E(u,b)},null,8,["log","onMore"])):(i(),S(ft,{key:1,log:s,onMore:u=>E(u,b),onTarget:u=>ke(s.id)},null,8,["log","onMore","onTarget"]))],42,Pt),s.is_showtime?(i(),S(ht,{key:0,log:s},null,8,["log"])):(i(),S(St,{key:1,log:s},null,8,["log"]))],512),[[le,!s.is_delete]]),T(a(ae,{class:"chapter log_dragline",onDrop:u=>G(u,b+1),dragging:W.value},null,8,["onDrop","dragging"]),[[le,!s.is_delete]])],64))),128))]),a(Re,{positions:K.value,onClear:E,onUse:ye,onlyAdd:J.value},null,8,["positions","onlyAdd"]),a(Ne,{open:R.value,"onUpdate:open":t[10]||(t[10]=s=>R.value=s),id:D.id,type:D.type,onAdd:Se},null,8,["open","id","type"])]),_:1},512))}},Xt=C(Rt,[["__scopeId","data-v-7cc8bf80"]]);export{Xt as default};
