import{_ as G,o,c as r,a as c,u as re,b as ne,w as b,v as E,F as R,t as z,d as e,e as u,n as V,f as ue,s as C,r as T,g as B,h as me,i as he,j as g,k as xe,l as Se,m as ke,p as le,q as Ce,x as j,y as q,z as X,A as Q,B as Ie,C as Be,D as J,E as fe,G as De,H as Te}from"./index-LFuWRgYK.js";import{I as ye,a as Le,D as Me}from"./IconDelete-D1Rkv-T6.js";import{D as Ne,S as Ee}from"./Dialog-C4zQjDOr.js";import{W as He}from"./Wrap-CvFbKm2Y.js";import{M as Ue,E as ze}from"./EditPopup-hS-JdBlJ.js";import{A as Re}from"./Aspect-beUb_wRP.js";import{I as we,S as Ve,U as Ae}from"./UiItem-78Z7lXCF.js";import{R as je}from"./Range-BIPSa92u.js";import{_ as te}from"./Image-9lzuy1l-.js";/* empty css                                                             */const Ge={name:"MdiTarget"},Oe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Fe=c("path",{fill:"currentColor",d:"M11 2v2.07A8 8 0 0 0 4.07 11H2v2h2.07A8 8 0 0 0 11 19.93V22h2v-2.07A8 8 0 0 0 19.93 13H22v-2h-2.07A8 8 0 0 0 13 4.07V2m-2 4.08V8h2V6.09c2.5.41 4.5 2.41 4.92 4.91H16v2h1.91c-.41 2.5-2.41 4.5-4.91 4.92V16h-2v1.91C8.5 17.5 6.5 15.5 6.08 13H8v-2H6.09C6.5 8.5 8.5 6.5 11 6.08M12 11a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1"},null,-1),Pe=[Fe];function qe(t,i,n,d,p,m){return o(),r("svg",Oe,Pe)}const We=G(Ge,[["render",qe]]),Ke={name:"RiShiningFill"},Je={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Qe=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),Xe=[Qe];function Ye(t,i,n,d,p,m){return o(),r("svg",Je,Xe)}const Ze=G(Ke,[["render",Ye]]),et={name:"RiShiningLine"},tt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},nt=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),st=[nt];function ot(t,i,n,d,p,m){return o(),r("svg",tt,st)}const at=G(et,[["render",ot]]),lt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},it=c("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),ct=[it];function rt(t,i){return o(),r("svg",lt,[...ct])}const ut={name:"ic-round-queue-music",render:rt},dt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pt=c("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),vt=[pt];function _t(t,i){return o(),r("svg",dt,[...vt])}const gt={name:"ic-sharp-keyboard-voice",render:_t},mt={class:"contents"},ht={class:"preview_log_head"},ft={class:"preview_log_title"},yt={class:"preview_log_subtitle !text-base"},wt={class:"preview_log_content"},bt={class:"preview_log_foot"},$t={class:"preview_log_head"},xt={class:"shrink-0 font-medium"},St={class:"preview_log_subtitle text-xs leading-none"},kt={class:"h-1em"},Ct={class:"h-1em"},It={class:"preview_log_content"},Bt={class:"preview_log_foot"},Dt={class:"preview_log_mark_1"},Tt={class:"preview_log_mark_1"},Lt={class:"preview_log_mark_1"},Mt={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:i}){const n=i,d=re(),{getCharacter:p,getSprite:m}=d,f=ne(),{getShowName:v}=f;return(h,a)=>b((o(),r("article",{class:V(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(o(),r(R,{key:0},[c("div",mt,[c("header",ht,[c("h6",ft,z(t.log.人物),1),c("p",yt,z(t.log.show_time),1)]),c("p",wt,z(e(v)(t.log.show_time,t.log.show_name)),1)]),c("footer",bt,[c("button",{class:"preview_button ml-auto",onClick:a[0]||(a[0]=s=>n("edit")),title:"編集"},[u(we,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:a[1]||(a[1]=s=>n("delete")),title:"削除"},[u(ye,{class:"text-[0.9em]"})])])],64)):(o(),r(R,{key:1},[c("button",{class:"group contents",onClick:a[2]||(a[2]=s=>{n("update:id",t.log.id),n("stop")})},[c("header",$t,[c("h6",xt,z(e(p)(t.log.人物).name),1),c("p",St,[c("span",kt,z(e(p)(t.log.顯示角色).name)+" / "+z(e(m)(t.log.顯示角色,t.log.十六夜差分).name),1),c("span",Ct,z(e(p)(t.log.立ち絵2).name)+" / "+z(e(m)(t.log.立ち絵2,t.log.角色差分).name),1)])]),c("p",It,z(t.log.和訳),1)]),c("footer",Bt,[b(c("span",Dt,"R",512),[[E,t.log.is_replay]]),b(c("span",Tt,"U",512),[[E,t.log.is_unknown]]),b(c("span",Lt,"S",512),[[E,t.log.is_monolog]]),b(u(Ze,{class:"preview_log_mark_2"},null,512),[[E,t.log.差分特效]]),b(u(at,{class:"preview_log_mark_2"},null,512),[[E,t.log.主角特效]]),b(u(e(ut),{class:"preview_log_mark_2"},null,512),[[E,t.log.SE]]),b(u(e(gt),{class:"preview_log_mark_2"},null,512),[[E,t.log.Voice]]),c("button",{class:"preview_button ml-auto",onClick:a[3]||(a[3]=s=>n("edit")),title:"編集"},[u(we,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:a[4]||(a[4]=s=>n("delete")),title:"削除"},[u(ye,{class:"text-[0.9em]"})])])],64))],2)),[[E,!t.log.is_delete]])}},Nt=G(Mt,[["__scopeId","data-v-57d4ef86"]]),Et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ht=c("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),Ut=[Ht];function zt(t,i){return o(),r("svg",Et,[...Ut])}const Rt={name:"ic-baseline-stop",render:zt},Vt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},At=c("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),jt=[At];function Gt(t,i){return o(),r("svg",Vt,[...jt])}const Ot={name:"ic-baseline-play-arrow",render:Gt},Ft={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Pt=c("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),qt=[Pt];function Wt(t,i){return o(),r("svg",Ft,[...qt])}const be={name:"ic-baseline-skip-previous",render:Wt},Kt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Jt=c("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),Qt=[Jt];function Xt(t,i){return o(),r("svg",Kt,[...Qt])}const Yt={name:"ic-baseline-fullscreen",render:Xt},Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},en=c("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),tn=[en];function nn(t,i){return o(),r("svg",Zt,[...tn])}const sn={name:"ic-baseline-fullscreen-exit",render:nn},on={class:"preview_control"},an=["disabled"],ln=["disabled"],cn={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:i}){const n=t,d=i,p=ue(),{fullscreen:m,fontIntervals:f}=C(p),v=T(0);B(v,a=>d("update:index",a)),B(()=>n.index,a=>v.value=a,{immediate:!0});const h=()=>{const a=v.value;!n.play||n.black||setTimeout(()=>{const s=v.value>=n.length&&!n.black;n.index===a&&n.play&&!n.black&&!n.typing&&!s&&(v.value+=1),s&&d("update:play",!1),h()},f.value.sentence)};return B(()=>n.play,h),B(()=>n.typing,h),(a,s)=>(o(),r("div",on,[c("button",{class:"preview_button",onClick:s[0]||(s[0]=y=>{v.value-=1,d("stop")}),disabled:v.value===0,title:"前へ"},[u(e(be))],8,an),c("button",{class:"preview_button",onClick:s[1]||(s[1]=y=>d("update:play",!t.play)),title:"プレイ"},[b(u(e(Ot),null,null,512),[[E,!t.play]]),b(u(e(Rt),null,null,512),[[E,t.play]])]),c("button",{class:"preview_button",onClick:s[2]||(s[2]=y=>{v.value+=1,d("stop")}),disabled:v.value===t.length,title:"次へ"},[u(e(be),{class:"-scale-x-100"})],8,ln),u(je,{class:"mx-3 grow !bg-dark-text",value:v.value,"onUpdate:value":s[3]||(s[3]=y=>v.value=y),onChange:s[4]||(s[4]=y=>d("stop")),min:0,max:t.length,step:1},null,8,["value","max"]),c("button",{class:"preview_button",onClick:s[5]||(s[5]=y=>m.value=!e(m)),title:"全画面モード"},[b(u(e(Yt),null,null,512),[[E,!e(m)]]),b(u(e(sn),null,null,512),[[E,e(m)]])])]))}},rn=G(cn,[["__scopeId","data-v-643d0245"]]),un={__name:"Comment",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:i}){const n=t,d=i,p=ue(),{fontIntervals:m}=C(p),f=me(),{dialogType:v}=f,{getDialogStyle:h}=he(),a=T({}),s=T(0),y=g(()=>a.value.和訳??""),x=g(()=>n.play?y.value.slice(0,s.value):y.value),M=g(()=>h(n.ui)),L=()=>{y.value&&(d("update:typing",!0),s.value=0)},I=()=>{if(!n.play||n.black)return;if(s.value===y.value.length)return d("update:typing",!1);setTimeout(()=>{n.typing?s.value+=1:s.value=y.value.length},m.value.word)};return B(()=>n.data,w=>{w.is_showtime||(a.value=w)}),B(a,L),B(y,I),B(x,I),B(s,I),B(()=>n.black,w=>{w||I()}),(w,H)=>(o(),r("article",{class:"preview_dialog",style:xe(M.value)},[u(Ne,{value:x.value,type:e(v)(t.data)},null,8,["value","type"])],4))}},dn=G(un,[["__scopeId","data-v-7dd70b74"]]),se=Se("log",()=>{const t=ke(),i=me(),{chapterData:n}=C(i),d=re(),{characterHero:p}=C(d),m=ne(),{getUI:f,getHistoryList:v}=m,{defaultUI:h,defaultUIForCG:a}=C(m),{findData:s,findIndex:y}=le(),x=T(0),M=T(0),L=T({}),I=g(()=>n.value.filter(l=>!l.is_delete)),w=g(()=>I.value.filter(l=>{const S=!l.is_showtime,U=l.is_perform&&l.show_time==="暗場";return S||U})),H=g(()=>{const l=y(I.value,x.value)+1,S=I.value.slice(0,l),U=I.value.slice(l);return U.every(F=>F.is_showtime&&F.show_time!=="暗場")&&S.push(...U),S});B(x,l=>{const S=s(n.value,l)??{};S.is_scene||(L.value=S,M.value=y(w.value,S.id))}),B(M,l=>{var S;return x.value=((S=w.value[l])==null?void 0:S.id)??0}),B(n,()=>{var l;return x.value=((l=w.value[0])==null?void 0:l.id)??0}),Ce(()=>{var l;return x.value=((l=w.value[0])==null?void 0:l.id)??0});const D=g(()=>{const l=v(H.value,"CG");return((l==null?void 0:l.show_name)??"")!==""&&(l==null?void 0:l.show_name)!=="結束"}),N=g(()=>{const l=v(H.value,"UI"),S=(l==null?void 0:l.show_name)??h.value??"";return D.value?a.value:S}),W=g(()=>f(N.value)),A=g(()=>{const l=W.value,S=L.value,U=p.value.name,K=S.人物,F=l.name_tag_number===2,ce=S.is_monolog&&l.name_tag_solo_show,ve=K===U&&l.name_tag_hero_right,_e=K===S.顯示角色&&l.name_tag_sprite_1_right,k=K===S.立ち絵2&&l.name_tag_sprite_2_right;return F&&(ce||ve||_e||k)}),O=g(()=>{const l=L.value,S=l.is_system||l.is_announce||l.is_monolog,U=l.is_monolog&&W.value.name_tag_solo_show;return!S||U}),oe=g(()=>!A.value&&O.value),de=g(()=>A.value&&O.value),Y=T(!1),pe=T(!1),ie=T(!1),Z=g(()=>({"":Y.value}));return B(()=>t.name,()=>Y.value=!1),{logId:x,logIndex:M,logData:L,logShowing:I,logContents:w,logHistory:H,logCGMode:D,logUIId:N,logUI:W,isNameRight:A,isNameShow:O,nameTag1Show:oe,nameTag2Show:de,logPlay:Y,logTyping:pe,logBlack:ie,playEase:Z}}),pn={class:"-ui bg-black",id:"Background"},vn={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,n=se(),{playEase:d}=C(n),p=ne(),{getHistoryList:m}=p,{backgroundList:f}=C(p),v=g(()=>{var h;return(h=m(i.contents,"BG"))==null?void 0:h.show_name});return(h,a)=>{const s=j("opacity");return o(),r("div",pn,[(o(!0),r(R,null,q(e(f),y=>b((o(),X(te,{class:V(["-ui",e(d)]),src:y.path},null,8,["src","class"])),[[s,y.id===v.value]])),256))])}}},_n={class:"-ui",id:"Effect"},gn={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const i=se(),{playEase:n}=C(i),d=ne(),{effectList:p}=C(d);return(m,f)=>{const v=j("opacity");return o(),r("div",_n,[(o(!0),r(R,null,q(e(p),h=>b((o(),X(te,{class:V(["-ui",e(n)]),src:h.path,alt:h.name},null,8,["src","class","alt"])),[[v,h.id===t.data[t.name]]])),256))])}}},mn=["data-name"],hn={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Object],default:()=>({})},num:{type:[Number],default:1}},setup(t){const i=t,n=re(),{getSpriteNow:d}=n,{characterList:p}=C(n),m=se(),{logCGMode:f,playEase:v}=C(m);le();const{getMask:h,geSpritePosition:a,geSpriteSize:s}=he(),y={1:{name:"顯示角色",sprite:"角色差分",effect:"差分特效"},2:{name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"}},x=g(()=>y[i.num]??{}),M=g(()=>f.value?"人物":x.value.name),L=g(()=>d(i.contents,i.data[x.value.name],M.value,x.value.sprite)),I=g(()=>i.num===2?i.ui.sprite_number===2:!0),w=g(()=>"sprite_"+i.num);return g(()=>h(i.ui[w.value].mask)),g(()=>a(i.ui[w.value])),g(()=>s(i.ui[w.value])),(H,D)=>{const N=j("visible"),W=j("opacity");return b((o(),X(Ve,{id:"Sprite",data:t.ui[w.value],class:V(e(v))},{default:Q(()=>[(o(!0),r(R,null,q(e(p),A=>b((o(),r("div",{key:A.id,class:V(["-ui",e(v)]),"data-name":A.name},[(o(!0),r(R,null,q(A.sprite??[],O=>b((o(),X(te,{key:O.id,class:"sprite",src:O.path},null,8,["src"])),[[N,O.id===L.value]])),128))],10,mn)),[[W,A.id===t.data[M.value]]])),128)),u(gn,{name:x.value.effect,data:t.data},null,8,["name","data"])]),_:1},8,["data","class"])),[[W,I.value]])}}},$e=G(hn,[["__scopeId","data-v-00a3fc2b"]]),fn={class:"-ui bg-black",id:"CG"},yn={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,n=ne(),{getHistoryList:d}=n,{cgList:p}=C(n),m=g(()=>{var f;return(f=d(i.contents,"CG"))==null?void 0:f.show_name});return(f,v)=>{const h=j("opacity");return o(),r("div",fn,[(o(!0),r(R,null,q(e(p),a=>b((o(),X(te,{class:"-ui !object-cover",src:a.path},null,8,["src"])),[[h,a.id===m.value]])),256))])}}},wn={class:"-ui",id:"UI"},bn={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Number,String],default:()=>""}},setup(t){const i=se(),{nameTag1Show:n,nameTag2Show:d,playEase:p}=C(i),m=ne(),{uiList:f}=C(m);return le(),(v,h)=>{const a=j("opacity");return o(),r("div",wn,[(o(!0),r(R,null,q(e(f),s=>b((o(),X(Ae,{class:V(["-ui",e(p)]),data:s,nameTag1Show:e(n),nameTag2Show:e(d)},null,8,["data","nameTag1Show","nameTag2Show","class"])),[[a,s.id===t.ui]])),256)),b(c("div",{class:V(["-ui -replay",e(p)])},null,2),[[a,t.data.is_replay]])])}}},$n=G(bn,[["__scopeId","data-v-40cdaa15"]]),xn={class:"-ui",id:"NameTag"},Sn={class:"-ui"},kn={class:"name_tag -font"},Cn={class:"-ui"},In={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})}},setup(t){const i=t,n=ue(),{fontFamily:d,fontWeight:p}=C(n),m=re(),{getCharacter:f}=m,{characterList:v}=C(m),h=se(),{isNameRight:a,isNameShow:s}=C(h),{findData:y}=le(),{getNameTagStyle:x}=he(),M=g(()=>f(i.data.人物)),L=g(()=>y(v.value,0)),I=g(()=>{const w=a.value?"name_tag_2":"name_tag_1";return x(i.ui[w])});return(w,H)=>{const D=j("opacity");return o(),r("div",xn,[b((o(),r("div",{class:V(["absolute",[e(d).nameTag,e(p).nameTag]]),style:xe(I.value)},[b((o(),r("div",Sn,[(o(!0),r(R,null,q(e(v),N=>b((o(),r("div",{key:N.id,class:"-ui"},[b((o(),r("p",kn,[Ie(z(N.name),1)])),[[D,!N.image_name]]),b(u(te,{class:"name_tag",src:N.image_name},null,8,["src"]),[[D,N.image_name]])])),[[D,N.id===M.value.id]])),128))])),[[D,!t.data.is_unknown]]),b((o(),r("div",Cn,[u(te,{class:"name_tag",src:L.value.image_name},null,8,["src"])])),[[D,t.data.is_unknown]])],6)),[[D,e(s)]])])}}},Bn=G(In,[["__scopeId","data-v-2434f77d"]]),Dn=3e3,Tn={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:black"],setup(t,{emit:i}){const n=t,d=i,p=g(()=>n.data.show_time==="暗場"),m=T({}),f=g(()=>(m.value.show_name??"").split(",")),v=g(()=>!f.value.includes("前")),h=g(()=>!f.value.includes("後"));g(()=>f.value.includes("續"));const a=T(!1),s=T(!1),y=()=>{if(p.value){if(m.value={...n.data},s.value=n.play&&v.value,a.value=!0,d("update:black",!0),!n.play)return;setTimeout(()=>{n.index>=n.length||d("update:index",n.index+1)},Dn)}else s.value=n.play&&h.value,a.value=!1,d("update:black",!1)};return B(p,y),B(()=>n.play,y),(x,M)=>{const L=j("opacity");return b((o(),r("div",{class:V(["-ui z-20 bg-black",{"duration-1000":s.value}]),id:"Black"},null,2)),[[L,a.value]])}}},Ln={class:"preview_title"},Mn=["value"],Nn=["onDragstart","onDragend","data-id"],En={class:"-ui"},Hn={__name:"index",setup(t){const i=ue(),{fullscreen:n}=C(i),d=me(),{chapterIndex:p,chapterNames:m,chapterData:f}=C(d),v=se(),{logId:h,logIndex:a,logData:s,logContents:y,logHistory:x,logCGMode:M,logUIId:L,logUI:I,logPlay:w,logTyping:H,logBlack:D,playEase:N}=C(v),{getClientRect:W}=le(),{dragMove:A,dropMove:O}=Te(),oe=()=>{w.value=!1,H.value=!1};B(p,oe);const de=g(()=>f.value.some(k=>k.dragging)),Y=(k,_,ee)=>{ee&&A(k,{index:_}),f.value[_].dragging=ee},pe=(k,_)=>O(f.value,k.index,_),ie=T(null),Z=()=>{const k=[...ie.value].find(ge=>ge.dataset.id*1===h.value);if(!k)return;const{height:_,top:ee}=W(k);k.parentElement.scrollBy({top:ee-_,behavior:"smooth"})};B(h,()=>{w.value&&Z()});const l=T(null);B(n,k=>{window.api?window.api.fullscreen(k):k?l.value.requestFullscreen():document.exitFullscreen()});const S=T(null),U=k=>S.value=k,K=T(!1),F=Be({id:0,type:""}),ce=(k,{type:_})=>{F.id=k,F.type=_??"",K.value=!0},ve=k=>f.value.push(k),_e=k=>{h.value=k,setTimeout(Z,100)};return(k,_)=>{const ee=j("opacity"),ge=j("visible");return o(),X(He,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:Q(()=>[u(Ue,{positions:S.value,onClear:U,onUse:_[0]||(_[0]=$=>ce("add",$)),onlyAdd:!0},null,8,["positions"]),c("section",Ln,[u(Ee,{class:"preview_title_select",value:e(p),"onUpdate:value":_[1]||(_[1]=$=>J(p)?p.value=$:null)},{default:Q(()=>[(o(!0),r(R,null,q(e(m),($,ae)=>(o(),r("option",{value:ae},z($),9,Mn))),256))]),_:1},8,["value"]),b(c("button",{class:"preview_button",onClick:Z,title:"今の画面のセリフへ"},[u(We)],512),[[E,!e(n)]]),c("button",{class:"preview_button",onClick:U,title:"新規"},[u(e(Le))])])]),side:Q(()=>[(o(!0),r(R,null,q(e(f),($,ae)=>(o(),r("div",{key:$.id,class:V(["relative",{"-dragging":$.dragging}]),draggable:!0,onDragstart:P=>Y(P,ae,!0),onDragend:P=>Y(P,ae,!1),onDrag:_[3]||(_[3]=fe(()=>{},["prevent"])),onDrop:_[4]||(_[4]=fe(()=>{},["prevent"])),"data-id":$.id,ref_for:!0,ref_key:"logElem",ref:ie},[u(Nt,{id:e(h),"onUpdate:id":_[2]||(_[2]=P=>J(h)?h.value=P:null),log:$,onEdit:P=>ce($.id,{}),onDelete:P=>$.is_delete=!0,onStop:oe},null,8,["id","log","onEdit","onDelete"]),u(Me,{class:"preview_dragline !h-1 !text-secondary/50",onDrop:P=>pe(P,ae+1),dragging:de.value},null,8,["onDrop","dragging"])],42,Nn))),128))]),default:Q(()=>[c("div",{class:"preview",onKeydown:_[10]||(_[10]=De($=>w.value=!e(w),["space"])),tabindex:"0",ref_key:"preview",ref:l},[u(Re,{box:"lattice"},{outer:Q(()=>[u(rn,{index:e(a),"onUpdate:index":_[8]||(_[8]=$=>J(a)?a.value=$:null),play:e(w),"onUpdate:play":_[9]||(_[9]=$=>J(w)?w.value=$:null),typing:e(H),black:e(D),length:e(y).length-1,onTarget:Z,onStop:oe},null,8,["index","play","typing","black","length"])]),default:Q(()=>[b((o(),r("div",En,[u(vn,{contents:e(x)},null,8,["contents"]),u($e,{data:e(s),contents:e(x),ui:e(I),num:1},null,8,["data","contents","ui"]),u($e,{data:e(s),contents:e(x),ui:e(I),num:2},null,8,["data","contents","ui"]),b(u(yn,{contents:e(x),class:V(e(N))},null,8,["contents","class"]),[[ee,e(M)]]),u($n,{data:e(s),contents:e(x),ui:e(L)},null,8,["data","contents","ui"])])),[[ge,e(f).length]]),u(Bn,{data:e(s),ui:e(I)},null,8,["data","ui"]),u(dn,{data:e(s),ui:e(I),play:e(w),typing:e(H),"onUpdate:typing":_[5]||(_[5]=$=>J(H)?H.value=$:null),black:e(D)},null,8,["data","ui","play","typing","black"]),u(Tn,{index:e(a),"onUpdate:index":_[6]||(_[6]=$=>J(a)?a.value=$:null),data:e(s),play:e(w),black:e(D),"onUpdate:black":_[7]||(_[7]=$=>J(D)?D.value=$:null),length:e(y).length-1},null,8,["index","data","play","black","length"])]),_:1})],544),u(ze,{open:K.value,"onUpdate:open":_[11]||(_[11]=$=>K.value=$),id:F.id,type:F.type,onAdd:ve,onTarget:_e},null,8,["open","id","type"])]),_:1})}}},qn=G(Hn,[["__scopeId","data-v-90155ebc"]]);export{qn as default};
