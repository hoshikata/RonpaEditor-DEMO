import{_ as z,o as _,c as v,a as s,r as D,w as T,k as j,j as U,l as de,m as _e,p as pe,q as ve,x as Z,F as L,i as Q,t as V,v as X,g as S,y as he,z as me,n as d,A as fe,d as P,B as se,u as ye,s as ae,b as ge,e as le,f as C,h as n,C as H,D as be,E as we,G as ne}from"./index-BG_E9A1d.js";import{I as xe}from"./round-plus-BXXCkA9S.js";import{W as ke}from"./Wrap-CvB9KQXK.js";import{C as Y,D as oe,u as $e}from"./useDrag-sDl7QMH0.js";import{D as Ce}from"./Dialog-Bp66wblg.js";import{M as Ue}from"./Mark-CzR_Sxi3.js";const Se={name:"MdiExclamationThick"},De={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Be=s("path",{fill:"currentColor",d:"M10 3h4v11h-4zm0 18v-4h4v4z"},null,-1),Me=[Be];function Ie(a,b,y,m,r,c){return _(),v("svg",De,Me)}const Te=z(Se,[["render",Ie]]),Ee=["disabled","placeholder"],I={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:b}){const y=a,m=b,r=D("");return T(r,c=>m("update:value",c)),T(()=>y.value,c=>r.value=c,{immediate:!0}),(c,u)=>{const h=j("verify");return U((_(),v("input",{"onUpdate:modelValue":u[0]||(u[0]=w=>r.value=w),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder},null,8,Ee)),[[de,r.value,void 0,{lazy:!0,trim:!0}],[h,void 0,void 0,{check:!0}]])}}},Fe=["disabled","placeholder"],Ve=["value"],ze={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:b}){_e(u=>({"4ad1a84a":S(r).light.text}));const y=a,m=b,{colors:r}=pe(),c=D("");return T(c,u=>m("update:value",u)),T(()=>y.value,u=>c.value=u,{immediate:!0}),(u,h)=>{const w=j("verify");return U((_(),v("select",{class:"select","onUpdate:modelValue":h[0]||(h[0]=i=>c.value=i),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder},[Z(u.$slots,"default",{},void 0,!0),(_(!0),v(L,null,Q(a.options,i=>U((_(),v("option",{value:i.id??i},V(i.title??i.id??i),9,Ve)),[[X,i.show??!0]])),256))],8,Fe)),[[ve,c.value,void 0,{lazy:!0,trim:!0}],[w,void 0,void 0,{check:!0}]])}}},J=z(ze,[["__scopeId","data-v-1b98bee5"]]),Ae=["disabled","placeholder"],ce={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(a,{emit:b}){const y=a,m=b,r=D(null),c=D(""),u=h=>{if(!h.ctrlKey)return;const{selectionStart:w,selectionEnd:i}=r.value;m("selected",{start:w,end:i})};return T(c,h=>m("update:value",h)),T(()=>y.value,h=>c.value=h,{immediate:!0}),(h,w)=>{const i=j("verify");return U((_(),v("textarea",{class:"scrollbar min-h-0 resize-none","onUpdate:modelValue":w[0]||(w[0]=A=>c.value=A),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder,onKeydown:he(u,["q"]),ref_key:"textarea",ref:r},null,40,Ae)),[[de,c.value,void 0,{lazy:!0,trim:!0}],[i,void 0,void 0,{check:!0}]])}}},Ne=["disabled"],Ge={class:"whitespace-nowrap"},Le={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:b}){const y=a,m=b,r=D(0);return T(r,c=>m("update:value",c)),T(()=>y.value,c=>r.value=c,{immediate:!0}),(c,u)=>(_(),v("label",{class:d(["inline-flex items-center",a.disabled?"cursor-auto":"cursor-pointer"])},[U(s("input",{class:d(["checkbox",a.box]),"onUpdate:modelValue":u[0]||(u[0]=h=>r.value=h),disabled:a.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,Ne),[[me,r.value]]),s("span",Ge,V(a.title),1),Z(c.$slots,"default",{},void 0,!0)],2))}},ie=z(Le,[["__scopeId","data-v-b7a95cdd"]]),Pe={class:"menu_list"},je={class:"contents"},Ke=["onClick"],Oe={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(a,{emit:b}){const y=a,m=b,{getClientRect:r}=fe(),c=D(null),u=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：動画",type:"perform_anime"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],h=P(()=>{const{height:$}=r(document.documentElement),{height:B}=r(c.value),{x:E,y:k,width:f,height:M}=y.positions??{},K=(k??0)+(M??0)/2-(B??0)/2,O=(K<20?20:K)+"px",N=($??0)-(B??0)-20+"px",F=`min(${O}, ${N})`,R=(E??0)+(f??0)+2+"px";return{top:F,left:R}}),w=P(()=>{const{x:$,y:B,width:E,height:k}=y.positions??{},f=(B??0)+(k??0)/2,M=($??0)+(E??0)+3;return{top:f+"px",left:M+"px"}}),i=$=>{$.target.matches(".menu, .menu *")||m("clear",null)},A=$=>{m("use",{type:$}),m("clear",null)};return($,B)=>{const E=j("visible");return U((_(),v("div",{class:"fixed inset-0 z-50 h-dvh w-dvw overflow-hidden",onClick:i},[s("div",{class:"menu_triangle",style:se(w.value)},null,4),s("div",{class:"menu scrollbar overflow-y-auto",style:se(h.value),ref_key:"menu",ref:c},[s("ul",Pe,[(_(),v(L,null,Q(u,k=>s("li",je,[U(s("button",{class:d(["menu_item",k.class]),onClick:f=>A(k.type)},V(k.title),11,Ke),[[X,!(k.type==="delete"&&a.onlyAdd)]])])),64))])],4)])),[[E,a.positions]])}}},Re=z(Oe,[["__scopeId","data-v-4bfa70ca"]]),qe={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(a){return(b,y)=>(_(),v("button",{class:d(["switch",{"bg-current":a.active}])},[s("span",{class:d(["-mt-0.1em",{"text-white":a.active}])},[Z(b.$slots,"default",{},void 0,!0)],2)],2))}},G=z(qe,[["__scopeId","data-v-8bd1e4e9"]]),g=a=>(be("data-v-714a1dce"),a=a(),we(),a),We={class:"side_list"},He={class:"flex"},Je=["onClick","title"],Qe={class:"chapter_head"},Xe={class:"mr-9 grid xl:mr-0"},Ye=["title"],Ze=g(()=>s("span",{class:"chapter_head_number"},"01.png",-1)),et={class:"mt-auto flex items-end justify-end gap-2"},tt=g(()=>s("span",{class:"text-sm opacity-50"},"セリフにキーワードを指定したい場合は、文字を[]で囲んでください。",-1)),st=g(()=>s("p",{class:"chapter_head_desc"},[ne("目が覚めたら見知らぬ教室、辺るは水族館のような不思議な光景…自己紹介した後、どこから来た「モノカイ」と自称するぬいぐるみは俺たちをここでコロシアイ学園生活を強いられた。ここから脱出する条件は一つ――誰にばれないように殺人をすることだった。"),s("br"),ne("目が覚めたら見知らぬ教室、辺るは水族館のような不思議な光景…自己紹介した後、どこから来た「モノカイ」と自称するぬいぐるみは俺たちをここでコロシアイ学園生活を強いられた。ここから脱出する条件は一つ――誰にばれないように殺人をすることだった。")],-1)),at={class:"chapter_log"},lt=g(()=>s("div",{class:"chapter_log_tr -lock"},[s("div",{class:"chapter_log_th ml-16"},"セリフ＆切り替え＆演出"),s("div",{class:"ml-4 w-8 shrink-0"})],-1)),nt=g(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"話し手．主人公差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"脇役．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE"),s("div",{class:"chapter_log_th -col"},"ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),ot={key:0,class:"contents"},ct=["draggable","onDragstart","onDragend"],it={class:"chapter_log_scene"},dt=g(()=>s("div",{class:"ml-2 w-8 shrink-0"},null,-1)),rt={class:"chapter_log_tr_2"},ut=g(()=>s("div",{class:"chapter_log_td -col"},null,-1)),_t=g(()=>s("div",{class:"chapter_log_td -col"},null,-1)),pt=g(()=>s("div",{class:"chapter_log_td -col"},null,-1)),vt=g(()=>s("div",{class:"chapter_log_td -col"},null,-1)),ht={class:"chapter_log_td -col"},mt={key:1,class:"contents"},ft=["draggable","onDragstart","onDragend"],yt={class:"chapter_log_avatar"},gt=["src"],bt={class:"chapter_log_switches"},wt=g(()=>s("span",{class:"dark:text-dark-wrap"},"R",-1)),xt=g(()=>s("span",{class:"dark:text-dark-wrap"},"U",-1)),kt=g(()=>s("span",{class:"dark:text-dark-wrap"},"S",-1)),$t={class:"chapter_log_tr_2"},Ct={class:"chapter_log_td -col"},Ut=g(()=>s("option",{class:"text-primary",value:""},"話し手",-1)),St={class:"chapter_log_td -col"},Dt=g(()=>s("option",{value:""},"脇役",-1)),Bt={class:"chapter_log_td -col"},Mt={class:"chapter_log_td -col"},It={class:"chapter_log_td -col"},Tt={__name:"Chapters",setup(a){const b=ye(),{characterList:y}=ae(b),m=ge(),{newChapter:r,dialogType:c}=m,{chapterIndex:u,chapterNames:h,chapterTitle:w,chapterData:i}=ae(m),{dragMove:A,dropMove:$}=$e(),B=[{id:"場景(切換)"},{id:"演出"}],E=l=>[{id:"BG",show:l.人物==="場景(切換)"},{id:"BGM",show:l.人物==="場景(切換)"},{id:"CG",show:l.人物==="演出"},{id:"暗場",show:l.人物==="演出"},{id:"動畫",show:l.人物==="演出"}],k=P(()=>y.value.map(l=>({id:l.name}))),f=l=>({"!bg-secondary !text-black/60 dark:!text-neutral-800/75":!!l}),M=l=>y.value.find(o=>(l.人物??"")===o.name)??{},K=(l,o)=>{const x=o.對白,e=x.slice(0,l.start),p=x.slice(l.start,l.end),t=x.slice(l.end);o.對白=[e,"[",p,"]",t].join("")},O=P(()=>i.value.some(l=>l.dragging)),N=P(()=>i.value.filter(l=>l.is_selected).map(l=>l.id)),F=(l,o,x)=>{x&&A(l,{index:o}),N.value.some(p=>i.value[o].id===p)||(i.value[o].is_selected=1),N.value.forEach(p=>{const t=i.value.find(ue=>ue.id===p);t.dragging=x,x||(t.is_selected=0)})},R=(l,o)=>{N.value.forEach(x=>{const e=i.value.findIndex(p=>p.id===x);$(i.value,e,o)})},ee=D(!1),q=D(0),te=D(null),W=(l,o)=>{q.value=o,te.value=l,ee.value=o===null},re=({type:l})=>{const o=q.value,x=i.value[o];if(l==="delete")x.is_delete=!0;else{const e=q.value===null?i.value.length:q.value+1;i.value.splice(e,0,r(l))}};return(l,o)=>{const x=j("visible");return _(),le(ke,null,{side:C(()=>[s("ul",We,[(_(!0),v(L,null,Q(S(h),(e,p)=>(_(),v("li",He,[n(Ue,{class:"mt-0.6em bg-current/10",active:p===S(u)},null,8,["active"]),s("button",{class:d(["side_item",{"side_item-active":p===S(u)}]),onClick:t=>u.value=p,title:e},V(e),11,Je)]))),256))])]),main_head:C(()=>[s("div",Qe,[s("div",Xe,[s("h1",{class:"chapter_head_title",title:S(w)},V(S(w)),9,Ye),Ze,s("div",et,[tt,n(G,{class:"bg-keyword text-keyword-dark"},{default:C(()=>[n(Te,{class:"mt-0.1em"})]),_:1}),n(G,{class:"relative text-primary bg-primary/25"},{default:C(()=>[n(S(xe),{class:"mt-0.1em"}),n(Y,{class:"absolute left-0 top-0 opacity-0",onMore:o[0]||(o[0]=e=>W(e,null)),hasDel:!1,hasAdd:!1})]),_:1})])]),st])]),default:C(()=>[s("div",at,[lt,nt,n(oe,{class:"chapter_log_dragline",onDrop:o[1]||(o[1]=e=>R(e,0)),dragging:O.value},null,8,["dragging"]),(_(!0),v(L,null,Q(S(i),(e,p)=>(_(),v(L,{key:e.id},[e.is_showtime?U((_(),v("div",ot,[s("div",{class:d(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:t=>F(t,p,!0),onDragend:t=>F(t,p,!1),onDrag:o[2]||(o[2]=H(()=>{},["prevent"])),onDrop:o[3]||(o[3]=H(()=>{},["prevent"]))},[s("div",{class:d(["chapter_log_td flex px-2",{"bg-secondary/60":e.is_selected}])},[n(ie,{class:"mr-1 shrink-0",value:e.is_selected,"onUpdate:value":t=>e.is_selected=t},null,8,["value","onUpdate:value"]),n(Y,{class:"-mx-1 shrink-0 px-1",onMore:t=>W(t,p),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",it,[n(J,{value:e.人物,"onUpdate:value":t=>e.人物=t,options:B,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0,onChange:t=>{e.show_time="",e.show_name=""}},null,8,["value","onUpdate:value","onFocus","onBlur","onChange"]),n(J,{value:e.show_time,"onUpdate:value":t=>e.show_time=t,options:E(e),onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0,onChange:t=>e.show_name=""},null,8,["value","onUpdate:value","options","onFocus","onBlur","onChange"]),n(I,{value:e.show_name,"onUpdate:value":t=>e.show_name=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onFocus","onBlur"])])],2),dt],42,ct),s("div",rt,[ut,_t,pt,vt,s("div",ht,[n(I,{class:d(["-inner",f(e.備註)]),value:e.備註,"onUpdate:value":t=>e.備註=t},null,8,["value","onUpdate:value","class"])])])],512)),[[X,!e.is_delete]]):U((_(),v("div",mt,[s("div",{class:d(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:t=>F(t,p,!0),onDragend:t=>F(t,p,!1),onDrag:o[4]||(o[4]=H(()=>{},["prevent"])),onDrop:o[5]||(o[5]=H(()=>{},["prevent"]))},[s("div",{class:d(["chapter_log_td flex px-2",{"bg-secondary/60":e.is_selected}])},[n(ie,{class:"mr-1 shrink-0",value:e.is_selected,"onUpdate:value":t=>e.is_selected=t},null,8,["value","onUpdate:value"]),n(Y,{class:"-mx-1 shrink-0 px-1",onMore:t=>W(t,p),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",{class:d(["chapter_log_info",{"flex-row-reverse":M(e).is_hero,"-replay":e.is_replay}])},[U((_(),v("div",yt,[s("img",{src:M(e).image_head},null,8,gt)])),[[x,M(e).image_head]]),s("div",{class:d(["chapter_log_dialog",{"-hero":M(e).is_hero}])},[n(Ce,{class:"my-auto w-full",value:e.對白,type:S(c)(e)},null,8,["value","type"]),n(ce,{class:"chapter_log_dialog_input",value:e.對白,"onUpdate:value":t=>e.對白=t,onSelected:t=>K(t,e),onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onSelected","onFocus","onBlur"])],2)],2)],2),s("div",bt,[n(G,{class:d(["chapter_log_switch",{"text-replay":e.is_replay}]),onClick:t=>e.is_replay=!e.is_replay,active:e.is_replay,title:"再放送"},{default:C(()=>[wt]),_:2},1032,["onClick","active","class"]),n(G,{class:d(["chapter_log_switch",{"text-unknown":e.is_unknown}]),onClick:t=>e.is_unknown=!e.is_unknown,active:e.is_unknown,title:"未紹介"},{default:C(()=>[xt]),_:2},1032,["onClick","active","class"]),n(G,{class:d(["chapter_log_switch",{"text-monolog-dark dark:text-monolog":e.is_solo}]),onClick:t=>e.is_solo=!e.is_solo,active:e.is_solo,title:"独り言"},{default:C(()=>[kt]),_:2},1032,["onClick","active","class"])])],42,ft),s("div",$t,[s("div",Ct,[e.is_announce||e.is_system?(_(),v("div",{key:0,class:d(["-inner col-span-2",f(!0)])},V(e.人物),3)):(_(),le(J,{key:1,class:d(["-inner col-span-2",f(e.人物)]),value:e.人物,"onUpdate:value":t=>e.人物=t,options:k.value,placeholder:"話し手"},{default:C(()=>[Ut]),_:2},1032,["value","onUpdate:value","options","class"])),n(I,{class:d(["-inner",f(e.十六夜差分)]),value:e.十六夜差分,"onUpdate:value":t=>e.十六夜差分=t,placeholder:"主人公差分"},null,8,["value","onUpdate:value","class"]),n(I,{class:d(["-inner",f(e.主角特效)]),value:e.主角特效,"onUpdate:value":t=>e.主角特效=t,placeholder:"主人公エフェクト"},null,8,["value","onUpdate:value","class"])]),s("div",St,[n(J,{class:d(["-inner col-span-2",f(e.顯示角色)]),value:e.顯示角色,"onUpdate:value":t=>e.顯示角色=t,options:k.value,placeholder:"脇役"},{default:C(()=>[Dt]),_:2},1032,["value","onUpdate:value","options","class"]),n(I,{class:d(["-inner",f(e.角色差分)]),value:e.角色差分,"onUpdate:value":t=>e.角色差分=t,placeholder:"脇役差分"},null,8,["value","onUpdate:value","class"]),n(I,{class:d(["-inner",f(e.差分特效)]),value:e.差分特效,"onUpdate:value":t=>e.差分特效=t,placeholder:"脇役エフェクト"},null,8,["value","onUpdate:value","class"])]),s("div",Bt,[n(I,{class:d(["-inner",f(e.SE)]),value:e.SE,"onUpdate:value":t=>e.SE=t},null,8,["value","onUpdate:value","class"])]),s("div",Mt,[n(I,{class:d(["-inner",f(e.Voice)]),value:e.Voice,"onUpdate:value":t=>e.Voice=t},null,8,["value","onUpdate:value","class"])]),s("div",It,[n(ce,{class:d(["-inner",f(e.備註)]),value:e.備註,"onUpdate:value":t=>e.備註=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","class","onFocus","onBlur"])])])],512)),[[X,!e.is_delete]]),n(oe,{class:"chapter_log_dragline",onDrop:t=>R(t,p+1),dragging:O.value},null,8,["onDrop","dragging"])],64))),128))]),n(Re,{positions:te.value,onClear:W,onUse:re,onlyAdd:ee.value},null,8,["positions","onlyAdd"])]),_:1})}}},Gt=z(Tt,[["__scopeId","data-v-714a1dce"]]);export{Gt as default};
