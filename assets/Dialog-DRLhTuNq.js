import{_ as P,m as ee,r as H,i as $,q as z,w as g,o as C,c as L,a as t,n as O,j as Y,F as te,x as se,t as N,v as T,M as oe,e as m,N as ae,g as V,D as ue,H as ce,O as pe,P as de,u as re,s as j,h as ve,b as _e,d as _,C as M,J as he,K as me,f as fe}from"./index-D0GbkE8i.js";/* empty css                                                             */import{_ as J}from"./Input-BFAgUE_7.js";const ge={class:"menu_list"},we={class:"contents"},ye=["onClick","title"],be={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(l,{emit:w}){const d=l,r=w,{getClientRect:h}=ee(),u=H(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],c=$(()=>{const{width:y,height:S}=h(document.documentElement),{width:b,height:f}=h(u.value),{x:U,y:R,width:E,height:B}=d.positions??{},e=(R??0)+(B??0)/2-(f??0)/2,G=(e<20?20:e)+"px",D=(S??0)-(f??0)-20+"px",A=`min(${G}, ${D})`,K=(U??0)+(b??0)>y,F=(U??0)+(E??0)+2,q=(U??0)-(b??0)-9-2,W=(K?q:F)+"px";return{top:A,left:W}}),v=$(()=>{const{width:y}=h(document.documentElement),{width:S}=h(u.value),{x:b,y:f,width:U,height:R}=d.positions??{},E=(f??0)+(R??0)/2,B=(b??0)+(S??0)>y,e=(b??0)+(U??0)+3,G=(b??0)-3.2,D=B?G:e;return{top:E+"px",left:D+"px",turn:B}}),a=y=>{y.target.matches(".menu, .menu *")||r("clear",null)},x=y=>{r("use",{type:y}),r("clear",null)};return(y,S)=>{const b=z("visible");return g((C(),L("div",{class:"menu_container",onClick:a},[t("div",{class:O(["menu_triangle",{"-scale-x-100":v.value.turn}]),style:Y(v.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:Y(c.value),ref_key:"menu",ref:u},[t("ul",ge,[(C(),L(te,null,se(p,f=>t("li",we,[g(t("button",{class:O(["menu_item",f.class]),onClick:U=>x(f.type),title:f.title},N(f.title),11,ye),[[T,!(["copy","edit","delete"].includes(f.type)&&l.onlyAdd)]])])),64))])],4)])),[[b,l.positions]])}}},Dt=P(be,[["__scopeId","data-v-e4cfe076"]]),xe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Se=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),ke=[Se];function $e(l,w){return C(),L("svg",xe,[...ke])}const Ce={name:"ic-round-close",render:$e},Le=["disabled","placeholder"],Te=["value"],Ue={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:w}){oe(p=>({c45911e2:m(h).light.text}));const d=l,r=w,{colors:h}=ae(),u=H("");return V(u,p=>r("update:value",p)),V(()=>d.value,p=>u.value=p,{immediate:!0}),(p,c)=>{const v=z("verify");return g((C(),L("select",{class:"select","onUpdate:modelValue":c[0]||(c[0]=a=>u.value=a),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},[ce(p.$slots,"default",{},void 0,!0),(C(!0),L(te,null,se(l.options,a=>g((C(),L("option",{key:a.id??a.name??a.title??a,value:a.id??a},N(a.name??a.title??a.id??a),9,Te)),[[T,a.show??!0]])),128))],8,Le)),[[ue,u.value,void 0,{lazy:!0,trim:!0}],[v,void 0,void 0,{check:!0}]])}}},k=P(Ue,[["__scopeId","data-v-8ba13645"]]),Be=["disabled","placeholder"],Me={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(l,{emit:w}){const d=l,r=w,h=H(null),u=H(""),p=c=>{if(!c.ctrlKey)return;const{selectionStart:v,selectionEnd:a}=h.value;r("selected",{start:v,end:a})};return V(u,c=>r("update:value",c)),V(()=>d.value,c=>u.value=c,{immediate:!0}),(c,v)=>{const a=z("verify");return g((C(),L("textarea",{class:"scrollbar textarea","onUpdate:modelValue":v[0]||(v[0]=x=>u.value=x),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder,onKeydown:de(p,["q"]),ref_key:"textarea",ref:h},null,40,Be)),[[pe,u.value,void 0,{lazy:!0,trim:!0}],[a,void 0,void 0,{check:!0}]])}}},Z=P(Me,[["__scopeId","data-v-c1e57f9a"]]),i=l=>(he("data-v-0885ae18"),l=l(),me(),l),Oe={class:"popup_window"},Ee={class:"popup_header"},Ge={class:"popup_close",title:"キャンセル"},De={class:"popup_container scrollbar"},Ie={class:"contents"},Ne={class:"contents"},He={class:"popup_label"},Ve=i(()=>t("div",{class:"-col-2"},null,-1)),Pe={class:"contents"},Re=i(()=>t("span",{class:"popup_label"},"内容",-1)),je={value:""},ze={class:"contents"},Ae={class:"contents"},Ke=i(()=>t("span",{class:"popup_label"},"話し手",-1)),Fe={class:"popup_input"},qe={class:"contents"},We=i(()=>t("span",{class:"popup_label"},"話し手",-1)),Je={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Qe={class:"popup_group"},Xe=i(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Ye={class:"contents"},Ze=i(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),et=i(()=>t("option",{value:""},"無指定",-1)),tt={class:"contents"},st=i(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),ot=i(()=>t("option",{value:""},"継ぐ",-1)),at={class:"contents"},lt=i(()=>t("span",{class:"popup_label"},"エフェクト",-1)),nt=i(()=>t("option",{value:""},"なし",-1)),it={class:"popup_group"},ut=i(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),ct={class:"contents"},pt=i(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),dt=i(()=>t("option",{value:""},"無指定",-1)),rt={class:"contents"},vt=i(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),_t=i(()=>t("option",{value:""},"継ぐ",-1)),ht={class:"contents"},mt=i(()=>t("span",{class:"popup_label"},"エフェクト",-1)),ft=i(()=>t("option",{value:""},"なし",-1)),gt={class:"contents"},wt=i(()=>t("span",{class:"popup_label"},"SE",-1)),yt={class:"contents"},bt=i(()=>t("span",{class:"popup_label"},"ボイス",-1)),xt={class:"contents"},St=i(()=>t("span",{class:"popup_label"},"セリフ",-1)),kt={class:"-col-3 grid gap-1"},$t=i(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Ct={class:"contents"},Lt=i(()=>t("span",{class:"popup_label"},"備考",-1)),Tt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(l,{emit:w}){const d=l,r=w,h=re(),{getCharacter:u}=h,{characterList:p,characterReals:c}=j(h),v=ve(),{newLog:a}=v,{chapterData:x}=j(v),y=_e(),{effectList:S,backgroundList:b,cgList:f,bgmList:U,seList:R}=j(y),{isDev:E,findData:B}=ee(),e=H({}),G=$(()=>{var n;return(n=u(e.value.人物))==null?void 0:n.name}),D=$(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform}]),A=[{id:"前"},{id:"後"},{id:"續"}],K=$(()=>{const n=e.value.show_time;if(n==="BG")return b.value;if(n==="CG")return f.value;if(n==="暗場")return A}),F=$(()=>p.value.filter(n=>!n.disabled||n.unknown)),q=$(()=>Q(e.value.顯示角色)),W=$(()=>Q(e.value.立ち絵2)),Q=n=>{var s;return((s=u(n))==null?void 0:s.sprite)??[]},le=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},X=n=>e.value[n]="",ne=()=>{const n={...e.value};if(d.id==="add")r("add",n);else{const I=B(x.value,d.id);Object.assign(I,n)}r("update:open",!1),(!n.is_showtime||n.show_time==="暗場")&&r("target",n.id)},ie=n=>{const s=n.target.matches(".popup_window, .popup_window *"),I=n.target.matches(".popup_close");(!s||I)&&r("update:open",!1)};return V(()=>d.open,n=>{n&&(d.id==="add"?e.value=a(d.type):e.value={...B(x.value,d.id)},E&&console.log({...e.value}))}),(n,s)=>{const I=z("visible");return g((C(),L("section",{class:"popup",onClick:ie},[t("div",Oe,[t("header",Ee,[t("button",Ge,[_(m(Ce),{class:"pointer-events-none"})])]),t("div",De,[g(t("div",Ie,[t("div",Ne,[t("span",He,N(e.value.人物),1),_(k,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:D.value,onChange:le},null,8,["value","options"])]),Ve,t("div",Pe,[Re,g(_(J,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[T,e.value.show_time==="BGM"]]),g(_(k,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:K.value},{default:M(()=>[t("option",je,N(e.value.show_time==="暗場"?"全":"なし"),1)]),_:1},8,["value","options"]),[[T,e.value.show_time!=="BGM"]])])],512),[[T,e.value.is_showtime]]),g(t("div",ze,[g(t("div",Ae,[Ke,t("span",Fe,N(G.value),1)],512),[[T,e.value.is_announce||e.value.is_system]]),g(t("div",qe,[We,_(k,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:F.value},null,8,["value","options"])],512),[[T,!(e.value.is_announce||e.value.is_system)]]),t("div",Je,[t("button",{class:O(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:O(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:O(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",Qe,[Xe,t("div",Ye,[Ze,_(k,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),options:m(c),onChange:s[8]||(s[8]=o=>X("角色差分"))},{default:M(()=>[et]),_:1},8,["value","options"])]),t("div",tt,[st,_(k,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:q.value},{default:M(()=>[ot]),_:1},8,["value","options"])]),t("div",at,[lt,_(k,{class:"popup_select",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o),options:m(S)},{default:M(()=>[nt]),_:1},8,["value","options"])])]),t("div",it,[ut,t("div",ct,[pt,_(k,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),options:m(c),onChange:s[12]||(s[12]=o=>X("十六夜差分"))},{default:M(()=>[dt]),_:1},8,["value","options"])]),t("div",rt,[vt,_(k,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:W.value},{default:M(()=>[_t]),_:1},8,["value","options"])]),t("div",ht,[mt,_(k,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o),options:m(S)},{default:M(()=>[ft]),_:1},8,["value","options"])])]),t("div",gt,[wt,_(J,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",yt,[bt,_(J,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",xt,[St,t("div",kt,[_(Z,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),$t])])],512),[[T,!e.value.is_showtime]]),t("div",Ct,[Lt,_(Z,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:ne,title:"保存"},"保存")])])])),[[I,l.open]])}}},It=P(Tt,[["__scopeId","data-v-0885ae18"]]),Ut={class:"dialog_wrap"},Bt=["data-content","innerHTML"],Mt={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(l){oe(a=>({"35896f63":m(u).lineHeight,"4d5ca058":m(u).letterSpace,"15be853d":m(u).fontLength,f66c4386:m(p).keyword.dark,"729921a5":m(p).monolog.dark,"0085a039":m(p).announce.dark}));const w=l,d=fe(),{fontFamily:r,fontWeight:h,fontStyle:u}=j(d),{colors:p}=ae(),c=$(()=>{const a=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),x=v("keyword"),S=w.value.replace(a,`<span class="${x}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:w.value.replace(/\[|\]/g,""),html:S}}),v=a=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[a]??"text-white";return(a,x)=>(C(),L("div",{class:O(["dialog",[m(r).dialog,m(h).dialog]])},[t("div",Ut,[t("pre",{class:O(v(l.type)),"data-content":c.value.value,innerHTML:c.value.html},null,10,Bt)])],2))}},Nt=P(Mt,[["__scopeId","data-v-0b46230a"]]);export{Nt as D,It as E,Dt as M};
