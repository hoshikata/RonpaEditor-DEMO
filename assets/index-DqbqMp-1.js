import{_ as T,o as l,c as r,a as c,u as X,b as Y,w as h,v as D,F as q,t as V,d as e,e as u,n as N,f as ae,s as G,r as z,g as S,h as oe,i as f,j as P,k as xe,l as ke,m as W,p as Ce,q as E,x as U,y as J,z as le,A as Se,B as Be,C as te,D as j,E as _e,G as Ie}from"./index-DMwXrg5Y.js";import{I as me,a as Ge,D as Me}from"./IconDelete-nuF1Dwna.js";import{D as ze,M as Le,S as De,E as Ee}from"./Dialog-BHWGVvSd.js";import{W as Ne}from"./Wrap-BWCnewSH.js";import{R as qe}from"./Range-VdC6uGwy.js";import{_ as M}from"./Image-VlQ1-7jx.js";/* empty css                                                             */const Te={name:"MdiTarget"},He={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Ve=c("path",{fill:"currentColor",d:"M11 2v2.07A8 8 0 0 0 4.07 11H2v2h2.07A8 8 0 0 0 11 19.93V22h2v-2.07A8 8 0 0 0 19.93 13H22v-2h-2.07A8 8 0 0 0 13 4.07V2m-2 4.08V8h2V6.09c2.5.41 4.5 2.41 4.92 4.91H16v2h1.91c-.41 2.5-2.41 4.5-4.91 4.92V16h-2v1.91C8.5 17.5 6.5 15.5 6.08 13H8v-2H6.09C6.5 8.5 8.5 6.5 11 6.08M12 11a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1"},null,-1),Ue=[Ve];function Ae(t,o,s,p,m,g){return l(),r("svg",He,Ue)}const Pe=T(Te,[["render",Ae]]),je={name:"RiShiningFill"},Oe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Fe=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),Re=[Fe];function We(t,o,s,p,m,g){return l(),r("svg",Oe,Re)}const Je=T(je,[["render",We]]),Ke={name:"RiShiningLine"},Qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Xe=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),Ye=[Xe];function Ze(t,o,s,p,m,g){return l(),r("svg",Qe,Ye)}const et=T(Ke,[["render",Ze]]),tt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},st=c("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),nt=[st];function at(t,o){return l(),r("svg",tt,[...nt])}const ot={name:"ic-round-queue-music",render:at},lt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},it=c("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),ct=[it];function rt(t,o){return l(),r("svg",lt,[...ct])}const ut={name:"ic-sharp-keyboard-voice",render:rt},dt={name:"MaterialSymbolsEditSquareOutline"},vt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},pt=c("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h8.925l-2 2H5v14h14v-6.95l2-2V19q0 .825-.587 1.413T19 21zm4-6v-4.25l9.175-9.175q.3-.3.675-.45t.75-.15q.4 0 .763.15t.662.45L22.425 3q.275.3.425.663T23 4.4t-.137.738t-.438.662L13.25 15zM21.025 4.4l-1.4-1.4zM11 13h1.4l5.8-5.8l-.7-.7l-.725-.7L11 11.575zm6.5-6.5l-.725-.7zl.7.7z"},null,-1),_t=[pt];function mt(t,o,s,p,m,g){return l(),r("svg",vt,_t)}const ge=T(dt,[["render",mt]]),gt={class:"contents"},ht={class:"preview_log_head"},ft={class:"preview_log_title"},yt={class:"preview_log_subtitle !text-base"},wt={class:"preview_log_content"},bt={class:"preview_log_foot"},$t={class:"preview_log_head"},xt={class:"shrink-0 font-medium"},kt={class:"preview_log_subtitle text-xs leading-none"},Ct={class:"h-1em"},St={class:"h-1em"},Bt={class:"preview_log_content"},It={class:"preview_log_foot"},Gt={class:"preview_log_mark_1"},Mt={class:"preview_log_mark_1"},zt={class:"preview_log_mark_1"},Lt={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:o}){const s=o,p=X(),{getCharacter:m,getSprite:g}=p,a=Y(),{getShowName:v}=a;return(i,n)=>h((l(),r("article",{class:N(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(l(),r(q,{key:0},[c("div",gt,[c("header",ht,[c("h6",ft,V(t.log.人物),1),c("p",yt,V(t.log.show_time),1)]),c("p",wt,V(e(v)(t.log.show_time,t.log.show_name)),1)]),c("footer",bt,[c("button",{class:"preview_button ml-auto",onClick:n[0]||(n[0]=d=>s("edit")),title:"編集"},[u(ge,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:n[1]||(n[1]=d=>s("delete")),title:"削除"},[u(me,{class:"text-[0.9em]"})])])],64)):(l(),r(q,{key:1},[c("button",{class:"group contents",onClick:n[2]||(n[2]=d=>{s("update:id",t.log.id),s("stop")})},[c("header",$t,[c("h6",xt,V(e(m)(t.log.人物).name),1),c("p",kt,[c("span",Ct,V(e(m)(t.log.顯示角色).name)+" / "+V(e(g)(t.log.顯示角色,t.log.十六夜差分).name),1),c("span",St,V(e(m)(t.log.立ち絵2).name)+" / "+V(e(g)(t.log.立ち絵2,t.log.角色差分).name),1)])]),c("p",Bt,V(t.log.和訳),1)]),c("footer",It,[h(c("span",Gt,"R",512),[[D,t.log.is_replay]]),h(c("span",Mt,"U",512),[[D,t.log.is_unknown]]),h(c("span",zt,"S",512),[[D,t.log.is_monolog]]),h(u(Je,{class:"preview_log_mark_2"},null,512),[[D,t.log.差分特效]]),h(u(et,{class:"preview_log_mark_2"},null,512),[[D,t.log.主角特效]]),h(u(e(ot),{class:"preview_log_mark_2"},null,512),[[D,t.log.SE]]),h(u(e(ut),{class:"preview_log_mark_2"},null,512),[[D,t.log.Voice]]),c("button",{class:"preview_button ml-auto",onClick:n[3]||(n[3]=d=>s("edit")),title:"編集"},[u(ge,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:n[4]||(n[4]=d=>s("delete")),title:"削除"},[u(me,{class:"text-[0.9em]"})])])],64))],2)),[[D,!t.log.is_delete]])}},Dt=T(Lt,[["__scopeId","data-v-57d4ef86"]]),Et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Nt=c("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),qt=[Nt];function Tt(t,o){return l(),r("svg",Et,[...qt])}const Ht={name:"ic-baseline-stop",render:Tt},Vt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ut=c("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),At=[Ut];function Pt(t,o){return l(),r("svg",Vt,[...At])}const jt={name:"ic-baseline-play-arrow",render:Pt},Ot={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ft=c("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),Rt=[Ft];function Wt(t,o){return l(),r("svg",Ot,[...Rt])}const he={name:"ic-baseline-skip-previous",render:Wt},Jt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Kt=c("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),Qt=[Kt];function Xt(t,o){return l(),r("svg",Jt,[...Qt])}const Yt={name:"ic-baseline-fullscreen",render:Xt},Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},es=c("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),ts=[es];function ss(t,o){return l(),r("svg",Zt,[...ts])}const ns={name:"ic-baseline-fullscreen-exit",render:ss},as={class:"preview_control"},os=["disabled"],ls=["disabled"],is={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:o}){const s=t,p=o,m=ae(),{fullscreen:g}=G(m),a=z(0);S(a,i=>p("update:index",i)),S(()=>s.index,i=>a.value=i,{immediate:!0});const v=()=>{const i=a.value;!s.play||s.black||setTimeout(()=>{const n=a.value>=s.length&&!s.black;s.index===i&&s.play&&!s.black&&!s.typing&&!n&&(a.value+=1),n&&p("update:play",!1),v()},3e3)};return S(()=>s.play,v),S(()=>s.typing,v),(i,n)=>(l(),r("div",as,[c("button",{class:"preview_button",onClick:n[0]||(n[0]=d=>{a.value-=1,p("stop")}),disabled:a.value===0,title:"前へ"},[u(e(he))],8,os),c("button",{class:"preview_button",onClick:n[1]||(n[1]=d=>p("update:play",!t.play)),title:"プレイ"},[h(u(e(jt),null,null,512),[[D,!t.play]]),h(u(e(Ht),null,null,512),[[D,t.play]])]),c("button",{class:"preview_button",onClick:n[2]||(n[2]=d=>{a.value+=1,p("stop")}),disabled:a.value===t.length,title:"次へ"},[u(e(he),{class:"-scale-x-100"})],8,ls),u(qe,{class:"mx-3 grow !bg-dark-text",value:a.value,"onUpdate:value":n[3]||(n[3]=d=>a.value=d),onChange:n[4]||(n[4]=d=>p("stop")),min:0,max:t.length,step:1},null,8,["value","max"]),c("button",{class:"preview_button",onClick:n[5]||(n[5]=d=>g.value=!e(g)),title:"全画面モード"},[h(u(e(Yt),null,null,512),[[D,!e(g)]]),h(u(e(ns),null,null,512),[[D,e(g)]])])]))}},cs=T(is,[["__scopeId","data-v-63ddedb4"]]),rs={__name:"Comment",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:o}){const s=t,p=o,m=oe(),{dialogType:g}=m,a=z({}),v=z(0),i=f(()=>a.value.和訳??""),n=f(()=>s.play?i.value.slice(0,v.value):i.value),d=f(()=>({"margin-left":"15cqw","margin-right":"15cqw","margin-bottom":"3.2cqw"})),x=()=>{i.value&&(p("update:typing",!0),v.value=0)},$=()=>{if(!s.play||s.black)return;if(v.value===i.value.length)return p("update:typing",!1);setTimeout(()=>{s.typing?v.value+=1:v.value=i.value.length},25)};return S(()=>s.data,w=>{w.is_showtime||(a.value=w)}),S(a,x),S(i,$),S(n,$),S(v,$),S(()=>s.black,w=>{w||$()}),(w,L)=>(l(),r("article",{class:"preview_dialog",style:P(d.value)},[u(ze,{value:n.value,type:e(g)(t.data)},null,8,["value","type"])],4))}},us=T(rs,[["__scopeId","data-v-95429636"]]),K=xe("log",()=>{const t=ke(),o=oe(),{chapterData:s}=G(o),p=Y(),{getHistoryList:m}=p,{findData:g,findIndex:a}=W(),v=z(0),i=z(0),n=z({}),d=f(()=>s.value.filter(_=>!_.is_delete)),x=f(()=>d.value.filter(_=>{const k=!_.is_showtime,O=_.is_perform&&_.show_time==="暗場";return k||O})),$=f(()=>{const _=a(d.value,v.value)+1,k=d.value.slice(0,_),O=d.value.slice(_);return O.every(F=>F.is_showtime&&F.show_time!=="暗場")&&k.push(...O),k});S(v,_=>{const k=g(s.value,_)??{};k.is_scene||(n.value=k,i.value=a(x.value,k.id))}),S(i,_=>{var k;return v.value=((k=x.value[_])==null?void 0:k.id)??0}),S(s,()=>{var _;return v.value=((_=x.value[0])==null?void 0:_.id)??0}),Ce(()=>{var _;return v.value=((_=x.value[0])==null?void 0:_.id)??0});const w=f(()=>{const _=m($.value,"CG");return((_==null?void 0:_.show_name)??"")!==""&&(_==null?void 0:_.show_name)!=="結束"}),L=z(!1),B=z(!1),I=z(!1),H=f(()=>({"":L.value}));return S(()=>t.name,()=>L.value=!1),{logId:v,logIndex:i,logData:n,logShowing:d,logContents:x,logHistory:$,logCGMode:w,logPlay:L,logTyping:B,logBlack:I,playEase:H}}),ds={class:"-ui bg-black",id:"Background"},vs={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const o=t,s=K(),{playEase:p}=G(s),m=Y(),{getHistoryList:g}=m,{backgroundList:a}=G(m),v=f(()=>{var i;return(i=g(o.contents,"BG"))==null?void 0:i.show_name});return(i,n)=>{const d=E("opacity");return l(),r("div",ds,[(l(!0),r(q,null,U(e(a),x=>h((l(),J(M,{class:N(["-ui",e(p)]),src:x.path},null,8,["src","class"])),[[d,x.id===v.value]])),256))])}}},ps={class:"-ui",id:"Effect"},fe={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const o=K(),{playEase:s}=G(o),p=Y(),{effectList:m}=G(p);return(g,a)=>{const v=E("opacity");return l(),r("div",ps,[(l(!0),r(q,null,U(e(m),i=>h((l(),J(M,{class:N(["-ui",e(s)]),src:i.path,alt:i.name},null,8,["src","class","alt"])),[[v,i.id===t.data[t.name]]])),256))])}}},_s=["data-name"],ms={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const o=t,s=X(),{getSpriteNow:p}=s,{characterList:m}=G(s),g=K(),{playEase:a}=G(g);W();const{uiUrl:v}=le(),i={name:"顯示角色",sprite:"角色差分",effect:"差分特效"},n=f(()=>o.isCG?"人物":i.name),d=f(()=>p(o.contents,o.data[n.value],n.value,i.sprite)),x=f(()=>({"mask-image":o.isCG?"":`url(${v("mask_4")})`})),$=f(()=>o.isCG?{}:{top:"0cqw",left:"-10cqw"}),w=f(()=>o.isCG?{}:{width:"100cqw"});return(L,B)=>{const I=E("visible"),H=E("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite",style:P(x.value)},[c("div",{class:"sprite_container",style:P($.value)},[c("div",{class:"sprite_inner",style:P(w.value)},[(l(!0),r(q,null,U(e(m),_=>h((l(),r("div",{key:_.id,class:N(["-ui",e(a)]),"data-name":_.name},[(l(!0),r(q,null,U(_.sprite??[],k=>h((l(),J(M,{key:k.id,class:"sprite",src:k.path},null,8,["src"])),[[I,k.id===d.value]])),128))],10,_s)),[[H,_.id===t.data[n.value]]])),128))],4)],4),u(fe,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},gs=T(ms,[["__scopeId","data-v-71e5fbe8"]]),hs=["data-name"],fs={__name:"Sprite2",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const o=t,s=X(),{getSpriteNow:p}=s,{characterList:m}=G(s),g=K(),{playEase:a}=G(g);W();const{uiUrl:v}=le(),i={name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"},n=f(()=>o.isCG?"人物":i.name),d=f(()=>p(o.contents,o.data[n.value],n.value,i.sprite)),x=f(()=>({"mask-image":o.isCG?"":`url(${v("mask_3")})`})),$=f(()=>o.isCG?{}:{top:"13cqw",left:"37cqw"}),w=f(()=>o.isCG?{}:{width:"85cqw"});return(L,B)=>{const I=E("visible"),H=E("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite2",style:P(x.value)},[c("div",{class:"sprite_container",style:P($.value)},[c("div",{class:"sprite_inner",style:P(w.value)},[(l(!0),r(q,null,U(e(m),_=>h((l(),r("div",{key:_.id,class:N(["-ui",e(a)]),"data-name":_.name},[(l(!0),r(q,null,U(_.sprite??[],k=>h((l(),J(M,{key:k.id,class:"sprite",src:k.path},null,8,["src"])),[[I,k.id===d.value]])),128))],10,hs)),[[H,_.id===t.data[n.value]]])),128))],4)],4),u(fe,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},ys=T(fs,[["__scopeId","data-v-2efdc5c1"]]),ws={class:"-ui bg-black",id:"CG"},bs={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const o=t,s=Y(),{getHistoryList:p}=s,{cgList:m}=G(s),g=f(()=>{var a;return(a=p(o.contents,"CG"))==null?void 0:a.show_name});return(a,v)=>{const i=E("opacity");return l(),r("div",ws,[(l(!0),r(q,null,U(e(m),n=>h((l(),J(M,{class:"-ui !object-cover",src:n.path},null,8,["src"])),[[i,n.id===g.value]])),256))])}}},$s={class:"-ui",id:"UI"},xs={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const o=t,s=X(),{getCharacter:p}=s,m=K(),{playEase:g}=G(m);W();const{uiUrl:a}=le();f(()=>p(o.data.人物));const v=f(()=>o.data.人物===o.data.立ち絵2),i=f(()=>!v.value&&!o.data.is_system&&!o.data.is_announce),n=f(()=>v.value&&!o.data.is_monolog);return(d,x)=>{const $=E("visible"),w=E("opacity");return l(),r("div",$s,[h((l(),r("div",{class:N(["-ui",e(g)])},[c("div",{class:"-ui -mask",style:P({"mask-image":"url("+e(a)("mask_2")+")"})},null,4),u(M,{class:"-ui",src:e(a)("01-1")},null,8,["src"]),u(M,{class:"-ui",src:e(a)("01-2")},null,8,["src"]),u(M,{class:"-ui",src:e(a)("01-3")},null,8,["src"]),u(M,{class:"-ui",src:e(a)("01-4")},null,8,["src"]),h(u(M,{class:"-ui",src:e(a)("01-5")},null,8,["src"]),[[$,i.value]]),h(u(M,{class:"-ui",src:e(a)("01-6")},null,8,["src"]),[[$,n.value]])],2)),[[w,!t.isCG]]),h((l(),r("div",{class:N(["-ui",e(g)])},[u(M,{class:"-ui",src:e(a)("02-1")},null,8,["src"]),h(u(M,{class:"-ui",src:e(a)("02-2")},null,8,["src"]),[[$,i.value]]),h(u(M,{class:"-ui",src:e(a)("02-2")},null,8,["src"]),[[$,n.value]])],2)),[[w,t.isCG]]),h(c("div",{class:N(["-ui -replay",e(g)])},null,2),[[w,t.data.is_replay]])])}}},ks=T(xs,[["__scopeId","data-v-d4d4c7f8"]]),Cs={class:"-ui",id:"NameTag"},Ss={class:"-ui"},Bs={class:"name_tag -font"},Is={class:"-ui"},Gs={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},isCG:{type:[Boolean],default:!1}},setup(t){const o=t,s=ae(),{fontFamily:p,fontWeight:m}=G(s),g=X(),{getCharacter:a}=g,{characterList:v}=G(g),{findData:i}=W(),n=f(()=>a(o.data.人物)),d=f(()=>i(v.value,0)),x=f(()=>o.data.人物===o.data.立ち絵2),$=f(()=>({width:"100cqw",height:"4cqw",bottom:"13.5cqw",left:x.value&&!o.isCG?"71cqw":"4cqw","font-size":"2.5cqw"}));return(w,L)=>{const B=E("opacity");return l(),r("div",Cs,[h((l(),r("div",{class:N(["absolute",[e(p).nameTag,e(m).nameTag]]),style:P($.value)},[h((l(),r("div",Ss,[(l(!0),r(q,null,U(e(v),I=>h((l(),r("div",{key:I.id,class:"-ui"},[h((l(),r("p",Bs,[Se(V(I.name),1)])),[[B,!I.image_name]]),h(u(M,{class:"name_tag",src:I.image_name},null,8,["src"]),[[B,I.image_name]])])),[[B,I.id===n.value.id]])),128))])),[[B,!t.data.is_unknown]]),h((l(),r("div",Is,[u(M,{class:"name_tag",src:d.value.image_name},null,8,["src"])])),[[B,t.data.is_unknown]])],6)),[[B,!t.data.is_monolog&&!t.data.is_system&&!t.data.is_announce]])])}}},Ms=T(Gs,[["__scopeId","data-v-b28d85c4"]]),zs=3e3,Ls={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:black"],setup(t,{emit:o}){const s=t,p=o,m=f(()=>s.data.show_time==="暗場"),g=z({}),a=f(()=>(g.value.show_name??"").split(",")),v=f(()=>!a.value.includes("前")),i=f(()=>!a.value.includes("後"));f(()=>a.value.includes("續"));const n=z(!1),d=z(!1),x=()=>{if(m.value){if(g.value={...s.data},d.value=s.play&&v.value,n.value=!0,p("update:black",!0),!s.play)return;setTimeout(()=>{s.index>=s.length||p("update:index",s.index+1)},zs)}else d.value=s.play&&i.value,n.value=!1,p("update:black",!1)};return S(m,x),S(()=>s.play,x),($,w)=>{const L=E("opacity");return h((l(),r("div",{class:N(["-ui z-20 bg-black",{"duration-1000":d.value}]),id:"Black"},null,2)),[[L,n.value]])}}},Ds={class:"preview_title"},Es=["value"],Ns=["onDragstart","onDragend","data-id"],qs={class:"preview"},Ts={class:"-ui"},Hs={__name:"index",setup(t){const o=ae(),{fullscreen:s}=G(o),p=oe(),{chapterIndex:m,chapterNames:g,chapterData:a}=G(p),v=K(),{logId:i,logIndex:n,logData:d,logShowing:x,logContents:$,logHistory:w,logCGMode:L,logPlay:B,logTyping:I,logBlack:H,playEase:_}=G(v),{getClientRect:k}=W(),{dragMove:O,dropMove:ie}=Ie(),F=()=>{B.value=!1,I.value=!1};S(m,F);const ye=f(()=>a.value.some(C=>C.dragging)),ce=(C,y,R)=>{R&&O(C,{index:y}),a.value[y].dragging=R},we=(C,y)=>ie(a.value,C.index,y),re=z(null),Z=()=>{const C=[...re.value].find(ne=>ne.dataset.id*1===i.value);if(!C)return;const{height:y,top:R}=k(C);C.parentElement.scrollBy({top:R-y,behavior:"smooth"})};S(i,()=>{B.value&&Z()});const ue=z(null);S(s,C=>{window.api?window.api.fullscreen(C):C?ue.value.requestFullscreen():document.exitFullscreen()});const de=z(null),ve=C=>de.value=C,se=z(!1),ee=Be({id:0,type:""}),pe=(C,{type:y})=>{ee.id=C,ee.type=y??"",se.value=!0},be=C=>a.value.push(C),$e=C=>{i.value=C,setTimeout(Z,100)};return(C,y)=>{const R=E("opacity"),ne=E("visible");return l(),J(Ne,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:te(()=>[u(Le,{positions:de.value,onClear:ve,onUse:y[0]||(y[0]=b=>pe("add",b)),onlyAdd:!0},null,8,["positions"]),c("section",Ds,[u(De,{class:"preview_title_select",value:e(m),"onUpdate:value":y[1]||(y[1]=b=>j(m)?m.value=b:null)},{default:te(()=>[(l(!0),r(q,null,U(e(g),(b,Q)=>(l(),r("option",{value:Q},V(b),9,Es))),256))]),_:1},8,["value"]),h(c("button",{class:"preview_button",onClick:Z,title:"今の画面のセリフへ"},[u(Pe)],512),[[D,!e(s)]]),c("button",{class:"preview_button",onClick:ve,title:"新規"},[u(e(Ge))])])]),side:te(()=>[(l(!0),r(q,null,U(e(a),(b,Q)=>(l(),r("div",{key:b.id,class:N(["relative",{"-dragging":b.dragging}]),draggable:!0,onDragstart:A=>ce(A,Q,!0),onDragend:A=>ce(A,Q,!1),onDrag:y[3]||(y[3]=_e(()=>{},["prevent"])),onDrop:y[4]||(y[4]=_e(()=>{},["prevent"])),"data-id":b.id,ref_for:!0,ref_key:"logElem",ref:re},[u(Dt,{id:e(i),"onUpdate:id":y[2]||(y[2]=A=>j(i)?i.value=A:null),log:b,onEdit:A=>pe(b.id,{}),onDelete:A=>b.is_delete=!0,onStop:F},null,8,["id","log","onEdit","onDelete"]),u(Me,{class:"preview_dragline !h-1 !text-secondary/50",onDrop:A=>we(A,Q+1),dragging:ye.value},null,8,["onDrop","dragging"])],42,Ns))),128))]),default:te(()=>[c("section",{class:"preview_container",ref_key:"preview",ref:ue},[c("div",qs,[h((l(),r("div",Ts,[u(vs,{contents:e(w)},null,8,["contents"]),u(gs,{data:e(d),contents:e(w),isCG:e(L)},null,8,["data","contents","isCG"]),u(ys,{data:e(d),contents:e(w),isCG:e(L)},null,8,["data","contents","isCG"]),h(u(bs,{contents:e(w),class:N(e(_))},null,8,["contents","class"]),[[R,e(L)]]),u(ks,{data:e(d),contents:e(w),isCG:e(L)},null,8,["data","contents","isCG"])])),[[ne,e(a).length]]),u(Ms,{data:e(d),isCG:e(L)},null,8,["data","isCG"]),u(us,{data:e(d),play:e(B),typing:e(I),"onUpdate:typing":y[5]||(y[5]=b=>j(I)?I.value=b:null),black:e(H)},null,8,["data","play","typing","black"]),u(Ls,{index:e(n),"onUpdate:index":y[6]||(y[6]=b=>j(n)?n.value=b:null),data:e(d),play:e(B),black:e(H),"onUpdate:black":y[7]||(y[7]=b=>j(H)?H.value=b:null),length:e($).length-1},null,8,["index","data","play","black","length"])]),u(cs,{index:e(n),"onUpdate:index":y[8]||(y[8]=b=>j(n)?n.value=b:null),play:e(B),"onUpdate:play":y[9]||(y[9]=b=>j(B)?B.value=b:null),typing:e(I),black:e(H),length:e($).length-1,onTarget:Z,onStop:F},null,8,["index","play","typing","black","length"])],512),u(Ee,{open:se.value,"onUpdate:open":y[10]||(y[10]=b=>se.value=b),id:ee.id,type:ee.type,onAdd:be,onTarget:$e},null,8,["open","id","type"])]),_:1})}}},Rs=T(Hs,[["__scopeId","data-v-e7ba9244"]]);export{Rs as default};
