import{_ as z,o as m,d as f,a as s,r as S,e as M,f as L,g as C,v as X,u as ce,h as ie,i as I,j as re,k as de,n as i,t as W,l as le,m as ue,p as H,q as Y,F as q,s as J,x as Q,y as _e,z as Z,A as ve,c as pe,w as B,b as l,B as R,C as he,D as me,E as ee}from"./index-BQezU8EP.js";import{I as fe,C as O,D as te,u as ge}from"./useDrag-MN950v-y.js";import{W as ye}from"./Wrap-zYaevpRg.js";import{D as be}from"./Dialog-DH2V_rJ-.js";import{M as xe}from"./Mark-BqigWc8v.js";const ke={name:"MdiExclamationThick"},we={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},$e=s("path",{fill:"currentColor",d:"M10 3h4v11h-4zm0 18v-4h4v4z"},null,-1),Ue=[$e];function Se(a,g,y,h,d,n){return m(),f("svg",we,Ue)}const Ce=z(ke,[["render",Se]]),De=["disabled","placeholder"],Be={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:g}){const y=a,h=g,d=S("");return M(d,n=>h("update:value",n)),M(()=>y.value,n=>d.value=n,{immediate:!0}),(n,p)=>{const v=L("verify");return C((m(),f("input",{"onUpdate:modelValue":p[0]||(p[0]=r=>d.value=r),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder},null,8,De)),[[X,d.value,void 0,{lazy:!0,trim:!0}],[v,void 0,void 0,{check:!0}]])}}},Ie=["disabled","placeholder"],Me={__name:"Select",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:g}){ce(p=>({"2f5f8e9e":I(d).light.text}));const y=a,h=g,{colors:d}=ie(),n=S("");return M(n,p=>h("update:value",p)),M(()=>y.value,p=>n.value=p,{immediate:!0}),(p,v)=>{const r=L("verify");return C((m(),f("input",{class:"select","onUpdate:modelValue":v[0]||(v[0]=U=>n.value=U),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder},null,8,Ie)),[[X,n.value,void 0,{lazy:!0,trim:!0}],[r,void 0,void 0,{check:!0}]])}}},k=z(Me,[["__scopeId","data-v-4bed1850"]]),Te=["disabled","placeholder"],se={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(a,{emit:g}){const y=a,h=g,d=S(null),n=S(""),p=v=>{if(!v.ctrlKey)return;const{selectionStart:r,selectionEnd:U}=d.value;h("selected",{start:r,end:U})};return M(n,v=>h("update:value",v)),M(()=>y.value,v=>n.value=v,{immediate:!0}),(v,r)=>{const U=L("verify");return C((m(),f("textarea",{class:"scrollbar min-h-0 resize-none","onUpdate:modelValue":r[0]||(r[0]=A=>n.value=A),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder,onKeydown:re(p,["q"]),ref_key:"textarea",ref:d},null,40,Te)),[[X,n.value,void 0,{lazy:!0,trim:!0}],[U,void 0,void 0,{check:!0}]])}}},Ee=["disabled"],Fe={class:"whitespace-nowrap"},Ve={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(a,{emit:g}){const y=a,h=g,d=S(0);return M(d,n=>h("update:value",n)),M(()=>y.value,n=>d.value=n,{immediate:!0}),(n,p)=>(m(),f("label",{class:i(["inline-flex items-center",a.disabled?"cursor-auto":"cursor-pointer"])},[C(s("input",{class:i(["checkbox",a.box]),"onUpdate:modelValue":p[0]||(p[0]=v=>d.value=v),disabled:a.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,Ee),[[de,d.value]]),s("span",Fe,W(a.title),1),le(n.$slots,"default",{},void 0,!0)],2))}},ae=z(Ve,[["__scopeId","data-v-63853167"]]),ze={class:"menu_list"},Ae={class:"contents"},Ne=["onClick"],Le={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(a,{emit:g}){const y=a,h=g,{getClientRect:d}=ue(),n=S(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：動画",type:"perform_anime"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],v=H(()=>{const{height:u}=d(document.documentElement),{height:D}=d(n.value),{x:w,y:$,width:T,height:E}=y.positions??{},F=($??0)+(E??0)/2-(D??0)/2,P=(F<20?20:F)+"px",j=(u??0)-(D??0)-20+"px",V=`min(${P}, ${j})`,K=(w??0)+(T??0)+2+"px";return{top:V,left:K}}),r=H(()=>{const{x:u,y:D,width:w,height:$}=y.positions??{},T=(D??0)+($??0)/2,E=(u??0)+(w??0)+3;return{top:T+"px",left:E+"px"}}),U=u=>{u.target.matches(".menu, .menu *")||h("clear",null)},A=u=>{h("use",{type:u}),h("clear",null)};return(u,D)=>{const w=L("visible");return C((m(),f("div",{class:"fixed inset-0 z-50 h-dvh w-dvw overflow-hidden",onClick:U},[s("div",{class:"menu_triangle",style:Y(r.value)},null,4),s("div",{class:"menu scrollbar overflow-y-auto",style:Y(v.value),ref_key:"menu",ref:n},[s("ul",ze,[(m(),f(q,null,J(p,$=>s("li",Ae,[C(s("button",{class:i(["menu_item",$.class]),onClick:T=>A($.type)},W($.title),11,Ne),[[Q,!($.type==="delete"&&a.onlyAdd)]])])),64))])],4)])),[[w,a.positions]])}}},Pe=z(Le,[["__scopeId","data-v-4bfa70ca"]]),je={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(a){return(g,y)=>(m(),f("button",{class:i(["switch",{"bg-current":a.active}])},[s("span",{class:i(["-mt-0.1em",{"text-white":a.active}])},[le(g.$slots,"default",{},void 0,!0)],2)],2))}},N=z(je,[["__scopeId","data-v-8bd1e4e9"]]),x=a=>(he("data-v-b1de7e26"),a=a(),me(),a),Ke={class:"side_list"},Ge={class:"flex"},Re=["onClick","title"],qe={class:"chapter_head"},We={class:"mr-9 grid xl:mr-0"},He=["title"],Oe=x(()=>s("span",{class:"chapter_head_number"},"01.png",-1)),Je={class:"mt-auto flex items-end justify-end gap-2"},Qe=x(()=>s("span",{class:"text-sm opacity-50"},"セリフにキーワードを指定したい場合は、文字を[]で囲んでください。",-1)),Xe=x(()=>s("p",{class:"chapter_head_desc"},[ee("目が覚めたら見知らぬ教室、辺るは水族館のような不思議な光景…自己紹介した後、どこから来た「モノカイ」と自称するぬいぐるみは俺たちをここでコロシアイ学園生活を強いられた。ここから脱出する条件は一つ――誰にばれないように殺人をすることだった。"),s("br"),ee("目が覚めたら見知らぬ教室、辺るは水族館のような不思議な光景…自己紹介した後、どこから来た「モノカイ」と自称するぬいぐるみは俺たちをここでコロシアイ学園生活を強いられた。ここから脱出する条件は一つ――誰にばれないように殺人をすることだった。")],-1)),Ye={class:"chapter_log"},Ze=x(()=>s("div",{class:"chapter_log_tr -lock"},[s("div",{class:"chapter_log_th ml-16"},"セリフ＆切り替え＆演出"),s("div",{class:"ml-4 w-8 shrink-0"})],-1)),et=x(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"話し手．主人公差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"脇役．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE"),s("div",{class:"chapter_log_th -col"},"ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),tt={key:0,class:"contents"},st=["draggable","onDragstart","onDragend"],at={class:"chapter_log_scene"},lt=x(()=>s("div",{class:"ml-2 w-8 shrink-0"},null,-1)),nt={class:"chapter_log_tr_2"},ot=x(()=>s("div",{class:"chapter_log_td -col"},null,-1)),ct=x(()=>s("div",{class:"chapter_log_td -col"},null,-1)),it=x(()=>s("div",{class:"chapter_log_td -col"},null,-1)),rt=x(()=>s("div",{class:"chapter_log_td -col"},null,-1)),dt={class:"chapter_log_td -col"},ut={key:1,class:"contents"},_t=["draggable","onDragstart","onDragend"],vt={class:"chapter_log_avatar"},pt=["src"],ht={class:"chapter_log_switches"},mt=x(()=>s("span",{class:"dark:text-dark-wrap"},"R",-1)),ft=x(()=>s("span",{class:"dark:text-dark-wrap"},"U",-1)),gt=x(()=>s("span",{class:"dark:text-dark-wrap"},"S",-1)),yt={class:"chapter_log_tr_2"},bt={class:"chapter_log_td -col"},xt={class:"chapter_log_td -col"},kt={class:"chapter_log_td -col"},wt={class:"chapter_log_td -col"},$t={class:"chapter_log_td -col"},Ut={__name:"Chapters",setup(a){const g=_e(),{characterList:y}=Z(g),h=ve(),{newChapter:d}=h,{chapterIndex:n,chapterNames:p,chapterTitle:v,chapterData:r}=Z(h),{dragMove:U,dropMove:A}=ge(),u=c=>({"!bg-secondary !text-black/60 dark:!text-neutral-800/75":!!c}),D=c=>c.is_solo?"monolog":c.is_announce?"announce":"",w=c=>y.value.find(o=>(c.人物??"")===o.name)??{},$=(c,o)=>{const b=o.對白,e=b.slice(0,c.start),_=b.slice(c.start,c.end),t=b.slice(c.end);o.對白=[e,"[",_,"]",t].join("")},T=H(()=>r.value.some(c=>c.dragging)),E=H(()=>r.value.filter(c=>c.is_selected).map(c=>c.id)),F=(c,o,b)=>{b&&U(c,{index:o}),E.value.some(_=>r.value[o].id===_)||(r.value[o].is_selected=1),E.value.forEach(_=>{const t=r.value.find(oe=>oe.id===_);t.dragging=b,b||(t.is_selected=0)})},P=(c,o)=>{E.value.forEach(b=>{const e=r.value.findIndex(_=>_.id===b);A(r.value,e,o)})},j=S(!1),V=S(0),K=S(null),G=(c,o)=>{V.value=o,K.value=c,j.value=o===null},ne=({type:c})=>{const o=V.value,b=r.value[o];if(c==="delete")b.is_delete=!0;else{const e=V.value===null?r.value.length:V.value+1;r.value.splice(e,0,d(c))}};return(c,o)=>{const b=L("visible");return m(),pe(ye,null,{side:B(()=>[s("ul",Ke,[(m(!0),f(q,null,J(I(p),(e,_)=>(m(),f("li",Ge,[l(xe,{class:"mt-0.6em bg-current/10",active:_===I(n)},null,8,["active"]),s("button",{class:i(["side_item",{"side_item-active":_===I(n)}]),onClick:t=>n.value=_,title:e},W(e),11,Re)]))),256))])]),main_head:B(()=>[s("div",qe,[s("div",We,[s("h1",{class:"chapter_head_title",title:I(v)},W(I(v)),9,He),Oe,s("div",Je,[Qe,l(N,{class:"bg-keyword text-keyword-dark"},{default:B(()=>[l(Ce,{class:"mt-0.1em"})]),_:1}),l(N,{class:"relative text-primary bg-primary/25"},{default:B(()=>[l(I(fe),{class:"mt-0.1em"}),l(O,{class:"absolute left-0 top-0 opacity-0",onMore:o[0]||(o[0]=e=>G(e,null)),hasDel:!1,hasAdd:!1})]),_:1})])]),Xe])]),default:B(()=>[s("div",Ye,[Ze,et,l(te,{class:"chapter_log_dragline",onDrop:o[1]||(o[1]=e=>P(e,0)),dragging:T.value},null,8,["dragging"]),(m(!0),f(q,null,J(I(r),(e,_)=>(m(),f(q,{key:e.id},[e.is_showtime?C((m(),f("div",tt,[s("div",{class:i(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:t=>F(t,_,!0),onDragend:t=>F(t,_,!1),onDrag:o[2]||(o[2]=R(()=>{},["prevent"])),onDrop:o[3]||(o[3]=R(()=>{},["prevent"]))},[s("div",{class:i(["chapter_log_td flex px-2",{"bg-secondary/60":e.is_selected}])},[l(ae,{class:"mr-1 shrink-0",value:e.is_selected,"onUpdate:value":t=>e.is_selected=t},null,8,["value","onUpdate:value"]),l(O,{class:"shrink-0",onMore:t=>G(t,_),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",at,[l(k,{value:e.人物,"onUpdate:value":t=>e.人物=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onFocus","onBlur"]),l(k,{value:e.show,"onUpdate:value":t=>e.show=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onFocus","onBlur"]),l(k,{value:e.show_name,"onUpdate:value":t=>e.show_name=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onFocus","onBlur"])])],2),lt],42,st),s("div",nt,[ot,ct,it,rt,s("div",dt,[l(Be,{class:i(["-inner",u(e.備註)]),value:e.備註,"onUpdate:value":t=>e.備註=t},null,8,["value","onUpdate:value","class"])])])],512)),[[Q,!e.is_delete]]):C((m(),f("div",ut,[s("div",{class:i(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:t=>F(t,_,!0),onDragend:t=>F(t,_,!1),onDrag:o[4]||(o[4]=R(()=>{},["prevent"])),onDrop:o[5]||(o[5]=R(()=>{},["prevent"]))},[s("div",{class:i(["chapter_log_td flex px-2",{"bg-secondary/60":e.is_selected}])},[l(ae,{class:"mr-1 shrink-0",value:e.is_selected,"onUpdate:value":t=>e.is_selected=t},null,8,["value","onUpdate:value"]),l(O,{class:"shrink-0",onMore:t=>G(t,_),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",{class:i(["chapter_log_info",{"flex-row-reverse":w(e).is_hero,"-replay":e.is_replay}])},[C((m(),f("div",vt,[s("img",{src:w(e).image_head},null,8,pt)])),[[b,w(e).image_head]]),s("div",{class:i(["chapter_log_dialog",{"-hero":w(e).is_hero}])},[l(be,{class:"my-auto w-full",value:e.對白,type:D(e)},null,8,["value","type"]),l(se,{class:"chapter_log_dialog_input",value:e.對白,"onUpdate:value":t=>e.對白=t,onSelected:t=>$(t,e),onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","onSelected","onFocus","onBlur"])],2)],2)],2),s("div",ht,[l(N,{class:i(["chapter_log_switch",{"text-replay":e.is_replay}]),onClick:t=>e.is_replay=!e.is_replay,active:e.is_replay,title:"再放送"},{default:B(()=>[mt]),_:2},1032,["onClick","active","class"]),l(N,{class:i(["chapter_log_switch",{"text-unknown":e.is_unknown}]),onClick:t=>e.is_unknown=!e.is_unknown,active:e.is_unknown,title:"未紹介"},{default:B(()=>[ft]),_:2},1032,["onClick","active","class"]),l(N,{class:i(["chapter_log_switch",{"text-monolog-dark dark:text-monolog":e.is_solo}]),onClick:t=>e.is_solo=!e.is_solo,active:e.is_solo,title:"独り言"},{default:B(()=>[gt]),_:2},1032,["onClick","active","class"])])],42,_t),s("div",yt,[s("div",bt,[l(k,{class:i(["-inner col-span-2",u(e.人物)]),value:e.人物,"onUpdate:value":t=>e.人物=t,placeholder:"話し手"},null,8,["value","onUpdate:value","class"]),l(k,{class:i(["-inner",u(e.十六夜差分)]),value:e.十六夜差分,"onUpdate:value":t=>e.十六夜差分=t,placeholder:"主人公差分"},null,8,["value","onUpdate:value","class"]),l(k,{class:i(["-inner",u(e.主角特效)]),value:e.主角特效,"onUpdate:value":t=>e.主角特效=t,placeholder:"主人公エフェクト"},null,8,["value","onUpdate:value","class"])]),s("div",xt,[l(k,{class:i(["-inner col-span-2",u(e.顯示角色)]),value:e.顯示角色,"onUpdate:value":t=>e.顯示角色=t,placeholder:"脇役"},null,8,["value","onUpdate:value","class"]),l(k,{class:i(["-inner",u(e.角色差分)]),value:e.角色差分,"onUpdate:value":t=>e.角色差分=t,placeholder:"脇役差分"},null,8,["value","onUpdate:value","class"]),l(k,{class:i(["-inner",u(e.差分特效)]),value:e.差分特效,"onUpdate:value":t=>e.差分特效=t,placeholder:"脇役エフェクト"},null,8,["value","onUpdate:value","class"])]),s("div",kt,[l(k,{class:i(["-inner",u(e.SE)]),value:e.SE,"onUpdate:value":t=>e.SE=t},null,8,["value","onUpdate:value","class"])]),s("div",wt,[l(k,{class:i(["-inner",u(e.Voice)]),value:e.Voice,"onUpdate:value":t=>e.Voice=t},null,8,["value","onUpdate:value","class"])]),s("div",$t,[l(se,{class:i(["-inner",u(e.備註)]),value:e.備註,"onUpdate:value":t=>e.備註=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,8,["value","onUpdate:value","class","onFocus","onBlur"])])])],512)),[[Q,!e.is_delete]]),l(te,{class:"chapter_log_dragline",onDrop:t=>P(t,_+1),dragging:T.value},null,8,["onDrop","dragging"])],64))),128))]),l(Pe,{positions:K.value,onClear:G,onUse:ne,onlyAdd:j.value},null,8,["positions","onlyAdd"])]),_:1})}}},Mt=z(Ut,[["__scopeId","data-v-b1de7e26"]]);export{Mt as default};
