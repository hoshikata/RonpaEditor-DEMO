import{_ as T,o as l,c as r,a as c,u as K,b as Q,w as m,v as N,F as q,t as V,d as e,e as u,n as U,f as ne,s as I,r as z,g as B,h as ae,i as f,j as D,k as he,l as ge,m as F,p as fe,q as L,x as A,y as R,z as oe,A as ye,B as we,C as se,D as be,E as j}from"./index-DBHXhL4u.js";import{I as ue,a as $e}from"./IconDelete-CiV-FiI4.js";import{W as xe}from"./Wrap-CUfiMRF-.js";import{D as ke,M as Ce,E as Se}from"./Dialog-BmxjBILh.js";import{R as Be}from"./Range-Cubf8r1V.js";import{_ as G}from"./Image-DvWA8E0Z.js";/* empty css                                                             */const Ie={name:"MdiTarget"},Ge={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},ze=c("path",{fill:"currentColor",d:"M11 2v2.07A8 8 0 0 0 4.07 11H2v2h2.07A8 8 0 0 0 11 19.93V22h2v-2.07A8 8 0 0 0 19.93 13H22v-2h-2.07A8 8 0 0 0 13 4.07V2m-2 4.08V8h2V6.09c2.5.41 4.5 2.41 4.92 4.91H16v2h1.91c-.41 2.5-2.41 4.5-4.91 4.92V16h-2v1.91C8.5 17.5 6.5 15.5 6.08 13H8v-2H6.09C6.5 8.5 8.5 6.5 11 6.08M12 11a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1"},null,-1),Me=[ze];function Ee(t,a,s,v,g,h){return l(),r("svg",Ge,Me)}const Ne=T(Ie,[["render",Ee]]),Le={name:"RiShiningFill"},qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Te=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),He=[Te];function Ve(t,a,s,v,g,h){return l(),r("svg",qe,He)}const Ue=T(Le,[["render",Ve]]),Ae={name:"RiShiningLine"},De={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Pe=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),je=[Pe];function Oe(t,a,s,v,g,h){return l(),r("svg",De,je)}const Fe=T(Ae,[["render",Oe]]),Re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},We=c("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),Je=[We];function Ke(t,a){return l(),r("svg",Re,[...Je])}const Qe={name:"ic-round-queue-music",render:Ke},Xe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ye=c("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),Ze=[Ye];function et(t,a){return l(),r("svg",Xe,[...Ze])}const tt={name:"ic-sharp-keyboard-voice",render:et},st={name:"MaterialSymbolsEditSquareOutline"},nt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},at=c("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h8.925l-2 2H5v14h14v-6.95l2-2V19q0 .825-.587 1.413T19 21zm4-6v-4.25l9.175-9.175q.3-.3.675-.45t.75-.15q.4 0 .763.15t.662.45L22.425 3q.275.3.425.663T23 4.4t-.137.738t-.438.662L13.25 15zM21.025 4.4l-1.4-1.4zM11 13h1.4l5.8-5.8l-.7-.7l-.725-.7L11 11.575zm6.5-6.5l-.725-.7zl.7.7z"},null,-1),ot=[at];function lt(t,a,s,v,g,h){return l(),r("svg",nt,ot)}const de=T(st,[["render",lt]]),it={class:"preview_log_head"},ct={class:"preview_log_title"},rt={class:"preview_log_subtitle text-sm"},ut={class:"preview_log_content"},dt={class:"preview_log_foot"},pt={class:"preview_log_head group-hover:opacity-75"},vt={class:"shrink-0 font-medium"},_t={class:"preview_log_subtitle text-xs leading-none"},mt={class:"h-1em"},ht={class:"h-1em"},gt={class:"preview_log_content group-hover:opacity-75"},ft={class:"preview_log_foot"},yt={class:"preview_log_mark_1"},wt={class:"preview_log_mark_1"},bt={class:"preview_log_mark_1"},$t={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:a}){const s=a,v=K(),{getCharacter:g,getSprite:h}=v,o=Q(),{getShowName:p}=o;return(i,n)=>m((l(),r("article",{class:U(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(l(),r(q,{key:0},[c("header",it,[c("h6",ct,V(t.log.人物),1),c("p",rt,V(t.log.show_time),1)]),c("p",ut,V(e(p)(t.log.show_time,t.log.show_name)),1),c("footer",dt,[c("button",{class:"preview_button ml-auto",onClick:n[0]||(n[0]=d=>s("edit")),title:"編集"},[u(de,{class:"text-[0.9em]"})]),c("button",{class:"preview_button ml-1",onClick:n[1]||(n[1]=d=>s("delete")),title:"削除"},[u(ue,{class:"text-[0.9em]"})])])],64)):(l(),r(q,{key:1},[c("button",{class:"group contents",onClick:n[2]||(n[2]=d=>{s("update:id",t.log.id),s("stop")})},[c("header",pt,[c("h6",vt,V(e(g)(t.log.人物).name),1),c("p",_t,[c("span",mt,V(e(g)(t.log.顯示角色).name)+" / "+V(e(h)(t.log.顯示角色,t.log.十六夜差分).name),1),c("span",ht,V(e(g)(t.log.立ち絵2).name)+" / "+V(e(h)(t.log.立ち絵2,t.log.角色差分).name),1)])]),c("p",gt,V(t.log.和訳),1)]),c("footer",ft,[m(c("span",yt,"R",512),[[N,t.log.is_replay]]),m(c("span",wt,"U",512),[[N,t.log.is_unknown]]),m(c("span",bt,"S",512),[[N,t.log.is_monolog]]),m(u(Ue,{class:"preview_log_mark_2"},null,512),[[N,t.log.差分特效]]),m(u(Fe,{class:"preview_log_mark_2"},null,512),[[N,t.log.主角特效]]),m(u(e(Qe),{class:"preview_log_mark_2"},null,512),[[N,t.log.SE]]),m(u(e(tt),{class:"preview_log_mark_2"},null,512),[[N,t.log.Voice]]),c("button",{class:"preview_button ml-auto",onClick:n[3]||(n[3]=d=>s("edit")),title:"編集"},[u(de)]),c("button",{class:"preview_button ml-1",onClick:n[4]||(n[4]=d=>s("delete")),title:"削除"},[u(ue)])])],64))],2)),[[N,!t.log.is_delete]])}},xt=T($t,[["__scopeId","data-v-1db57c61"]]),kt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ct=c("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),St=[Ct];function Bt(t,a){return l(),r("svg",kt,[...St])}const It={name:"ic-baseline-stop",render:Bt},Gt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},zt=c("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),Mt=[zt];function Et(t,a){return l(),r("svg",Gt,[...Mt])}const Nt={name:"ic-baseline-play-arrow",render:Et},Lt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},qt=c("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),Tt=[qt];function Ht(t,a){return l(),r("svg",Lt,[...Tt])}const pe={name:"ic-baseline-skip-previous",render:Ht},Vt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ut=c("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),At=[Ut];function Dt(t,a){return l(),r("svg",Vt,[...At])}const Pt={name:"ic-baseline-fullscreen",render:Dt},jt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ot=c("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),Ft=[Ot];function Rt(t,a){return l(),r("svg",jt,[...Ft])}const Wt={name:"ic-baseline-fullscreen-exit",render:Rt},Jt={class:"preview_control"},Kt=["disabled"],Qt=["disabled"],Xt={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:a}){const s=t,v=a,g=ne(),{fullscreen:h}=I(g),o=z(0);B(o,i=>v("update:index",i)),B(()=>s.index,i=>o.value=i,{immediate:!0});const p=()=>{const i=o.value;!s.play||s.black||setTimeout(()=>{const n=o.value>=s.length&&!s.black;s.index===i&&s.play&&!s.black&&!s.typing&&!n&&(o.value+=1),n&&v("update:play",!1),p()},3e3)};return B(()=>s.play,p),B(()=>s.typing,p),(i,n)=>(l(),r("div",Jt,[c("button",{class:"preview_button",onClick:n[0]||(n[0]=d=>{o.value-=1,v("stop")}),disabled:o.value===0,title:"前へ"},[u(e(pe))],8,Kt),c("button",{class:"preview_button",onClick:n[1]||(n[1]=d=>v("update:play",!t.play)),title:"プレイ"},[m(u(e(Nt),null,null,512),[[N,!t.play]]),m(u(e(It),null,null,512),[[N,t.play]])]),c("button",{class:"preview_button",onClick:n[2]||(n[2]=d=>{o.value+=1,v("stop")}),disabled:o.value===t.length,title:"次へ"},[u(e(pe),{class:"-scale-x-100"})],8,Qt),u(Be,{class:"mx-3 grow !bg-dark-text",value:o.value,"onUpdate:value":n[3]||(n[3]=d=>o.value=d),onChange:n[4]||(n[4]=d=>v("stop")),min:0,max:t.length,step:1},null,8,["value","max"]),c("button",{class:"preview_button",onClick:n[5]||(n[5]=d=>h.value=!e(h)),title:"全画面モード"},[m(u(e(Pt),null,null,512),[[N,!e(h)]]),m(u(e(Wt),null,null,512),[[N,e(h)]])])]))}},Yt=T(Xt,[["__scopeId","data-v-63ddedb4"]]),Zt={__name:"Comment",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:a}){const s=t,v=a,g=ae(),{dialogType:h}=g,o=z({}),p=z(0),i=f(()=>o.value.和訳??""),n=f(()=>s.play?i.value.slice(0,p.value):i.value),d=f(()=>({"margin-left":"15cqw","margin-right":"15cqw","margin-bottom":"3.2cqw"})),x=()=>{i.value&&(v("update:typing",!0),p.value=0)},w=()=>{if(!s.play||s.black)return;if(p.value===i.value.length)return v("update:typing",!1);setTimeout(()=>{s.typing?p.value+=1:p.value=i.value.length},25)};return B(()=>s.data,y=>{y.is_showtime||(o.value=y)}),B(o,x),B(i,w),B(n,w),B(p,w),B(()=>s.black,y=>{y||w()}),(y,M)=>(l(),r("article",{class:"preview_dialog",style:D(d.value)},[u(ke,{value:n.value,type:e(h)(t.data)},null,8,["value","type"])],4))}},es=T(Zt,[["__scopeId","data-v-95429636"]]),W=he("log",()=>{const t=ge(),a=ae(),{chapterData:s}=I(a),v=Q(),{getHistoryList:g}=v,{findData:h,findIndex:o}=F(),p=z(0),i=z(0),n=z({}),d=f(()=>s.value.filter(_=>!_.is_delete)),x=f(()=>d.value.filter(_=>{const k=!_.is_showtime,P=_.is_perform&&_.show_time==="暗場";return k||P})),w=f(()=>{const _=o(d.value,p.value)+1,k=d.value.slice(0,_),P=d.value.slice(_);return P.every(O=>O.is_showtime&&O.show_time!=="暗場")&&k.push(...P),k});B(p,_=>{const k=h(s.value,_)??{};k.is_scene||(n.value=k,i.value=o(x.value,k.id))}),B(i,_=>{var k;return p.value=((k=x.value[_])==null?void 0:k.id)??0}),B(s,()=>{var _;return p.value=((_=x.value[0])==null?void 0:_.id)??0}),fe(()=>{var _;return p.value=((_=x.value[0])==null?void 0:_.id)??0});const y=f(()=>{const _=g(w.value,"CG");return((_==null?void 0:_.show_name)??"")!==""&&(_==null?void 0:_.show_name)!=="結束"}),M=z(!1),S=z(!1),C=z(!1),H=f(()=>({"":M.value}));return B(()=>t.name,()=>M.value=!1),{logId:p,logIndex:i,logData:n,logShowing:d,logContents:x,logHistory:w,logCGMode:y,logPlay:M,logTyping:S,logBlack:C,playEase:H}}),ts={class:"-ui bg-black",id:"Background"},ss={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const a=t,s=W(),{playEase:v}=I(s),g=Q(),{getHistoryList:h}=g,{backgroundList:o}=I(g),p=f(()=>{var i;return(i=h(a.contents,"BG"))==null?void 0:i.show_name});return(i,n)=>{const d=L("opacity");return l(),r("div",ts,[(l(!0),r(q,null,A(e(o),x=>m((l(),R(G,{class:U(["-ui",e(v)]),src:x.path},null,8,["src","class"])),[[d,x.id===p.value]])),256))])}}},ns={class:"-ui",id:"Effect"},ve={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const a=W(),{playEase:s}=I(a),v=Q(),{effectList:g}=I(v);return(h,o)=>{const p=L("opacity");return l(),r("div",ns,[(l(!0),r(q,null,A(e(g),i=>m((l(),R(G,{class:U(["-ui",e(s)]),src:i.path,alt:i.name},null,8,["src","class","alt"])),[[p,i.id===t.data[t.name]]])),256))])}}},as=["data-name"],os={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=K(),{getSpriteNow:v}=s,{characterList:g}=I(s),h=W(),{playEase:o}=I(h);F();const{uiUrl:p}=oe(),i={name:"顯示角色",sprite:"角色差分",effect:"差分特效"},n=f(()=>a.isCG?"人物":i.name),d=f(()=>v(a.contents,a.data[n.value],n.value,i.sprite)),x=f(()=>({"mask-image":a.isCG?"":`url(${p("mask_4")})`})),w=f(()=>a.isCG?{}:{top:"0cqw",left:"-10cqw"}),y=f(()=>a.isCG?{}:{width:"100cqw"});return(M,S)=>{const C=L("visible"),H=L("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite",style:D(x.value)},[c("div",{class:"sprite_container",style:D(w.value)},[c("div",{class:"sprite_inner",style:D(y.value)},[(l(!0),r(q,null,A(e(g),_=>m((l(),r("div",{key:_.id,class:U(["-ui",e(o)]),"data-name":_.name},[(l(!0),r(q,null,A(_.sprite??[],k=>m((l(),R(G,{key:k.id,class:"sprite",src:k.path},null,8,["src"])),[[C,k.id===d.value]])),128))],10,as)),[[H,_.id===t.data[n.value]]])),128))],4)],4),u(ve,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},ls=T(os,[["__scopeId","data-v-71e5fbe8"]]),is=["data-name"],cs={__name:"Sprite2",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=K(),{getSpriteNow:v}=s,{characterList:g}=I(s),h=W(),{playEase:o}=I(h);F();const{uiUrl:p}=oe(),i={name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"},n=f(()=>a.isCG?"人物":i.name),d=f(()=>v(a.contents,a.data[n.value],n.value,i.sprite)),x=f(()=>({"mask-image":a.isCG?"":`url(${p("mask_3")})`})),w=f(()=>a.isCG?{}:{top:"13cqw",left:"37cqw"}),y=f(()=>a.isCG?{}:{width:"85cqw"});return(M,S)=>{const C=L("visible"),H=L("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite2",style:D(x.value)},[c("div",{class:"sprite_container",style:D(w.value)},[c("div",{class:"sprite_inner",style:D(y.value)},[(l(!0),r(q,null,A(e(g),_=>m((l(),r("div",{key:_.id,class:U(["-ui",e(o)]),"data-name":_.name},[(l(!0),r(q,null,A(_.sprite??[],k=>m((l(),R(G,{key:k.id,class:"sprite",src:k.path},null,8,["src"])),[[C,k.id===d.value]])),128))],10,is)),[[H,_.id===t.data[n.value]]])),128))],4)],4),u(ve,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},rs=T(cs,[["__scopeId","data-v-2efdc5c1"]]),us={class:"-ui bg-black",id:"CG"},ds={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const a=t,s=Q(),{getHistoryList:v}=s,{cgList:g}=I(s),h=f(()=>{var o;return(o=v(a.contents,"CG"))==null?void 0:o.show_name});return(o,p)=>{const i=L("opacity");return l(),r("div",us,[(l(!0),r(q,null,A(e(g),n=>m((l(),R(G,{class:"-ui !object-cover",src:n.path},null,8,["src"])),[[i,n.id===h.value]])),256))])}}},ps={class:"-ui",id:"UI"},vs={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=K(),{getCharacter:v}=s,g=W(),{playEase:h}=I(g);F();const{uiUrl:o}=oe();f(()=>v(a.data.人物));const p=f(()=>a.data.人物===a.data.立ち絵2),i=f(()=>!p.value&&!a.data.is_system&&!a.data.is_announce),n=f(()=>p.value&&!a.data.is_monolog);return(d,x)=>{const w=L("visible"),y=L("opacity");return l(),r("div",ps,[m((l(),r("div",{class:U(["-ui",e(h)])},[c("div",{class:"-ui -mask",style:D({"mask-image":"url("+e(o)("mask_2")+")"})},null,4),u(G,{class:"-ui",src:e(o)("01-1")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-2")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-3")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-4")},null,8,["src"]),m(u(G,{class:"-ui",src:e(o)("01-5")},null,8,["src"]),[[w,i.value]]),m(u(G,{class:"-ui",src:e(o)("01-6")},null,8,["src"]),[[w,n.value]])],2)),[[y,!t.isCG]]),m((l(),r("div",{class:U(["-ui",e(h)])},[u(G,{class:"-ui",src:e(o)("02-1")},null,8,["src"]),m(u(G,{class:"-ui",src:e(o)("02-2")},null,8,["src"]),[[w,i.value]]),m(u(G,{class:"-ui",src:e(o)("02-2")},null,8,["src"]),[[w,n.value]])],2)),[[y,t.isCG]]),m(c("div",{class:U(["-ui -replay",e(h)])},null,2),[[y,t.data.is_replay]])])}}},_s=T(vs,[["__scopeId","data-v-d4d4c7f8"]]),ms={class:"-ui",id:"NameTag"},hs={class:"-ui"},gs={class:"name_tag -font"},fs={class:"-ui"},ys={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=ne(),{fontFamily:v,fontWeight:g}=I(s),h=K(),{getCharacter:o}=h,{characterList:p}=I(h),{findData:i}=F(),n=f(()=>o(a.data.人物)),d=f(()=>i(p.value,0)),x=f(()=>a.data.人物===a.data.立ち絵2),w=f(()=>({width:"100cqw",height:"4cqw",bottom:"13.5cqw",left:x.value&&!a.isCG?"71cqw":"4cqw","font-size":"2.5cqw"}));return(y,M)=>{const S=L("opacity");return l(),r("div",ms,[m((l(),r("div",{class:U(["absolute",[e(v).nameTag,e(g).nameTag]]),style:D(w.value)},[m((l(),r("div",hs,[(l(!0),r(q,null,A(e(p),C=>m((l(),r("div",{key:C.id,class:"-ui"},[m((l(),r("p",gs,[ye(V(C.name),1)])),[[S,!C.image_name]]),m(u(G,{class:"name_tag",src:C.image_name},null,8,["src"]),[[S,C.image_name]])])),[[S,C.id===n.value.id]])),128))])),[[S,!t.data.is_unknown]]),m((l(),r("div",fs,[u(G,{class:"name_tag",src:d.value.image_name},null,8,["src"])])),[[S,t.data.is_unknown]])],6)),[[S,!t.data.is_monolog&&!t.data.is_system&&!t.data.is_announce]])])}}},ws=T(ys,[["__scopeId","data-v-b28d85c4"]]),bs=3e3,$s={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:black"],setup(t,{emit:a}){const s=t,v=a,g=f(()=>s.data.show_time==="暗場"),h=z({}),o=f(()=>(h.value.show_name??"").split(",")),p=f(()=>!o.value.includes("前")),i=f(()=>!o.value.includes("後"));f(()=>o.value.includes("續"));const n=z(!1),d=z(!1),x=()=>{if(g.value){if(h.value={...s.data},d.value=s.play&&p.value,n.value=!0,v("update:black",!0),!s.play)return;setTimeout(()=>{s.index>=s.length||v("update:index",s.index+1)},bs)}else d.value=s.play&&i.value,n.value=!1,v("update:black",!1)};return B(g,x),B(()=>s.play,x),(w,y)=>{const M=L("opacity");return m((l(),r("div",{class:U(["-ui z-20 bg-black",{"duration-1000":d.value}]),id:"Black"},null,2)),[[M,n.value]])}}},xs={class:"preview_title"},ks=["value"],Cs=["data-id"],Ss={class:"preview"},Bs={class:"-ui"},Is={__name:"index",setup(t){const a=ne(),{fullscreen:s}=I(a),v=ae(),{chapterIndex:g,chapterNames:h,chapterData:o}=I(v),p=W(),{logId:i,logIndex:n,logData:d,logShowing:x,logContents:w,logHistory:y,logCGMode:M,logPlay:S,logTyping:C,logBlack:H,playEase:_}=I(p),{getClientRect:k}=F(),P=()=>{S.value=!1,C.value=!1},Y=z(null),O=()=>{const E=[...Y.value].find(te=>te.dataset.id*1===i.value);if(!E)return;const{height:$,top:ee}=k(E);E.parentElement.scrollBy({top:ee-$,behavior:"smooth"})},le=z(null);B(s,E=>{window.api?window.api.fullscreen(E):E?le.value.requestFullscreen():document.exitFullscreen()});const ie=z(null),ce=E=>ie.value=E,Z=z(!1),X=we({id:0,type:""}),re=(E,{type:$})=>{X.id=E,X.type=$??"",Z.value=!0},_e=E=>o.value.push(E),me=E=>{i.value=E,setTimeout(O,100)};return(E,$)=>{const ee=L("opacity"),te=L("visible");return l(),R(xe,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:se(()=>[u(Ce,{positions:ie.value,onClear:ce,onUse:$[0]||($[0]=b=>re("add",b)),onlyAdd:!0},null,8,["positions"]),c("section",xs,[m(c("select",{class:"preview_title_select","onUpdate:modelValue":$[1]||($[1]=b=>j(g)?g.value=b:null)},[(l(!0),r(q,null,A(e(h),(b,J)=>(l(),r("option",{value:J},V(b),9,ks))),256))],512),[[be,e(g)]]),m(c("button",{class:"preview_button",onClick:O,title:"今の画面のセリフへ"},[u(Ne)],512),[[N,!e(s)]]),c("button",{class:"preview_button",onClick:ce,title:"新規"},[u(e($e))])])]),side:se(()=>[(l(!0),r(q,null,A(e(o),b=>(l(),r("div",{key:b.id,"data-id":b.id,ref_for:!0,ref_key:"logElem",ref:Y},[u(xt,{id:e(i),"onUpdate:id":$[2]||($[2]=J=>j(i)?i.value=J:null),log:b,onEdit:J=>re(b.id,{}),onDelete:J=>b.is_delete=!0,onStop:P},null,8,["id","log","onEdit","onDelete"])],8,Cs))),128))]),default:se(()=>[c("section",{class:"preview_container",ref_key:"preview",ref:le},[c("div",Ss,[m((l(),r("div",Bs,[u(ss,{contents:e(y)},null,8,["contents"]),u(ls,{data:e(d),contents:e(y),isCG:e(M)},null,8,["data","contents","isCG"]),u(rs,{data:e(d),contents:e(y),isCG:e(M)},null,8,["data","contents","isCG"]),m(u(ds,{contents:e(y),class:U(e(_))},null,8,["contents","class"]),[[ee,e(M)]]),u(_s,{data:e(d),contents:e(y),isCG:e(M)},null,8,["data","contents","isCG"])])),[[te,e(o).length]]),u(ws,{data:e(d),isCG:e(M)},null,8,["data","isCG"]),u(es,{data:e(d),play:e(S),typing:e(C),"onUpdate:typing":$[3]||($[3]=b=>j(C)?C.value=b:null),black:e(H)},null,8,["data","play","typing","black"]),u($s,{index:e(n),"onUpdate:index":$[4]||($[4]=b=>j(n)?n.value=b:null),data:e(d),play:e(S),black:e(H),"onUpdate:black":$[5]||($[5]=b=>j(H)?H.value=b:null),length:e(w).length-1},null,8,["index","data","play","black","length"])]),u(Yt,{index:e(n),"onUpdate:index":$[6]||($[6]=b=>j(n)?n.value=b:null),play:e(S),"onUpdate:play":$[7]||($[7]=b=>j(S)?S.value=b:null),typing:e(C),black:e(H),length:e(w).length-1,onTarget:O,onStop:P},null,8,["index","play","typing","black","length"])],512),u(Se,{open:Z.value,"onUpdate:open":$[8]||($[8]=b=>Z.value=b),id:X.id,type:X.type,onAdd:_e,onTarget:me},null,8,["open","id","type"])]),_:1})}}},Ts=T(Is,[["__scopeId","data-v-b367e12a"]]);export{Ts as default};
