import{_ as T,o as l,c as r,a as c,u as J,b as K,w as _,v as L,F as H,t as V,d as e,e as u,n as A,f as se,s as B,r as z,g as S,h as ne,i as g,j as D,k as me,l as he,m as O,p as ge,q,x as U,y as j,z as ae,A as fe,B as ye,C as te,D as we,E as P}from"./index-Dzi4fBRY.js";import{I as re,a as $e}from"./IconDelete-DNOZhYxF.js";import{W as be}from"./Wrap-Ietj3CKK.js";import{D as ke,M as xe,E as Ce}from"./Dialog-DvVEqs1A.js";import{R as Se}from"./Range-CwMF1ae3.js";import{_ as G}from"./Image-BT2H5pvq.js";/* empty css                                                             */const Be={name:"MdiTarget"},Ie={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Ge=c("path",{fill:"currentColor",d:"M11 2v2.07A8 8 0 0 0 4.07 11H2v2h2.07A8 8 0 0 0 11 19.93V22h2v-2.07A8 8 0 0 0 19.93 13H22v-2h-2.07A8 8 0 0 0 13 4.07V2m-2 4.08V8h2V6.09c2.5.41 4.5 2.41 4.92 4.91H16v2h1.91c-.41 2.5-2.41 4.5-4.91 4.92V16h-2v1.91C8.5 17.5 6.5 15.5 6.08 13H8v-2H6.09C6.5 8.5 8.5 6.5 11 6.08M12 11a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1"},null,-1),ze=[Ge];function Me(t,a,s,v,h,m){return l(),r("svg",Ie,ze)}const Ee=T(Be,[["render",Me]]),Ne={name:"RiShiningFill"},Le={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},qe=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),Te=[qe];function He(t,a,s,v,h,m){return l(),r("svg",Le,Te)}const Ve=T(Ne,[["render",He]]),Ae={name:"RiShiningLine"},Ue={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},De=c("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),Pe=[De];function Oe(t,a,s,v,h,m){return l(),r("svg",Ue,Pe)}const je=T(Ae,[["render",Oe]]),Fe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=c("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),We=[Re];function Je(t,a){return l(),r("svg",Fe,[...We])}const Ke={name:"ic-round-queue-music",render:Je},Qe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Xe=c("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),Ye=[Xe];function Ze(t,a){return l(),r("svg",Qe,[...Ye])}const et={name:"ic-sharp-keyboard-voice",render:Ze},tt={name:"MaterialSymbolsEditSquareOutline"},st={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},nt=c("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h8.925l-2 2H5v14h14v-6.95l2-2V19q0 .825-.587 1.413T19 21zm4-6v-4.25l9.175-9.175q.3-.3.675-.45t.75-.15q.4 0 .763.15t.662.45L22.425 3q.275.3.425.663T23 4.4t-.137.738t-.438.662L13.25 15zM21.025 4.4l-1.4-1.4zM11 13h1.4l5.8-5.8l-.7-.7l-.725-.7L11 11.575zm6.5-6.5l-.725-.7zl.7.7z"},null,-1),at=[nt];function ot(t,a,s,v,h,m){return l(),r("svg",st,at)}const ue=T(tt,[["render",ot]]),lt={class:"preview_log_head"},it={class:"preview_log_title"},ct={class:"preview_log_subtitle text-sm"},rt={class:"preview_log_content"},ut={class:"preview_log_foot"},dt={class:"preview_log_head group-hover:opacity-75"},pt={class:"shrink-0 font-medium"},vt={class:"preview_log_subtitle text-xs leading-none"},_t={class:"h-1em"},mt={class:"h-1em"},ht={class:"preview_log_content group-hover:opacity-75"},gt={class:"preview_log_foot"},ft={class:"preview_log_mark_1"},yt={class:"preview_log_mark_1"},wt={class:"preview_log_mark_1"},$t={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:a}){const s=a,v=J(),{getCharacter:h,getSprite:m}=v,o=K(),{getShowName:p}=o;return(i,n)=>_((l(),r("article",{class:A(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(l(),r(H,{key:0},[c("header",lt,[c("h6",it,V(t.log.人物),1),c("p",ct,V(t.log.show_time),1)]),c("p",rt,V(e(p)(t.log.show_time,t.log.show_name)),1),c("footer",ut,[c("button",{class:"preview_button ml-auto",onClick:n[0]||(n[0]=d=>s("edit")),title:"編集"},[u(ue)]),c("button",{class:"preview_button ml-1",onClick:n[1]||(n[1]=d=>s("delete")),title:"削除"},[u(re)])])],64)):(l(),r(H,{key:1},[c("button",{class:"group contents",onClick:n[2]||(n[2]=d=>{s("update:id",t.log.id),s("stop")})},[c("header",dt,[c("h6",pt,V(e(h)(t.log.人物).name),1),c("p",vt,[c("span",_t,V(e(h)(t.log.顯示角色).name)+" / "+V(e(m)(t.log.顯示角色,t.log.十六夜差分).name),1),c("span",mt,V(e(h)(t.log.立ち絵2).name)+" / "+V(e(m)(t.log.立ち絵2,t.log.角色差分).name),1)])]),c("p",ht,V(t.log.和訳),1)]),c("footer",gt,[_(c("span",ft,"R",512),[[L,t.log.is_replay]]),_(c("span",yt,"U",512),[[L,t.log.is_unknown]]),_(c("span",wt,"S",512),[[L,t.log.is_monolog]]),_(u(Ve,{class:"preview_log_mark_2"},null,512),[[L,t.log.差分特效]]),_(u(je,{class:"preview_log_mark_2"},null,512),[[L,t.log.主角特效]]),_(u(e(Ke),{class:"preview_log_mark_2"},null,512),[[L,t.log.SE]]),_(u(e(et),{class:"preview_log_mark_2"},null,512),[[L,t.log.Voice]]),c("button",{class:"preview_button ml-auto",onClick:n[3]||(n[3]=d=>s("edit")),title:"編集"},[u(ue)]),c("button",{class:"preview_button ml-1",onClick:n[4]||(n[4]=d=>s("delete")),title:"削除"},[u(re)])])],64))],2)),[[L,!t.log.is_delete]])}},bt=T($t,[["__scopeId","data-v-7c6f1a9e"]]),kt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},xt=c("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),Ct=[xt];function St(t,a){return l(),r("svg",kt,[...Ct])}const Bt={name:"ic-baseline-stop",render:St},It={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Gt=c("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),zt=[Gt];function Mt(t,a){return l(),r("svg",It,[...zt])}const Et={name:"ic-baseline-play-arrow",render:Mt},Nt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Lt=c("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),qt=[Lt];function Tt(t,a){return l(),r("svg",Nt,[...qt])}const de={name:"ic-baseline-skip-previous",render:Tt},Ht={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Vt=c("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),At=[Vt];function Ut(t,a){return l(),r("svg",Ht,[...At])}const Dt={name:"ic-baseline-fullscreen",render:Ut},Pt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ot=c("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),jt=[Ot];function Ft(t,a){return l(),r("svg",Pt,[...jt])}const Rt={name:"ic-baseline-fullscreen-exit",render:Ft},Wt={class:"preview_control"},Jt=["disabled"],Kt=["disabled"],Qt={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:a}){const s=t,v=a,h=se(),{fullscreen:m}=B(h),o=z(0);S(o,i=>v("update:index",i)),S(()=>s.index,i=>o.value=i,{immediate:!0});const p=()=>{const i=o.value;!s.play||s.black||setTimeout(()=>{const n=o.value>=s.length;s.index===i&&s.play&&!s.black&&!s.typing&&!n&&(o.value+=1),n&&v("update:play",!1),p()},3e3)};return S(()=>s.play,p),S(()=>s.typing,p),(i,n)=>(l(),r("div",Wt,[c("button",{class:"preview_button",onClick:n[0]||(n[0]=d=>{o.value-=1,v("stop")}),disabled:o.value===0,title:"前へ"},[u(e(de))],8,Jt),c("button",{class:"preview_button",onClick:n[1]||(n[1]=d=>v("update:play",!t.play)),title:"プレイ"},[_(u(e(Et),null,null,512),[[L,!t.play]]),_(u(e(Bt),null,null,512),[[L,t.play]])]),c("button",{class:"preview_button",onClick:n[2]||(n[2]=d=>{o.value+=1,v("stop")}),disabled:o.value===t.length,title:"次へ"},[u(e(de),{class:"-scale-x-100"})],8,Kt),u(Se,{class:"mx-3 grow !bg-dark-text",value:o.value,"onUpdate:value":n[3]||(n[3]=d=>o.value=d),onChange:n[4]||(n[4]=d=>v("stop")),min:0,max:t.length,step:1},null,8,["value","max"]),c("button",{class:"preview_button",onClick:n[5]||(n[5]=d=>m.value=!e(m)),title:"全画面モード"},[_(u(e(Dt),null,null,512),[[L,!e(m)]]),_(u(e(Rt),null,null,512),[[L,e(m)]])])]))}},Xt=T(Qt,[["__scopeId","data-v-ffde7900"]]),Yt={__name:"Comment",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:a}){const s=t,v=a,h=ne(),{dialogType:m}=h,o=z({}),p=z(0),i=g(()=>o.value.和訳??""),n=g(()=>s.play?i.value.slice(0,p.value):i.value),d=g(()=>({"margin-left":"15cqw","margin-right":"15cqw","margin-bottom":"3.2cqw"})),x=()=>{i.value&&(v("update:typing",!0),p.value=0)},w=()=>{if(!s.play||s.black)return;if(p.value===i.value.length)return v("update:typing",!1);setTimeout(()=>{s.typing?p.value+=1:p.value=i.value.length},25)};return S(()=>s.data,y=>{y.is_showtime||(o.value=y)}),S(o,x),S(i,w),S(n,w),S(p,w),S(()=>s.black,y=>{y||w()}),(y,E)=>(l(),r("article",{class:"preview_dialog",style:D(d.value)},[u(ke,{value:n.value,type:e(m)(t.data)},null,8,["value","type"])],4))}},Zt=T(Yt,[["__scopeId","data-v-95429636"]]),F=me("log",()=>{const t=he(),a=ne(),{chapterData:s}=B(a),v=K(),{getHistoryList:h}=v,{findData:m,findIndex:o}=O(),p=z(0),i=z(0),n=z({}),d=g(()=>s.value.filter(f=>{const $=!f.is_delete&&!f.is_showtime,M=f.is_perform&&f.show_time==="暗場";return $||M})),x=g(()=>{const f=o(s.value,p.value)+1,$=s.value.slice(0,f),M=s.value.slice(f);return M.every(R=>R.is_showtime)&&$.push(...M),$});S(p,f=>{const $=m(s.value,f)??{};$.is_scene||(n.value=$,i.value=o(d.value,$.id))}),S(i,f=>{var $;return p.value=(($=d.value[f])==null?void 0:$.id)??0}),S(s,()=>{var f;return p.value=((f=d.value[0])==null?void 0:f.id)??0}),ge(()=>{var f;return p.value=((f=d.value[0])==null?void 0:f.id)??0});const w=g(()=>{const f=h(x.value,"CG");return((f==null?void 0:f.show_name)??"")!==""&&(f==null?void 0:f.show_name)!=="結束"}),y=z(!1),E=z(!1),I=z(!1),C=g(()=>({"":y.value}));return S(()=>t.name,()=>y.value=!1),{logId:p,logIndex:i,logData:n,logContents:d,logHistory:x,logCGMode:w,logPlay:y,logTyping:E,logBlack:I,playEase:C}}),es={class:"-ui bg-black",id:"Background"},ts={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const a=t,s=F(),{playEase:v}=B(s),h=K(),{getHistoryList:m}=h,{backgroundList:o}=B(h),p=g(()=>{var i;return(i=m(a.contents,"BG"))==null?void 0:i.show_name});return(i,n)=>{const d=q("opacity");return l(),r("div",es,[(l(!0),r(H,null,U(e(o),x=>_((l(),j(G,{class:A(["-ui",e(v)]),src:x.path},null,8,["src","class"])),[[d,x.id===p.value]])),256))])}}},ss={class:"-ui",id:"Effect"},pe={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const a=F(),{playEase:s}=B(a),v=K(),{effectList:h}=B(v);return(m,o)=>{const p=q("opacity");return l(),r("div",ss,[(l(!0),r(H,null,U(e(h),i=>_((l(),j(G,{class:A(["-ui",e(s)]),src:i.path,alt:i.name},null,8,["src","class","alt"])),[[p,i.id===t.data[t.name]]])),256))])}}},ns=["data-name"],as={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=J(),{getSpriteNow:v}=s,{characterList:h}=B(s),m=F(),{playEase:o}=B(m);O();const{uiUrl:p}=ae(),i={name:"顯示角色",sprite:"角色差分",effect:"差分特效"},n=g(()=>a.isCG?"人物":i.name),d=g(()=>v(a.contents,a.data[n.value],n.value,i.sprite)),x=g(()=>({"mask-image":a.isCG?"":`url(${p("mask_4")})`})),w=g(()=>a.isCG?{}:{top:"0cqw",left:"-10cqw"}),y=g(()=>a.isCG?{}:{width:"100cqw"});return(E,I)=>{const C=q("visible"),f=q("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite",style:D(x.value)},[c("div",{class:"sprite_container",style:D(w.value)},[c("div",{class:"sprite_inner",style:D(y.value)},[(l(!0),r(H,null,U(e(h),$=>_((l(),r("div",{key:$.id,class:A(["-ui",e(o)]),"data-name":$.name},[(l(!0),r(H,null,U($.sprite??[],M=>_((l(),j(G,{key:M.id,class:"sprite",src:M.path},null,8,["src"])),[[C,M.id===d.value]])),128))],10,ns)),[[f,$.id===t.data[n.value]]])),128))],4)],4),u(pe,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},os=T(as,[["__scopeId","data-v-71e5fbe8"]]),ls=["data-name"],is={__name:"Sprite2",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=J(),{getSpriteNow:v}=s,{characterList:h}=B(s),m=F(),{playEase:o}=B(m);O();const{uiUrl:p}=ae(),i={name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"},n=g(()=>a.isCG?"人物":i.name),d=g(()=>v(a.contents,a.data[n.value],n.value,i.sprite)),x=g(()=>({"mask-image":a.isCG?"":`url(${p("mask_3")})`})),w=g(()=>a.isCG?{}:{top:"13cqw",left:"37cqw"}),y=g(()=>a.isCG?{}:{width:"85cqw"});return(E,I)=>{const C=q("visible"),f=q("opacity");return l(),r("div",{class:"-ui -mask",id:"Sprite2",style:D(x.value)},[c("div",{class:"sprite_container",style:D(w.value)},[c("div",{class:"sprite_inner",style:D(y.value)},[(l(!0),r(H,null,U(e(h),$=>_((l(),r("div",{key:$.id,class:A(["-ui",e(o)]),"data-name":$.name},[(l(!0),r(H,null,U($.sprite??[],M=>_((l(),j(G,{key:M.id,class:"sprite",src:M.path},null,8,["src"])),[[C,M.id===d.value]])),128))],10,ls)),[[f,$.id===t.data[n.value]]])),128))],4)],4),u(pe,{name:i.effect,data:t.data},null,8,["name","data"])],4)}}},cs=T(is,[["__scopeId","data-v-2efdc5c1"]]),rs={class:"-ui bg-black",id:"CG"},us={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const a=t,s=K(),{getHistoryList:v}=s,{cgList:h}=B(s),m=g(()=>{var o;return(o=v(a.contents,"CG"))==null?void 0:o.show_name});return(o,p)=>{const i=q("opacity");return l(),r("div",rs,[(l(!0),r(H,null,U(e(h),n=>_((l(),j(G,{class:"-ui cg",src:n.path},null,8,["src"])),[[i,n.id===m.value]])),256))])}}},ds=T(us,[["__scopeId","data-v-e31e2184"]]),ps={class:"-ui",id:"UI"},vs={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},all:{type:[Array],default:()=>[]},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=J(),{getCharacter:v}=s,h=F(),{playEase:m}=B(h);O();const{uiUrl:o}=ae();g(()=>v(a.data.人物));const p=g(()=>a.data.人物===a.data.立ち絵2),i=g(()=>!p.value&&!a.data.is_system&&!a.data.is_announce),n=g(()=>p.value&&!a.data.is_monolog);return(d,x)=>{const w=q("visible"),y=q("opacity");return l(),r("div",ps,[_((l(),r("div",{class:A(["-ui",e(m)])},[c("div",{class:"-ui -mask",style:D({"mask-image":"url("+e(o)("mask_2")+")"})},null,4),u(G,{class:"-ui",src:e(o)("01-1")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-2")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-3")},null,8,["src"]),u(G,{class:"-ui",src:e(o)("01-4")},null,8,["src"]),_(u(G,{class:"-ui",src:e(o)("01-5")},null,8,["src"]),[[w,i.value]]),_(u(G,{class:"-ui",src:e(o)("01-6")},null,8,["src"]),[[w,n.value]])],2)),[[y,!t.isCG]]),_((l(),r("div",{class:A(["-ui",e(m)])},[u(G,{class:"-ui",src:e(o)("02-1")},null,8,["src"]),_(u(G,{class:"-ui",src:e(o)("02-2")},null,8,["src"]),[[w,i.value]]),_(u(G,{class:"-ui",src:e(o)("02-2")},null,8,["src"]),[[w,n.value]])],2)),[[y,t.isCG]]),_(c("div",{class:A(["-ui -replay",e(m)])},null,2),[[y,t.data.is_replay]])])}}},_s=T(vs,[["__scopeId","data-v-2d473479"]]),ms={class:"-ui",id:"NameTag"},hs={class:"-ui"},gs={class:"name_tag -font"},fs={class:"-ui"},ys={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},isCG:{type:[Boolean],default:!1}},setup(t){const a=t,s=se(),{fontFamily:v,fontWeight:h}=B(s),m=J(),{getCharacter:o}=m,{characterList:p}=B(m),{findData:i}=O(),n=g(()=>o(a.data.人物)),d=g(()=>i(p.value,0)),x=g(()=>a.data.人物===a.data.立ち絵2),w=g(()=>({width:"100cqw",height:"4cqw",bottom:"13.5cqw",left:x.value&&!a.isCG?"71cqw":"4cqw","font-size":"2.5cqw"}));return(y,E)=>{const I=q("opacity");return l(),r("div",ms,[_((l(),r("div",{class:A(["absolute",[e(v).nameTag,e(h).nameTag]]),style:D(w.value)},[_((l(),r("div",hs,[(l(!0),r(H,null,U(e(p),C=>_((l(),r("div",{key:C.id,class:"-ui"},[_((l(),r("p",gs,[fe(V(C.name),1)])),[[I,!C.image_name]]),_(u(G,{class:"name_tag",src:C.image_name},null,8,["src"]),[[I,C.image_name]])])),[[I,C.id===n.value.id]])),128))])),[[I,!t.data.is_unknown]]),_((l(),r("div",fs,[u(G,{class:"name_tag",src:d.value.image_name},null,8,["src"])])),[[I,t.data.is_unknown]])],6)),[[I,!t.data.is_monolog&&!t.data.is_system&&!t.data.is_announce]])])}}},ws=T(ys,[["__scopeId","data-v-b28d85c4"]]),$s=3e3,bs={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:black"],setup(t,{emit:a}){const s=t,v=a,h=g(()=>s.data.show_time==="暗場"),m=z({}),o=g(()=>(m.value.show_name??"").split(",")),p=g(()=>!o.value.includes("前")),i=g(()=>!o.value.includes("後"));g(()=>o.value.includes("續"));const n=z(!1),d=z(!1),x=()=>{if(h.value){if(m.value={...s.data},d.value=s.play&&p.value,n.value=!0,v("update:black",!0),!s.play)return;setTimeout(()=>{s.index>=s.length||v("update:index",s.index+1)},$s)}else d.value=s.play&&i.value,n.value=!1,v("update:black",!1)};return S(h,x),S(()=>s.play,x),(w,y)=>{const E=q("opacity");return _((l(),r("div",{class:A(["-ui z-20 bg-black",{"duration-1000":d.value}]),id:"Black"},null,2)),[[E,n.value]])}}},ks={class:"preview_title"},xs=["value"],Cs=["data-id"],Ss={class:"preview"},Bs={class:"-ui"},Is={__name:"index",setup(t){const a=se(),{fullscreen:s}=B(a),v=ne(),{chapterIndex:h,chapterNames:m,chapterData:o}=B(v),p=F(),{logId:i,logIndex:n,logData:d,logContents:x,logHistory:w,logCGMode:y,logPlay:E,logTyping:I,logBlack:C,playEase:f}=B(p),{getClientRect:$}=O(),M=()=>{E.value=!1,I.value=!1},X=z(null),R=()=>{const N=[...X.value].find(ee=>ee.dataset.id*1===i.value);if(!N)return;const{height:k,top:Z}=$(N);N.parentElement.scrollBy({top:Z-k,behavior:"smooth"})},oe=z(null);S(s,N=>{N?oe.value.requestFullscreen():document.exitFullscreen()});const le=z(null),ie=N=>le.value=N,Y=z(!1),Q=ye({id:0,type:""}),ce=(N,{type:k})=>{Q.id=N,Q.type=k??"",Y.value=!0},ve=N=>o.value.push(N),_e=N=>{i.value=N,setTimeout(R,100)};return(N,k)=>{const Z=q("opacity"),ee=q("visible");return l(),j(be,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:te(()=>[u(xe,{positions:le.value,onClear:ie,onUse:k[0]||(k[0]=b=>ce("add",b)),onlyAdd:!0},null,8,["positions"]),c("section",ks,[_(c("select",{class:"preview_title_select","onUpdate:modelValue":k[1]||(k[1]=b=>P(h)?h.value=b:null)},[(l(!0),r(H,null,U(e(m),(b,W)=>(l(),r("option",{value:W},V(b),9,xs))),256))],512),[[we,e(h)]]),_(c("button",{class:"preview_button",onClick:R,title:"今の画面のセリフへ"},[u(Ee)],512),[[L,!e(s)]]),c("button",{class:"preview_button",onClick:ie,title:"新規"},[u(e($e))])])]),side:te(()=>[(l(!0),r(H,null,U(e(o),b=>(l(),r("div",{key:b.id,"data-id":b.id,ref_for:!0,ref_key:"logElem",ref:X},[u(bt,{id:e(i),"onUpdate:id":k[2]||(k[2]=W=>P(i)?i.value=W:null),log:b,onEdit:W=>ce(b.id,{}),onDelete:W=>b.is_delete=!0,onStop:M},null,8,["id","log","onEdit","onDelete"])],8,Cs))),128))]),default:te(()=>[c("section",{class:"preview_container",ref_key:"preview",ref:oe},[c("div",Ss,[_((l(),r("div",Bs,[u(ts,{contents:e(w)},null,8,["contents"]),u(os,{data:e(d),contents:e(w),isCG:e(y)},null,8,["data","contents","isCG"]),u(cs,{data:e(d),contents:e(w),isCG:e(y)},null,8,["data","contents","isCG"]),_(u(ds,{contents:e(w),class:A(e(f))},null,8,["contents","class"]),[[Z,e(y)]]),u(_s,{data:e(d),contents:e(w),all:e(o),isCG:e(y)},null,8,["data","contents","all","isCG"])])),[[ee,e(o).length]]),u(ws,{data:e(d),isCG:e(y)},null,8,["data","isCG"]),u(Zt,{data:e(d),play:e(E),typing:e(I),"onUpdate:typing":k[3]||(k[3]=b=>P(I)?I.value=b:null),black:e(C)},null,8,["data","play","typing","black"]),u(bs,{index:e(n),"onUpdate:index":k[4]||(k[4]=b=>P(n)?n.value=b:null),data:e(d),play:e(E),black:e(C),"onUpdate:black":k[5]||(k[5]=b=>P(C)?C.value=b:null),length:e(x).length-1},null,8,["index","data","play","black","length"])]),u(Xt,{index:e(n),"onUpdate:index":k[6]||(k[6]=b=>P(n)?n.value=b:null),play:e(E),"onUpdate:play":k[7]||(k[7]=b=>P(E)?E.value=b:null),typing:e(I),black:e(C),length:e(x).length-1,onTarget:R,onStop:M},null,8,["index","play","typing","black","length"])],512),u(Ce,{open:Y.value,"onUpdate:open":k[8]||(k[8]=b=>Y.value=b),id:Q.id,type:Q.type,onAdd:ve,onTarget:_e},null,8,["open","id","type"])]),_:1})}}},Ts=T(Is,[["__scopeId","data-v-056e2e61"]]);export{Ts as default};
