import{_ as F,o as s,c as u,a as m,u as ce,b as q,F as E,t as V,d as e,e as _,w as $,v as D,n as H,f as W,s as B,r as M,g as S,h as x,i as xe,j as ue,k as Se,l as U,m as O,p as G,q as Ue,x as se,y as K,z as ye,A as ze,B as Ve,C as A,D as ne,E as ie,G as Pe,H as Ae}from"./index-BexsKry7.js";import{I as he,a as He,D as je}from"./IconDelete-Dof_8FLv.js";import{u as Y,M as Oe,I as Ge,E as Re}from"./EditPopup-DU7UDKoF.js";import{D as Fe,S as qe}from"./Dialog-CSBHe7q0.js";import{W as We}from"./Wrap-xFnL6CjA.js";import{A as Ke}from"./Aspect-BdGFMq-_.js";import{I as be,S as Je,U as Qe}from"./UiItem-AhAIPKN6.js";import{R as Xe}from"./Range-eGXVoK1D.js";import{_ as re}from"./Audio-ob4D50xe.js";import{_ as X}from"./Image-BU5xmaAy.js";import{u as Ye}from"./useMouse-C_q4Rx5p.js";/* empty css                                                             */const Ze={name:"RiShiningFill"},et={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},tt=m("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),at=[tt];function nt(t,i,a,r,f,g){return s(),u("svg",et,at)}const st=F(Ze,[["render",nt]]),ot={name:"RiShiningLine"},lt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},it=m("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),ct=[it];function ut(t,i,a,r,f,g){return s(),u("svg",lt,ct)}const rt=F(ot,[["render",ut]]),dt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pt=m("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),vt=[pt];function mt(t,i){return s(),u("svg",dt,[...vt])}const gt={name:"ic-round-queue-music",render:mt},_t={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ft=m("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),yt=[ft];function ht(t,i){return s(),u("svg",_t,[...yt])}const bt={name:"ic-sharp-keyboard-voice",render:ht},wt={class:"contents"},$t={class:"preview_log_head"},xt={class:"preview_log_title"},St={class:"preview_log_subtitle !text-base"},kt={class:"preview_log_content"},Bt={class:"preview_log_foot"},Ct={class:"preview_log_head"},It={class:"shrink-0 font-medium"},Nt={class:"preview_log_subtitle text-xs leading-none"},Lt={class:"h-1em"},Tt={class:"h-1em"},Et={class:"preview_log_content"},Dt={class:"preview_log_foot"},Mt={class:"preview_log_mark_1"},Ut={class:"preview_log_mark_1"},zt={class:"preview_log_mark_1"},Vt={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:i}){const a=i,r=ce(),{getCharacter:f,getSprite:g}=r,w=q(),{getShowName:d}=w;return(y,o)=>(s(),u("article",{class:H(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(s(),u(E,{key:0},[m("div",wt,[m("header",$t,[m("h6",xt,V(t.log.人物),1),m("p",St,V(t.log.show_time),1)]),m("p",kt,V(e(d)(t.log.show_time,t.log.show_name)),1)]),m("footer",Bt,[m("button",{class:"preview_button ml-auto",onClick:o[0]||(o[0]=c=>a("edit")),title:"編集"},[_(be,{class:"text-[0.9em]"})]),m("button",{class:"preview_button ml-1",onClick:o[1]||(o[1]=c=>a("delete")),title:"削除"},[_(he,{class:"text-[0.9em]"})])])],64)):(s(),u(E,{key:1},[m("button",{class:"group contents",onClick:o[2]||(o[2]=c=>{a("update:id",t.log.id),a("stop")})},[m("header",Ct,[m("h6",It,V(e(f)(t.log.人物).name),1),m("p",Nt,[m("span",Lt,V(e(f)(t.log.顯示角色).name)+" / "+V(e(g)(t.log.顯示角色,t.log.角色差分).name),1),m("span",Tt,V(e(f)(t.log.立ち絵2).name)+" / "+V(e(g)(t.log.立ち絵2,t.log.十六夜差分).name),1)])]),m("p",Et,V(t.log.和訳),1)]),m("footer",Dt,[$(m("span",Mt,"R",512),[[D,t.log.is_replay]]),$(m("span",Ut,"U",512),[[D,t.log.is_unknown]]),$(m("span",zt,"S",512),[[D,t.log.is_monolog]]),$(_(st,{class:"preview_log_mark_2"},null,512),[[D,t.log.差分特效!==""]]),$(_(rt,{class:"preview_log_mark_2"},null,512),[[D,t.log.主角特效!==""]]),$(_(e(gt),{class:"preview_log_mark_2"},null,512),[[D,t.log.SE!==""]]),$(_(e(bt),{class:"preview_log_mark_2"},null,512),[[D,t.log.ボイス!==""]]),m("button",{class:"preview_button ml-auto",onClick:o[3]||(o[3]=c=>a("edit")),title:"編集"},[_(be,{class:"text-[0.9em]"})]),m("button",{class:"preview_button ml-1",onClick:o[4]||(o[4]=c=>a("delete")),title:"削除"},[_(he,{class:"text-[0.9em]"})])])],64))],2))}},Pt=F(Vt,[["__scopeId","data-v-49f9b5b6"]]),At={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ht=m("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),jt=[Ht];function Ot(t,i){return s(),u("svg",At,[...jt])}const Gt={name:"ic-baseline-stop",render:Ot},Rt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ft=m("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),qt=[Ft];function Wt(t,i){return s(),u("svg",Rt,[...qt])}const Kt={name:"ic-baseline-play-arrow",render:Wt},Jt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Qt=m("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),Xt=[Qt];function Yt(t,i){return s(),u("svg",Jt,[...Xt])}const we={name:"ic-baseline-skip-previous",render:Yt},Zt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ea=m("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),ta=[ea];function aa(t,i){return s(),u("svg",Zt,[...ta])}const na={name:"ic-baseline-fullscreen",render:aa},sa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},oa=m("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),la=[oa];function ia(t,i){return s(),u("svg",sa,[...la])}const ca={name:"ic-baseline-fullscreen-exit",render:ia},ua={class:"control_outer group"},ra={class:"control"},da=["disabled"],pa=["disabled"],va={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1},voicing:{type:[Boolean],default:!1},animating:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:i}){const a=t,r=i,f=W(),{fullscreen:g,fontIntervals:w}=B(f),d=M(0);S(d,c=>r("update:index",c)),S(()=>a.index,c=>d.value=c,{immediate:!0});const y=x(()=>a.play&&!a.black&&!a.voicing&&!a.typing&&!a.animating),o=()=>{const c=d.value;y&&setTimeout(()=>{const n=d.value>=a.length&&!a.black;a.index===c&&y.value&&!n&&(d.value+=1),n&&r("update:play",!1),o()},w.value.sentence)};return S(()=>a.play,o),S(()=>a.typing,o),S(()=>a.voicing,o),S(()=>a.animating,o),(c,n)=>(s(),u("div",ua,[m("div",ra,[m("button",{class:"preview_button",onClick:n[0]||(n[0]=p=>{d.value-=1,r("stop")}),disabled:d.value===0,title:"前へ"},[_(e(we))],8,da),m("button",{class:"preview_button",onClick:n[1]||(n[1]=p=>r("update:play",!t.play)),title:"プレイ"},[$(_(e(Kt),null,null,512),[[D,!t.play]]),$(_(e(Gt),null,null,512),[[D,t.play]])]),m("button",{class:"preview_button",onClick:n[2]||(n[2]=p=>{d.value+=1,r("stop")}),disabled:d.value===t.length,title:"次へ"},[_(e(we),{class:"-scale-x-100"})],8,pa),_(Xe,{class:"mx-3 grow !bg-dark-text",value:d.value,"onUpdate:value":n[3]||(n[3]=p=>d.value=p),onChange:n[4]||(n[4]=p=>r("stop")),min:0,max:t.length,step:1,button:!1},null,8,["value","max"]),m("button",{class:"preview_button",onClick:n[5]||(n[5]=p=>g.value=!e(g)),title:"全画面モード"},[$(_(e(na),null,null,512),[[D,!e(g)]]),$(_(e(ca),null,null,512),[[D,e(g)]])])])]))}},ma=F(va,[["__scopeId","data-v-ee680909"]]),ga={__name:"Comment",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:i}){const a=t,r=i,f=W(),{fontIntervals:g}=B(f),w=xe(),{dialogType:d}=w,{getDialogStyle:y}=ue(),o=M({}),c=M(0),n=x(()=>o.value.和訳??""),p=x(()=>a.play?n.value.slice(0,c.value):n.value),h=x(()=>y(a.ui)),k=()=>{n.value&&(r("update:typing",!0),c.value=0)},b=()=>{if(!a.play||a.black)return;if(c.value===n.value.length)return r("update:typing",!1);setTimeout(()=>{a.typing?c.value+=1:c.value=n.value.length},g.value.word)};return S(()=>a.data,C=>{C.is_showtime||(o.value=C)}),S(o,k),S(n,b),S(p,b),S(c,b),S(()=>a.black,C=>{C||b()}),(C,T)=>(s(),u("article",{class:"preview_dialog",style:Se(h.value)},[_(Fe,{value:p.value,type:e(d)(t.data)},null,8,["value","type"])],4))}},_a=F(ga,[["__scopeId","data-v-7dd70b74"]]),fa={class:"invisible",id:"Bgm"},ya={__name:"BGM",props:{contents:{type:[Array],default:()=>[]},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1}},setup(t){const i=t,a=W(),{audioVolume:r}=B(a),f=q(),{getHistoryList:g}=f,{bgmList:w}=B(f),d=x(()=>{var n;return(n=g(i.contents,"BGM"))==null?void 0:n.show_name}),y=x(()=>i.play&&!i.pause),o=M({}),c=(n,p)=>{n&&(p&&y.value?n.play():n.pause())};return S(d,(n,p)=>{c(o.value[p],!1),c(o.value[n],!0)}),S(y,()=>c(o.value[d.value],!0)),(n,p)=>(s(),u("div",fa,[(s(!0),u(E,null,U(e(w),h=>(s(),O(re,{src:h.path,volume:e(r).bgm,loop:!0,ref_for:!0,ref:k=>o.value[h.id]=k},null,8,["src","volume"]))),256))]))}},ha={class:"invisible",id:"Se"},ba={__name:"SE",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1}},setup(t){const i=t,a=W(),{audioVolume:r}=B(a),f=q(),{getSeByName:g}=f,{seList:w}=B(f),d=x(()=>i.data.SE),y=x(()=>i.play&&!i.pause),o=M({}),c=(n,p)=>{n&&(p&&y.value?n.play():n.pause())};return S(d,(n,p)=>c(o.value[n],!0)),S(y,()=>c(o.value[d.value],!0)),S(()=>i.data,()=>{var p,h;const n=((p=g("text_advancing"))==null?void 0:p.id)??"";c(o.value[n],!((h=i.data)!=null&&h.is_showtime)&&y.value)}),(n,p)=>(s(),u("div",ha,[(s(!0),u(E,null,U(e(w),h=>(s(),O(re,{src:h.path,volume:e(r).se,ref_for:!0,ref:k=>o.value[h.id]=k},null,8,["src","volume"]))),256))]))}},wa={class:"invisible",id:"Se"},$a={__name:"Voice",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},voicing:{type:[Boolean],default:!1}},emits:["update:voicing"],setup(t,{emit:i}){const a=t,r=i,f=W(),{audioVolume:g}=B(f),w=q(),{getSeByName:d}=w,{voiceList:y}=B(w),o=x(()=>a.data.ボイス),c=x(()=>a.play&&!a.pause),n=M({}),p=k=>r("update:voicing",!1),h=(k,b)=>{k&&(b&&c.value?(r("update:voicing",!0),k.play()):k.pause())};return S(o,k=>h(n.value[k],!0)),S(c,()=>h(n.value[o.value],!0)),S(()=>a.data,()=>{var b,C;const k=((b=d("text_advancing"))==null?void 0:b.id)??"";h(n.value[k],!((C=a.data)!=null&&C.is_showtime)&&c.value)}),(k,b)=>(s(),u("div",wa,[(s(!0),u(E,null,U(e(y),C=>(s(),O(re,{src:C.path,volume:e(g).voice,onEnded:p,ref_for:!0,ref:T=>n.value[C.id]=T},null,8,["src","volume"]))),256))]))}},xa={class:"-ui z-10",id:"Se"},Sa=["src"],ka={__name:"Video",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},animating:{type:[Boolean],default:!1}},emits:["update:pause","update:animating"],setup(t,{emit:i}){const a=t,r=i,f=W(),{audioVolume:g}=B(f),w=q(),{videoList:d}=B(w),{getUrl:y}=Ue(),o=x(()=>a.data.show_time==="動畫"),c=x(()=>a.data.show_name),n=x(()=>g.value.bgm),p=M({}),h=b=>{r("update:animating",!1),r("update:pause",!1)},k=(b,C)=>{b&&(C&&a.play&&o.value?(r("update:animating",!0),r("update:pause",!0),b.volume=n.value,b.currentTime=0,b.play()):(b.currentTime=0,b.pause()))};return S(c,(b,C)=>{b&&k(p.value[b],!0)}),S(()=>a.play,()=>k(p.value[c.value],!0)),(b,C)=>{const T=G("opacity");return $((s(),u("div",xa,[(s(!0),u(E,null,U(e(d),N=>$((s(),u("video",{class:"-ui",src:e(y)(N.path),onEnded:h,ref_for:!0,ref:L=>p.value[N.id]=L},null,40,Sa)),[[T,N.id===c.value]])),256))],512)),[[D,o.value]])}}},Ba={class:"-ui bg-black",id:"Background"},Ca={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,a=Y(),{playEase:r}=B(a),f=q(),{getHistoryList:g}=f,{backgroundList:w}=B(f),d=x(()=>{var y;return(y=g(i.contents,"BG"))==null?void 0:y.show_name});return(y,o)=>{const c=G("opacity");return s(),u("div",Ba,[(s(!0),u(E,null,U(e(w),n=>$((s(),O(X,{class:H(["-ui",e(r)]),src:n.path,alt:n.name},null,8,["src","alt","class"])),[[c,n.id===d.value]])),256))])}}},Ia={class:"-ui",id:"Effect"},Na={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const i=Y(),{playEase:a}=B(i),r=q(),{effectList:f}=B(r);return(g,w)=>{const d=G("opacity");return s(),u("div",Ia,[(s(!0),u(E,null,U(e(f),y=>$((s(),O(X,{class:H(["-ui",e(a)]),src:y.path,alt:y.name},null,8,["src","alt","class"])),[[d,y.id===t.data[t.name]]])),256))])}}},La=["data-name"],Ta={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Object],default:()=>({})},num:{type:[Number],default:1}},setup(t){const i=t,a=ce(),{getSpriteNow:r}=a,{characterList:f}=B(a),g=Y(),{logCGMode:w,playEase:d}=B(g);se();const{getMask:y,geSpritePosition:o,geSpriteSize:c}=ue(),n={1:{name:"顯示角色",sprite:"角色差分",effect:"差分特效"},2:{name:"立ち絵2",sprite:"十六夜差分",effect:"主角特效"}},p=x(()=>n[i.num]??{}),h=x(()=>w.value?"人物":p.value.name),k=x(()=>r(i.contents,i.data[p.value.name],h.value,p.value.sprite)),b=x(()=>i.num===2?i.ui.sprite_number===2:!0),C=x(()=>"sprite_"+i.num);return x(()=>y(i.ui[C.value].mask)),x(()=>o(i.ui[C.value])),x(()=>c(i.ui[C.value])),(T,N)=>{const L=G("visible"),z=G("opacity");return $((s(),O(Je,{id:"Sprite",data:t.ui[C.value],class:H(e(d))},{default:K(()=>[(s(!0),u(E,null,U(e(f),R=>$((s(),u("div",{key:R.id,class:H(["-ui",e(d)]),"data-name":R.name},[(s(!0),u(E,null,U(R.sprite??[],j=>$((s(),O(X,{key:j.id,class:"sprite",src:j.path,alt:j.name},null,8,["src","alt"])),[[L,j.id===k.value]])),128))],10,La)),[[z,R.id===t.data[h.value]]])),128)),_(Na,{name:p.value.effect,data:t.data},null,8,["name","data"])]),_:1},8,["data","class"])),[[z,b.value]])}}},$e=F(Ta,[["__scopeId","data-v-51ccc7c1"]]),Ea={class:"-ui bg-black",id:"CG"},Da={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const i=t,a=q(),{getHistoryList:r}=a,{cgList:f}=B(a),g=x(()=>{var w;return(w=r(i.contents,"CG"))==null?void 0:w.show_name});return(w,d)=>{const y=G("opacity");return s(),u("div",Ea,[(s(!0),u(E,null,U(e(f),o=>$((s(),O(X,{class:"-ui !object-cover",src:o.path,alt:o.name},null,8,["src","alt"])),[[y,o.id===g.value]])),256))])}}},Ma={class:"-ui",id:"UI"},Ua={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Number,String],default:()=>""}},setup(t){const i=Y(),{nameTag1Show:a,nameTag2Show:r,playEase:f}=B(i),g=q(),{uiList:w}=B(g);return se(),(d,y)=>{const o=G("opacity");return s(),u("div",Ma,[(s(!0),u(E,null,U(e(w),c=>$((s(),O(Qe,{class:H(["-ui",e(f)]),data:c,nameTag1Show:e(a),nameTag2Show:e(r)},null,8,["data","nameTag1Show","nameTag2Show","class"])),[[o,c.id===t.ui]])),256)),$(m("div",{class:H(["-ui -replay",e(f)])},null,2),[[o,t.data.is_replay]])])}}},za=F(Ua,[["__scopeId","data-v-759e1103"]]),Va={class:"-ui",id:"NameTag"},Pa={class:"-ui"},Aa={class:"name_tag -font"},Ha={class:"-ui"},ja={class:"name_tag -font"},Oa={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})}},setup(t){const i=t,a=W(),{fontFamily:r,fontWeight:f}=B(a),g=ce(),{getCharacter:w}=g,{characterList:d,characterUnknown:y}=B(g),o=Y(),{isNameRight:c,isNameShow:n}=B(o);se();const{getNameTagStyle:p}=ue(),h=x(()=>w(i.data.人物)),k=x(()=>{const b=c.value?"name_tag_2":"name_tag_1";return p(i.ui[b])});return(b,C)=>{const T=G("opacity");return s(),u("div",Va,[$((s(),u("div",{class:H(["absolute",[e(r).nameTag,e(f).nameTag]]),style:Se(k.value)},[$((s(),u("div",Pa,[(s(!0),u(E,null,U(e(d),N=>$((s(),u("div",{key:N.id,class:"-ui"},[$((s(),u("p",Aa,[ye(V(N.name),1)])),[[T,!N.image_name]]),$(_(X,{class:"name_tag",src:N.image_name,alt:N.name},null,8,["src","alt"]),[[T,N.image_name]])])),[[T,N.id===h.value.id]])),128))])),[[T,!t.data.is_unknown]]),$((s(),u("div",Ha,[$((s(),u("p",ja,[ye(V(e(y).name),1)])),[[T,!e(y).image_name]]),_(X,{class:"name_tag",src:e(y).image_name,alt:e(y).name},null,8,["src","alt"])])),[[T,t.data.is_unknown]])],6)),[[T,e(n)]])])}}},Ga=F(Oa,[["__scopeId","data-v-374d9ef3"]]),Ra=3e3,Fa={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:pause","update:black"],setup(t,{emit:i}){const a=t,r=i,f=x(()=>a.data.show_time==="暗場"),g=M({}),w=x(()=>(g.value.show_name??"").split(",")),d=x(()=>!w.value.includes("前")),y=x(()=>!w.value.includes("後")),o=x(()=>f.value&&!w.value.includes("續")),c=M(!1),n=M(!1),p=()=>{if(f.value){if(g.value={...a.data},n.value=a.play&&d.value,c.value=!0,r("update:black",!0),!a.play)return;setTimeout(()=>{a.index>=a.length||r("update:index",a.index+1)},Ra)}else n.value=a.play&&y.value,c.value=!1,r("update:black",!1)};return S(f,p),S(()=>a.play,p),S(o,h=>r("update:pause",h)),(h,k)=>(s(),u("div",{class:H(["-ui z-20 bg-black",{"opacity-0":!c.value,"duration-1000":n.value}]),id:"Black"},null,2))}},qa={class:"preview_title"},Wa=["value"],Ka=["onDragstart","onDragend","data-id"],Ja={class:"contents"},Qa={class:"-ui pointer-events-none"},Xa={__name:"index",setup(t){const i=ze(),a=W(),{fullscreen:r}=B(a),f=xe(),{chapterIndex:g,chapterNames:w,chapterData:d}=B(f),y=Y(),{stopPlaying:o,changeLog:c}=y,{logId:n,logIndex:p,logData:h,logContents:k,logHistory:b,logCGMode:C,logUIId:T,logUI:N,logPlay:L,logPause:z,logTyping:R,logBlack:j,logVoicing:ee,logAnimating:te,playEase:ke}=B(y),{getClientRect:Be}=se(),{dragMove:Ce,dropMove:Ie}=Ae(),{swipeStart:de,swipeEnd:Ne}=Ye();S(g,o);const Le=x(()=>d.value.some(I=>I.dragging)),pe=(I,l,Q)=>{Q&&Ce(I,{index:l}),d.value[l].dragging=Q},Te=(I,l)=>Ie(d.value,I.index,l),ve=M({}),J=(I=!0)=>{Pe(()=>{const l=ve.value[n.value];if(!l)return;const{height:Q,top:le}=Be(l);l.parentElement.scrollBy({top:le-Q,left:0,behavior:I?"smooth":"auto"})})};S(n,()=>{L.value&&J()}),S(g,()=>J(!1)),S(()=>i.name,I=>{I==="Preview"&&J(!1)});const me=M(null);S(r,I=>{window.api?window.api.fullscreen(I):I?me.value.requestFullscreen():document.exitFullscreen()});const ge=M(null),_e=I=>ge.value=I,oe=M(!1),ae=Ve({id:0,type:""}),fe=(I,{type:l})=>{ae.id=I,ae.type=l??"",oe.value=!0},Ee=I=>d.value.push(I),De=I=>{n.value=I,setTimeout(()=>J(),100)},Me=I=>{Ne(I)>0?c(1):c(-1)};return(I,l)=>{const Q=G("opacity"),le=G("visible");return s(),O(We,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:K(()=>[_(Oe,{positions:ge.value,onClear:_e,onUse:l[0]||(l[0]=v=>fe("add",v)),onlyAdd:!0},null,8,["positions"]),m("section",qa,[_(qe,{class:"preview_title_select",value:e(g),"onUpdate:value":l[1]||(l[1]=v=>A(g)?g.value=v:null)},{default:K(()=>[(s(!0),u(E,null,U(e(w),(v,Z)=>(s(),u("option",{value:Z},V(v),9,Wa))),256))]),_:1},8,["value"]),$(m("button",{class:"preview_button",onClick:l[2]||(l[2]=v=>J()),title:"今のセリフ画面へ"},[_(Ge)],512),[[D,!e(r)]]),m("button",{class:"preview_button",onClick:_e,title:"新規"},[_(e(He))])])]),side:K(()=>[(s(!0),u(E,null,U(e(d),(v,Z)=>$((s(),u("div",{key:v.id,class:H(["relative",{"-dragging":v.dragging}]),draggable:!0,onDragstart:P=>pe(P,Z,!0),onDragend:P=>pe(P,Z,!1),onDrag:l[4]||(l[4]=ne(()=>{},["prevent"])),onDrop:l[5]||(l[5]=ne(()=>{},["prevent"])),"data-id":v.id,ref_for:!0,ref:P=>ve.value[v.id]=P},[_(Pt,{id:e(n),"onUpdate:id":l[3]||(l[3]=P=>A(n)?n.value=P:null),log:v,onEdit:P=>fe(v.id,{}),onDelete:P=>v.is_delete=!0,onStop:e(o)},null,8,["id","log","onEdit","onDelete","onStop"]),_(je,{class:"preview_dragline !h-1 !text-secondary/50",onDrop:P=>Te(P,Z+1),dragging:Le.value},null,8,["onDrop","dragging"])],42,Ka)),[[D,!v.is_delete]])),128))]),default:K(()=>[m("div",{class:"preview",onKeydown:[l[16]||(l[16]=ie(v=>L.value=!e(L),["space"])),l[17]||(l[17]=ie(v=>e(c)(-1),["left"])),l[18]||(l[18]=ie(v=>e(c)(1),["right"]))],onTouchstart:l[19]||(l[19]=ne((...v)=>e(de)&&e(de)(...v),["prevent"])),onTouchend:ne(Me,["prevent"]),tabindex:"0",ref_key:"preview",ref:me},[_(Ke,{box:"lattice"},{outer:K(()=>[_(ma,{index:e(p),"onUpdate:index":l[13]||(l[13]=v=>A(p)?p.value=v:null),play:e(L),"onUpdate:play":l[14]||(l[14]=v=>A(L)?L.value=v:null),typing:e(R),black:e(j),voicing:e(ee),animating:e(te),length:e(k).length-1,onTarget:l[15]||(l[15]=v=>J()),onStop:e(o)},null,8,["index","play","typing","black","voicing","animating","length","onStop"])]),default:K(()=>[m("div",Ja,[_(ya,{contents:e(b),play:e(L),pause:e(z)},null,8,["contents","play","pause"]),_(ba,{data:e(h),play:e(L),pause:e(z)},null,8,["data","play","pause"]),_($a,{data:e(h),play:e(L),pause:e(z),voicing:e(ee),"onUpdate:voicing":l[6]||(l[6]=v=>A(ee)?ee.value=v:null)},null,8,["data","play","pause","voicing"])]),$((s(),u("div",Qa,[_(Ca,{contents:e(b)},null,8,["contents"]),_($e,{data:e(h),contents:e(b),ui:e(N),num:1},null,8,["data","contents","ui"]),_($e,{data:e(h),contents:e(b),ui:e(N),num:2},null,8,["data","contents","ui"]),$(_(Da,{contents:e(b),class:H(e(ke))},null,8,["contents","class"]),[[Q,e(C)]]),_(za,{data:e(h),contents:e(b),ui:e(T)},null,8,["data","contents","ui"]),_(Ga,{data:e(h),ui:e(N)},null,8,["data","ui"])])),[[le,e(d).length]]),_(_a,{class:"pointer-events-none",data:e(h),ui:e(N),play:e(L),typing:e(R),"onUpdate:typing":l[7]||(l[7]=v=>A(R)?R.value=v:null),black:e(j)},null,8,["data","ui","play","typing","black"]),_(Fa,{index:e(p),"onUpdate:index":l[8]||(l[8]=v=>A(p)?p.value=v:null),data:e(h),play:e(L),pause:e(z),"onUpdate:pause":l[9]||(l[9]=v=>A(z)?z.value=v:null),black:e(j),"onUpdate:black":l[10]||(l[10]=v=>A(j)?j.value=v:null),length:e(k).length-1},null,8,["index","data","play","pause","black","length"]),_(ka,{data:e(h),play:e(L),pause:e(z),"onUpdate:pause":l[11]||(l[11]=v=>A(z)?z.value=v:null),animating:e(te),"onUpdate:animating":l[12]||(l[12]=v=>A(te)?te.value=v:null)},null,8,["data","play","pause","animating"])]),_:1})],544),_(Re,{open:oe.value,"onUpdate:open":l[20]||(l[20]=v=>oe.value=v),id:ae.id,type:ae.type,onAdd:Ee,onTarget:De},null,8,["open","id","type"])]),_:1})}}},dn=F(Xa,[["__scopeId","data-v-76ecb439"]]);export{dn as default};
