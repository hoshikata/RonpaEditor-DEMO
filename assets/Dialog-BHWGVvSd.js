import{_ as P,L as ee,M as te,r as E,g as I,q as R,w as g,N as ce,o as k,c as $,I as pe,F as se,x as oe,t as H,v as U,d as m,m as le,i as L,a as t,n as O,j as Y,O as ae,P as de,u as re,s as j,h as ve,b as _e,e as h,C as M,J as he,K as me,f as fe}from"./index-DMwXrg5Y.js";/* empty css                                                             */const ge=["disabled","placeholder"],ye=["value"],we={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){ee(p=>({c45911e2:m(c).light.text}));const r=l,v=f,{colors:c}=te(),n=E("");return I(n,p=>v("update:value",p)),I(()=>r.value,p=>n.value=p,{immediate:!0}),(p,d)=>{const _=R("verify");return g((k(),$("select",{class:"select","onUpdate:modelValue":d[0]||(d[0]=a=>n.value=a),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},[pe(p.$slots,"default",{},void 0,!0),(k(!0),$(se,null,oe(l.options,a=>g((k(),$("option",{key:a.id??a.name??a.title??a,value:a.id??a},H(a.name??a.title??a.id??a),9,ye)),[[U,a.show??!0]])),128))],8,ge)),[[ce,n.value,void 0,{lazy:!0,trim:!0}],[_,void 0,void 0,{check:!0}]])}}},C=P(we,[["__scopeId","data-v-8ba13645"]]),be={class:"menu_list"},xe={class:"contents"},Se=["onClick","title"],ke={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(l,{emit:f}){const r=l,v=f,{getClientRect:c}=le(),n=E(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],d=L(()=>{const{width:w,height:S}=c(document.documentElement),{width:b,height:y}=c(n.value),{x:T,y:z,width:G,height:B}=r.positions??{},e=(z??0)+(B??0)/2-(y??0)/2,D=(e<20?20:e)+"px",N=(S??0)-(y??0)-20+"px",A=`min(${D}, ${N})`,K=(T??0)+(b??0)>w,F=(T??0)+(G??0)+2,q=(T??0)-(b??0)-9-2,W=(K?q:F)+"px";return{top:A,left:W}}),_=L(()=>{const{width:w}=c(document.documentElement),{width:S}=c(n.value),{x:b,y,width:T,height:z}=r.positions??{},G=(y??0)+(z??0)/2,B=(b??0)+(S??0)>w,e=(b??0)+(T??0)+3,D=(b??0)-3.2,N=B?D:e;return{top:G+"px",left:N+"px",turn:B}}),a=w=>{w.target.matches(".menu, .menu *")||v("clear",null)},x=w=>{v("use",{type:w}),v("clear",null)};return(w,S)=>{const b=R("visible");return g((k(),$("div",{class:"menu_container",onClick:a},[t("div",{class:O(["menu_triangle",{"-scale-x-100":_.value.turn}]),style:Y(_.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:Y(d.value),ref_key:"menu",ref:n},[t("ul",be,[(k(),$(se,null,oe(p,y=>t("li",xe,[g(t("button",{class:O(["menu_item",y.class]),onClick:T=>x(y.type),title:y.title},H(y.title),11,Se),[[U,!(["copy","edit","delete"].includes(y.type)&&l.onlyAdd)]])])),64))])],4)])),[[b,l.positions]])}}},Gt=P(ke,[["__scopeId","data-v-e4cfe076"]]),$e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),Le=[Ce];function Ue(l,f){return k(),$("svg",$e,[...Le])}const Te={name:"ic-round-close",render:Ue},Be=["disabled","placeholder"],J={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){const r=l,v=f,c=E("");return I(c,n=>v("update:value",n)),I(()=>r.value,n=>c.value=n,{immediate:!0}),(n,p)=>{const d=R("verify");return g((k(),$("input",{"onUpdate:modelValue":p[0]||(p[0]=_=>c.value=_),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},null,8,Be)),[[ae,c.value,void 0,{lazy:!0,trim:!0}],[d,void 0,void 0,{check:!0}]])}}},Me=["disabled","placeholder"],Oe={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(l,{emit:f}){const r=l,v=f,c=E(null),n=E(""),p=d=>{if(!d.ctrlKey)return;const{selectionStart:_,selectionEnd:a}=c.value;v("selected",{start:_,end:a})};return I(n,d=>v("update:value",d)),I(()=>r.value,d=>n.value=d,{immediate:!0}),(d,_)=>{const a=R("verify");return g((k(),$("textarea",{class:"scrollbar textarea","onUpdate:modelValue":_[0]||(_[0]=x=>n.value=x),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder,onKeydown:de(p,["q"]),ref_key:"textarea",ref:c},null,40,Me)),[[ae,n.value,void 0,{lazy:!0,trim:!0}],[a,void 0,void 0,{check:!0}]])}}},Z=P(Oe,[["__scopeId","data-v-c1e57f9a"]]),u=l=>(he("data-v-af083f4b"),l=l(),me(),l),Ie={class:"popup_window"},Ee={class:"popup_header"},Ge={class:"popup_close",title:"キャンセル"},De={class:"popup_container scrollbar"},Ne={class:"contents"},Ve={class:"contents"},He={class:"popup_label"},Pe=u(()=>t("div",{class:"-col-2"},null,-1)),Re={class:"contents"},ze=u(()=>t("span",{class:"popup_label"},"内容",-1)),je={value:""},Ae={class:"contents"},Ke={class:"contents"},Fe=u(()=>t("span",{class:"popup_label"},"話し手",-1)),qe={class:"popup_input"},We={class:"contents"},Je=u(()=>t("span",{class:"popup_label"},"話し手",-1)),Qe={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Xe={class:"popup_group"},Ye=u(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Ze={class:"contents"},et=u(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),tt=u(()=>t("option",{value:""},"無指定",-1)),st={class:"contents"},ot=u(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),lt=u(()=>t("option",{value:""},"引き継ぎ",-1)),at={class:"contents"},nt=u(()=>t("span",{class:"popup_label"},"エフェクト",-1)),it=u(()=>t("option",{value:""},"なし",-1)),ut={class:"popup_group"},ct=u(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),pt={class:"contents"},dt=u(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),rt=u(()=>t("option",{value:""},"無指定",-1)),vt={class:"contents"},_t=u(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),ht=u(()=>t("option",{value:""},"引き継ぎ",-1)),mt={class:"contents"},ft=u(()=>t("span",{class:"popup_label"},"エフェクト",-1)),gt=u(()=>t("option",{value:""},"なし",-1)),yt={class:"contents"},wt=u(()=>t("span",{class:"popup_label"},"SE",-1)),bt={class:"contents"},xt=u(()=>t("span",{class:"popup_label"},"ボイス",-1)),St={class:"contents"},kt=u(()=>t("span",{class:"popup_label"},"セリフ",-1)),$t={class:"-col-3 grid gap-1"},Ct=u(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Lt={class:"contents"},Ut=u(()=>t("span",{class:"popup_label"},"備考",-1)),Tt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(l,{emit:f}){const r=l,v=f,c=re(),{getCharacter:n}=c,{characterList:p,characterReals:d}=j(c),_=ve(),{newLog:a}=_,{chapterData:x}=j(_),w=_e(),{effectList:S,backgroundList:b,cgList:y,bgmList:T,seList:z}=j(w),{isDev:G,findData:B}=le(),e=E({}),D=L(()=>{var i;return(i=n(e.value.人物))==null?void 0:i.name}),N=L(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform}]),A=[{id:"前"},{id:"後"},{id:"續"}],K=L(()=>{const i=e.value.show_time;if(i==="BG")return b.value;if(i==="CG")return y.value;if(i==="暗場")return A}),F=L(()=>p.value.filter(i=>!i.disabled||i.unknown)),q=L(()=>Q(e.value.顯示角色)),W=L(()=>Q(e.value.立ち絵2)),Q=i=>{var s;return((s=n(i))==null?void 0:s.sprite)??[]},ne=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},X=i=>e.value[i]="",ie=()=>{const i={...e.value};if(r.id==="add")v("add",i);else{const V=B(x.value,r.id);Object.assign(V,i)}v("update:open",!1),(!i.is_showtime||i.show_time==="暗場")&&v("target",i.id)},ue=i=>{const s=i.target.matches(".popup_window, .popup_window *"),V=i.target.matches(".popup_close");(!s||V)&&v("update:open",!1)};return I(()=>r.open,i=>{i&&(r.id==="add"?e.value=a(r.type):e.value={...B(x.value,r.id)},G&&console.log({...e.value}))}),(i,s)=>{const V=R("visible");return g((k(),$("section",{class:"popup",onClick:ue},[t("div",Ie,[t("header",Ee,[t("button",Ge,[h(m(Te),{class:"pointer-events-none"})])]),t("div",De,[g(t("div",Ne,[t("div",Ve,[t("span",He,H(e.value.人物),1),h(C,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:N.value,onChange:ne},null,8,["value","options"])]),Pe,t("div",Re,[ze,g(h(J,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[U,e.value.show_time==="BGM"]]),g(h(C,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:K.value},{default:M(()=>[t("option",je,H(e.value.show_time==="暗場"?"全":"なし"),1)]),_:1},8,["value","options"]),[[U,e.value.show_time!=="BGM"]])])],512),[[U,e.value.is_showtime]]),g(t("div",Ae,[g(t("div",Ke,[Fe,t("span",qe,H(D.value),1)],512),[[U,e.value.is_announce||e.value.is_system]]),g(t("div",We,[Je,h(C,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:F.value},null,8,["value","options"])],512),[[U,!(e.value.is_announce||e.value.is_system)]]),t("div",Qe,[t("button",{class:O(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:O(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:O(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",Xe,[Ye,t("div",Ze,[et,h(C,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),options:m(d),onChange:s[8]||(s[8]=o=>X("角色差分"))},{default:M(()=>[tt]),_:1},8,["value","options"])]),t("div",st,[ot,h(C,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:q.value},{default:M(()=>[lt]),_:1},8,["value","options"])]),t("div",at,[nt,h(C,{class:"popup_select",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o),options:m(S)},{default:M(()=>[it]),_:1},8,["value","options"])])]),t("div",ut,[ct,t("div",pt,[dt,h(C,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),options:m(d),onChange:s[12]||(s[12]=o=>X("十六夜差分"))},{default:M(()=>[rt]),_:1},8,["value","options"])]),t("div",vt,[_t,h(C,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:W.value},{default:M(()=>[ht]),_:1},8,["value","options"])]),t("div",mt,[ft,h(C,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o),options:m(S)},{default:M(()=>[gt]),_:1},8,["value","options"])])]),t("div",yt,[wt,h(J,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",bt,[xt,h(J,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",St,[kt,t("div",$t,[h(Z,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),Ct])])],512),[[U,!e.value.is_showtime]]),t("div",Lt,[Ut,h(Z,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:ie,title:"保存"},"保存")])])])),[[V,l.open]])}}},Dt=P(Tt,[["__scopeId","data-v-af083f4b"]]),Bt={class:"dialog_wrap"},Mt=["data-content","innerHTML"],Ot={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(l){ee(a=>({"35896f63":m(n).lineHeight,"4d5ca058":m(n).letterSpace,"15be853d":m(n).fontLength,f66c4386:m(p).keyword.dark,"729921a5":m(p).monolog.dark,"0085a039":m(p).announce.dark}));const f=l,r=fe(),{fontFamily:v,fontWeight:c,fontStyle:n}=j(r),{colors:p}=te(),d=L(()=>{const a=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),x=_("keyword"),S=f.value.replace(a,`<span class="${x}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:f.value.replace(/\[|\]/g,""),html:S}}),_=a=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[a]??"text-white";return(a,x)=>(k(),$("div",{class:O(["dialog",[m(v).dialog,m(c).dialog]])},[t("div",Bt,[t("pre",{class:O(_(l.type)),"data-content":d.value.value,innerHTML:d.value.html},null,10,Mt)])],2))}},Nt=P(Ot,[["__scopeId","data-v-0b46230a"]]);export{Nt as D,Dt as E,Gt as M,C as S,J as _};
