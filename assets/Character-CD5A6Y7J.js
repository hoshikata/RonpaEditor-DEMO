import{o as p,c as v,a as s,k as N,_ as S,m as H,w as r,b as c,u as B,n as F,y as T,s as M,g as V,B as j,F as k,p as E,K as y,h as x,H as L,I as O,J as R}from"./index-BqjBh2Sn.js";import{_ as A}from"./Image-C-xUPCzR.js";import{D as w,C as J,u as K}from"./useDrag-b8YJx7eh.js";import{a as z}from"./IconDelete-D8lqR4xW.js";import{H as P}from"./Header-D-hq--Xn.js";const X={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},q=s("path",{fill:"currentColor",d:"m12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72l3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41l-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08z"},null,-1),G=[q];function Q(a,h){return p(),v("svg",X,[...G])}const W={name:"ic-round-star",render:Q};function Y(){const{findData:a}=N(),h=(l,o)=>{const n=o.replace(/\s/g,"").toLowerCase().split(","),g=l.name.slice(l.name.lastIndexOf(".")).toLowerCase();return o!==""?n.includes(g):!0},i=l=>l instanceof Blob;return{isFileType:h,isBlobFile:i,blobUrl:(l,o)=>{const n=g=>g.slice(-1)==="/"?"":g;return i(l)?URL.createObjectURL(l):n(o??"")},getFileName:l=>{var n;l=l??"";const o=(n=l.lastIndexOf)==null?void 0:n.call(l,"/");return i(l)||o===-1?l:l.slice(o).slice(1)},getFilesData:(l,o)=>{const n=o.filter(_=>!_.id),g=l.filter(_=>!a(o,_.id)).map(_=>_.name),C=l.filter(_=>a(o,_.id));return{addList:n,delList:g,resultList:C}}}}const Z={class:"upload_input"},ee={class:"upload_image"},se=["src"],te={__name:"Upload",props:{value:{type:[String],default:""},type:{type:[String],default:"contain"},disabled:{type:[Boolean],default:!1}},emits:["update:value"],setup(a,{emit:h}){const{blobUrl:i}=Y(),U=h,D=l=>{const o=l.target.files[0],n=i(o,"");U("update:value",n)},$=()=>U("update:value","");return(l,o)=>{const n=H("visible");return p(),v("div",{class:F(["upload",{"pointer-events-none":a.disabled}])},[r((p(),v("label",Z,[c(B(z)),s("input",{class:"hidden",onChange:D,type:"file",accept:"image/*"},null,32)])),[[n,!a.value]]),r((p(),v("div",ee,[s("img",{class:F(["size-full",a.type==="cover"?"object-cover":"object-contain"]),src:a.value},null,10,se),s("button",{class:"upload_remove",onClick:$,title:"削除画像"},[c(B(z),{class:"rotate-45"})])])),[[n,a.value]])],2)}}},I=S(te,[["__scopeId","data-v-56eb6a48"]]),f=a=>(O("data-v-6e847572"),a=a(),R(),a),le={class:"setting_wrap"},oe=f(()=>s("div",null,null,-1)),ne=f(()=>s("div",{class:"setting_head"},[s("h2",{class:"setting_title"},"アイコン"),s("p",{class:"setting_desc"},"ゲーム内表示"),s("p",{class:"setting_desc highlight"},"★ = 主人公")],-1)),ae=f(()=>s("div",{class:"setting_head col-span-2"},[s("h2",{class:"setting_title"},"お名前"),s("p",{class:"setting_desc"},"EXCEL内表示")],-1)),ie=f(()=>s("div",{class:"setting_head"},[s("h2",{class:"setting_title"},"名札"),s("p",{class:"setting_desc"},"ゲーム内表示"),s("p",{class:"setting_desc"},"（画像のない場合はカタカナ表示になります）")],-1)),de=["draggable","onDragstart","onDragend"],ue={class:"setting_avatar"},_e=["onClick"],ce={class:"setting_detail",draggable:"false"},re=["onUpdate:modelValue","disabled","onFocus","onBlur"],ge={class:"setting_col"},pe=f(()=>s("p",{class:"ml-0.5"},"名前の色",-1)),ve=["onUpdate:modelValue","onFocus","onBlur"],me=["onUpdate:modelValue"],be={class:"setting_detail"},fe=["onUpdate:modelValue","disabled","onFocus","onBlur"],he={class:"setting_col"},ye=f(()=>s("p",{class:"ml-0.5"},"名前の背景色",-1)),Ue=["onUpdate:modelValue","onFocus","onBlur"],Ce=["onUpdate:modelValue"],De=f(()=>s("div",{class:"col-span-5 mb-4"},null,-1)),$e={__name:"Character",setup(a){const h=T(),{characterList:i,characterNew:U}=M(h),{dragMove:D,dropMove:$}=K(),l=V(()=>i.value.some(u=>u.is_hero)),o=V(()=>i.value.some(u=>u.dragging)),n=u=>{const d={...U.value},m=[...i.value].sort((e,b)=>b.id-e.id)[0];d.id=m?m.id+1:0,i.value.splice(u+1,0,d)},g=u=>i.value.splice(u,1),C=(u,d,m)=>{m&&D(u,{index:d}),i.value[d].dragging=m},_=(u,d)=>$(i.value,u.index,d);return(u,d)=>{const m=H("visible");return p(),v("div",le,[c(P,{col:"col-span-5"},{default:j(()=>[oe,ne,ae,ie]),_:1}),c(w,{class:"setting_dragline",onDrop:d[0]||(d[0]=e=>_(e,0)),dragging:o.value},null,8,["dragging"]),(p(!0),v(k,null,E(B(i),(e,b)=>(p(),v(k,{key:e.id},[s("section",{class:F(["setting_container",{dragging:e.dragging}]),draggable:e.is_drag,onDragstart:t=>C(t,b,!0),onDragend:t=>C(t,b,!1),onDrag:d[1]||(d[1]=L(()=>{},["prevent"])),onDrop:d[2]||(d[2]=L(()=>{},["prevent"]))},[c(J,{class:"row-span-2 -mr-6",hasDel:!e.disabled,onAdd:t=>n(b),onDel:t=>g(b)},null,8,["hasDel","onAdd","onDel"]),s("div",ue,[c(A,{class:"setting_avatar_img",src:e.default_head},null,8,["src"]),c(I,{class:"size-full",value:e.image_head,"onUpdate:value":t=>e.image_head=t,type:"cover"},null,8,["value","onUpdate:value"]),r((p(),v("button",{class:F(["setting_star",{"setting_star-active":e.is_hero}]),onClick:t=>e.is_hero=!e.is_hero,title:"主人公"},[c(B(W))],10,_e)),[[m,!(l.value&&!e.is_hero)]])]),s("div",ce,[r(s("input",{class:"setting_name last","onUpdate:modelValue":t=>e.name=t,style:x({"--name-bg":e.name_bg,"--name-text":e.name_text}),disabled:e.disabled,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,44,re),[[y,e.name,void 0,{lazy:!0,trim:!0}]]),s("div",ge,[pe,r(s("input",{class:"setting_input","onUpdate:modelValue":t=>e.name_text=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,40,ve),[[y,e.name_text,void 0,{lazy:!0,trim:!0}]]),s("label",{class:"setting_color",style:x({"background-color":e.name_text})},[r(s("input",{class:"hidden","onUpdate:modelValue":t=>e.name_text=t,type:"color"},null,8,me),[[y,e.name_text,void 0,{lazy:!0}]])],4)])]),s("div",be,[r(s("input",{class:"setting_name first","onUpdate:modelValue":t=>e.katakana=t,disabled:e.disabled,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,40,fe),[[y,e.katakana,void 0,{lazy:!0,trim:!0}]]),s("div",he,[ye,r(s("input",{class:"setting_input","onUpdate:modelValue":t=>e.name_bg=t,onFocus:t=>e.is_drag=!1,onBlur:t=>e.is_drag=!0},null,40,Ue),[[y,e.name_bg,void 0,{lazy:!0,trim:!0}]]),s("label",{class:"setting_color",style:x({"background-color":e.name_bg})},[r(s("input",{class:"hidden","onUpdate:modelValue":t=>e.name_bg=t,type:"color"},null,8,Ce),[[y,e.name_bg,void 0,{lazy:!0}]])],4)])]),c(I,{class:"setting_nametag",value:e.image_name,"onUpdate:value":t=>e.image_name=t},null,8,["value","onUpdate:value"])],42,de),c(w,{class:"setting_dragline",onDrop:t=>_(t,b+1),dragging:o.value},null,8,["onDrop","dragging"])],64))),128)),De])}}},Le=S($e,[["__scopeId","data-v-6e847572"]]);export{Le as default};
