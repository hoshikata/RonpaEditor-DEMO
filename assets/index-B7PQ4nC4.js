import{o as f,c as T,a as t,_ as j,H as Me,n as M,I as He,h as ge,s as V,u as me,b as fe,q as xe,j as P,A as Ue,r as X,J as Ne,l as Ve,w as q,d as e,e as i,v as W,x as E,F as ne,m as $e,K as Ce,L as ke,g as _e,M as Pe,t as ce,p as Y,y as Se,z as je,N as Fe,C as Ee,G as Ge,E as We}from"./index-DU34YnvH.js";import{I as ze,a as Le,D as qe}from"./IconDelete-CmLP4t5v.js";import{W as Je}from"./Wrap-CuQwMbM6.js";import{C as Ie}from"./Control-C7Zctl6o.js";import{I as Ke,u as Qe,M as Xe,E as Ye}from"./EditPopup-Bf5PcWcf.js";import{M as Ze}from"./Mark-ClJB9S59.js";import{_ as ye,S as Q,D as et}from"./Dialog-DtczLKx1.js";import{R as tt}from"./Radio-CZVIZIcF.js";import{A as st}from"./Avatar-XhHO4ii8.js";import"./round-drag-indicator-BCCciXuQ.js";/* empty css                                                             */import"./Image-DnEKK9kc.js";const ot={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},lt=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),at=[lt];function nt(s,g){return f(),T("svg",ot,[...at])}const it={name:"ic-round-close",render:nt},ct={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(s){return(g,h)=>(f(),T("button",{class:M(["switch",{"bg-current":s.active}])},[t("span",{class:M(["-mt-0.1em",{"text-white":s.active}])},[Me(g.$slots,"default",{},void 0,!0)],2)],2))}},he=j(ct,[["__scopeId","data-v-8bd1e4e9"]]),rt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ut=t("path",{fill:"currentColor",d:"M15.5 14h-.79l-.28-.27a6.5 6.5 0 0 0 1.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 0 0-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 0 0 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0c.41-.41.41-1.08 0-1.49zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5S14 7.01 14 9.5S11.99 14 9.5 14"},null,-1),dt=[ut];function pt(s,g){return f(),T("svg",rt,[...dt])}const ve={name:"ic-round-search",render:pt},ht={name:"MaterialSymbolsFindReplaceRounded"},vt={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},_t=t("path",{fill:"currentColor",d:"M11 6q-1.575 0-2.838.863T6.35 9.125q-.15.375-.487.563t-.738.112t-.638-.387t-.112-.663q.675-2.1 2.475-3.425T11 4q1.475 0 2.763.562T16 6.1V5q0-.425.288-.712T17 4t.713.288T18 5v4q0 .425-.288.713T17 10h-4q-.425 0-.712-.288T12 9t.288-.712T13 8h2q-.725-.9-1.737-1.45T11 6m0 12q-1.475 0-2.762-.562T6 15.9V17q0 .425-.288.713T5 18t-.712-.288T4 17v-4q0-.425.288-.712T5 12h4q.425 0 .713.288T10 13t-.288.713T9 14H7q.725.9 1.738 1.45T11 16q1.55 0 2.788-.825T15.6 13q.175-.4.513-.638t.762-.162q.425.1.625.45t.075.75q-.175.5-.413.938t-.562.862l3.7 3.7q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-3.7-3.7q-.9.675-1.962 1.038T11 18"},null,-1),gt=[_t];function mt(s,g,h,w,b,$){return f(),T("svg",vt,gt)}const be=j(ht,[["render",mt]]),Te=He("search",()=>{const s=ge(),{initSelected:g}=s,{chapterData:h}=V(s),w=me(),{getCharacter:b,getSprite:$}=w,{characterList:x}=V(w),C=fe(),{getShowList:D}=C,{effectList:F,seList:L}=V(C),{copyObject:m,findData:_}=xe(),a=P(()=>{let o=h.value;const{type:l,result:d}=ee.value;return l===0&&(o=se(d)),l===1&&(o=re(d)),l===2&&(o=ue(d)),o}),Z=P(()=>a.value.map(o=>o.id)),U=Ue({type:0,keyword:{value:"",rep:""},show:{parent:"",child:"",rep:""},items:[{parent:"",child:""}],itemsRep:{parent:"",child:"",rep:""},open:!1}),ee=X({}),te=P(()=>{const o=[];return x.value.forEach(l=>{const d=(l.sprite??[]).map(v=>({id:l.id+"_"+v.id,name:l.name+"："+v.name}));o.push(...d)}),o}),z=o=>{let l=[];const d=["人物","顯示角色","立ち絵2"].includes(o),v=["角色差分","十六夜差分"].includes(o),S=["差分特效","主角特效"].includes(o);return d&&(l=x.value),v&&(l=te.value),S&&(l=F.value),o==="SE"&&(l=L.value),l},oe=()=>{U.keyword={value:"",rep:""},U.show={parent:"",child:"",rep:""},U.items=[{parent:"",child:""}],U.itemsRep={parent:"",child:"",value:""},U.type=0,B()},le=()=>{const{type:o,keyword:l,show:d,items:v,itemsRep:S}=U;let I={};return o===0&&(I={result:l.value,rep:l.rep}),o===1&&(I={result:m(d),rep:d.rep}),o===2&&(I={result:m(v),rep:m(S)}),{type:o,...I}},B=()=>{ee.value=le(),g(h.value),U.open=!1},p=()=>{const o=le();o.value=o;const{type:l,result:d,rep:v}=o;l===0&&we(d,v),l===1&&ie(d,v),l===2&&K(d,v),g(h.value),oe(),U.open=!1};Ne(B);const A=(o,l)=>{const d=D(o)??[],v=_(d,l);return d.length?l!==""&&!v:!1},c=(o,l)=>{const d=z(o)??[],v=_(d,l);return d.length?l!==""&&!v:!1},N=(o,l)=>{const d={角色差分:"顯示角色",十六夜差分:"立ち絵2"},v=o[d[l]],S=o[l],I=b(v).sprite??[],u=$(v,S),r=I.length?S!==""&&u.id===void 0:!1;return{name:d[l],group:v,value:S,isErr:r}},O=o=>o.some(l=>!(l.parent===""&&l.child==="")),J=o=>{let[l,d]=o.split("_");return[l*1,d*1]},G=(o,l,d)=>o===""?!0:o==="err"?l:d,se=o=>(o=o??"",o===""?h.value:h.value.filter(l=>l.和訳.match(o))),re=({parent:o,child:l})=>o===""&&l===""?h.value:h.value.filter(d=>{const{is_showtime:v,show_time:S,show_name:I}=d;if(!v||!(o===""?!0:S===o))return!1;const r=A(S,I);return G(l,r,I===l)}),ue=o=>O(o)?h.value.filter(d=>d.is_showtime?!1:o.every(v=>{const{parent:S,child:I}=v;if(["角色差分","十六夜差分"].includes(S)){const[r,n]=J(I),{group:R,value:y,isErr:de}=N(d,S);return G(I,de,R===r&&y===n)}else{const r=d[S],n=c(S,r);return G(I,n,r===I)}})):h.value,we=(o,l)=>{o=o??"",o!==""&&Z.value.forEach(d=>{const v=_(h.value,d);v.和訳=v.和訳.replace(o,l)})},ie=({parent:o,child:l},d)=>{if(o===""&&l==="")return h.value;Z.value.forEach(v=>{const S=_(h.value,v),{is_showtime:I,show_time:u,show_name:r}=S;if(!I)return;const n=A(u,r);G(l,n,u===o&&r===l)&&(S.show_name=d)})},K=(o,{parent:l,child:d,rep:v})=>{O(o)&&Z.value.forEach(I=>{const u=_(h.value,I);if(u.is_showtime)return;if(["角色差分","十六夜差分"].includes(l)){const[n,R]=J(d),[y,de]=J(v),{name:ae,group:pe,value:Ae,isErr:Oe}=N(u,l);G(d,Oe,pe===n&&Ae===R)&&(u[ae]=y,u[l]=de)}else{const n=u[l],R=c(l,n);G(d,R,n===d)&&(u[l]=v)}})};return{chapterFilter:a,search:U,searchResult:ee,getSpriteEmpty:O,getChildOptions:z,initSearch:oe,submitSearch:B,submitReplace:p,keywordSearch:se,showSearch:re,itemsSearch:ue}}),k=s=>(Ce("data-v-cde933a9"),s=s(),ke(),s),ft={class:"popup_window"},wt={class:"popup_container scrollbar"},St={class:"mb-8 flex justify-center"},bt={class:"popup_keyword_group"},$t=k(()=>t("span",null,null,-1)),yt=["disabled"],xt=k(()=>t("span",null,"を",-1)),Ct=k(()=>t("span",null,"に置き換える",-1)),kt=["disabled"],It={class:"popup_show_group"},Tt=k(()=>t("span",null,null,-1)),Rt=k(()=>t("option",{value:""},"全て",-1)),Et=k(()=>t("span",null,"の",-1)),Lt=k(()=>t("option",{value:""},"全て",-1)),qt=k(()=>t("option",{class:"-error",value:"err"},"エラーバリュー",-1)),Dt=["disabled"],Mt=k(()=>t("span",null,"を",-1)),Ut=k(()=>t("option",{value:""},"全て",-1)),Vt=k(()=>t("option",{class:"-error",value:"err"},"エラーバリュー",-1)),Bt=k(()=>t("span",{class:"col-span-2"},"に置き換える",-1)),At=["disabled"],Ot={class:"contents"},Ht={class:"popup_items_group"},Nt={class:"popup_search_group"},Pt={class:"text-right"},jt=k(()=>t("option",{value:""},"全て",-1)),Ft=k(()=>t("span",null,"の",-1)),Gt=k(()=>t("option",{value:""},"全て",-1)),Wt={class:"-error",value:"err"},zt=["onClick"],Jt={class:"popup_search"},Kt=["disabled"],Qt={class:"popup_replace"},Xt=k(()=>t("option",{value:""},"全て",-1)),Yt=k(()=>t("span",null,"の",-1)),Zt=k(()=>t("option",{value:""},"全て",-1)),es={class:"-error",value:"err"},ts=k(()=>t("span",null,"を",-1)),ss=k(()=>t("option",{value:""},"なし",-1)),os=k(()=>t("span",null,"に置き換える",-1)),ls=["disabled"],as={class:"popup_footer"},ns={__name:"Search",emits:["goTop"],setup(s,{emit:g}){const h=me();V(h);const w=fe(),{getEffect:b,getSe:$,getShowList:x}=w;V(w);const C=Te(),{getSpriteEmpty:D,getChildOptions:F,initSearch:L,submitSearch:m,submitReplace:_}=C,{search:a,chapterFilter:Z}=V(C),U=P(()=>D(a.value.items)),ee=[{id:"UI"},{id:"BG"},{id:"BGM"},{id:"CG"},{id:"暗場"}],te=[{id:"人物",name:"話し手"},{id:"顯示角色",name:"立ち絵1名前"},{id:"角色差分",name:"立ち絵1差分"},{id:"差分特效",name:"立ち絵1エフェクト"},{id:"立ち絵2",name:"立ち絵2名前"},{id:"十六夜差分",name:"立ち絵2差分"},{id:"主角特效",name:"立ち絵2エフェクト"},{id:"SE"},{id:"Voice"}],z=()=>a.value.items.push({parent:"",child:""}),oe=B=>a.value.items.splice(B,1),le=B=>{const p=B.target.matches(".popup_window, .popup_window *"),A=B.target.matches(".popup_close");!B.target.matches(".popup_remove")&&(!p||A)&&(a.value.open=!1)};return(B,p)=>{const A=Ve("visible");return q((f(),T("section",{class:"popup",onClick:le},[t("div",ft,[t("div",wt,[t("div",St,[i(tt,{class:"popup_radio",value:e(a).type,"onUpdate:value":p[0]||(p[0]=c=>e(a).type=c),list:[{id:0,title:"セリフ"},{id:1,title:"切り替え＆演出"},{id:2,title:"項目"}],name:"type"},null,8,["value"])]),q(t("div",bt,[$t,i(ye,{class:"popup_input col-span-2",value:e(a).keyword.value,"onUpdate:value":p[1]||(p[1]=c=>e(a).keyword.value=c),placeholder:"キーワード"},null,8,["value"]),t("button",{class:"popup_submit",onClick:p[2]||(p[2]=(...c)=>e(m)&&e(m)(...c)),disabled:e(a).keyword.value==="",title:"サーチ"},[i(e(ve))],8,yt),xt,i(ye,{class:"popup_input",value:e(a).keyword.rep,"onUpdate:value":p[3]||(p[3]=c=>e(a).keyword.rep=c)},null,8,["value"]),Ct,t("button",{class:"popup_submit",onClick:p[4]||(p[4]=(...c)=>e(_)&&e(_)(...c)),disabled:e(a).keyword.value==="",title:"置き換える"},[i(be,{class:"text-[1.2em]"})],8,kt)],512),[[W,e(a).type===0]]),q(t("div",It,[Tt,i(Q,{class:"popup_select",value:e(a).show.parent,"onUpdate:value":p[5]||(p[5]=c=>e(a).show.parent=c),options:ee,onChange:p[6]||(p[6]=c=>{e(a).show.child="",e(a).show.rep=""})},{default:E(()=>[Rt]),_:1},8,["value"]),Et,i(Q,{class:"popup_select",value:e(a).show.child,"onUpdate:value":p[7]||(p[7]=c=>e(a).show.child=c),options:e(x)(e(a).show.parent)},{default:E(()=>[Lt,qt]),_:1},8,["value","options"]),t("button",{class:"popup_submit",onClick:p[8]||(p[8]=(...c)=>e(m)&&e(m)(...c)),disabled:e(a).show.parent===""&&e(a).show.child==="",title:"サーチ"},[i(e(ve))],8,Dt),Mt,i(Q,{class:"popup_select",value:e(a).show.rep,"onUpdate:value":p[9]||(p[9]=c=>e(a).show.rep=c),options:e(x)(e(a).show.parent)},{default:E(()=>[Ut,Vt]),_:1},8,["value","options"]),Bt,t("button",{class:"popup_submit",onClick:p[10]||(p[10]=(...c)=>e(_)&&e(_)(...c)),disabled:e(a).show.rep==="",title:"置き換える"},[i(be,{class:"text-[1.2em]"})],8,At)],512),[[W,e(a).type===1]]),q(t("div",Ot,[t("div",Ht,[(f(!0),T(ne,null,$e(e(a).items,(c,N)=>(f(),T("div",Nt,[q(t("button",{class:"popup_submit",onClick:z,title:"条件を追加"},"条件を追加",512),[[W,!N]]),q(t("span",Pt,"と",512),[[W,N]]),i(Q,{class:"popup_select",value:c.parent,"onUpdate:value":O=>c.parent=O,options:te,onChange:O=>c.child=""},{default:E(()=>[jt]),_:2},1032,["value","onUpdate:value","onChange"]),Ft,i(Q,{class:"popup_select",value:c.child,"onUpdate:value":O=>c.child=O,options:e(F)(c.parent)},{default:E(()=>[Gt,q(t("option",Wt,"エラーバリュー",512),[[W,c.parent!==""]])]),_:2},1032,["value","onUpdate:value","options"]),q((f(),T("button",{class:"popup_remove",onClick:O=>oe(N),title:"削除"},[i(e(it))],8,zt)),[[A,N]])]))),256)),t("div",Jt,[t("button",{class:"popup_submit",onClick:p[11]||(p[11]=(...c)=>e(m)&&e(m)(...c)),disabled:!U.value,title:"サーチ"},[i(e(ve))],8,Kt)])]),t("div",Qt,[i(Q,{class:"popup_select",value:e(a).itemsRep.parent,"onUpdate:value":p[12]||(p[12]=c=>e(a).itemsRep.parent=c),options:te,onChange:p[13]||(p[13]=c=>{e(a).itemsRep.child="",e(a).itemsRep.rep=""})},{default:E(()=>[Xt]),_:1},8,["value"]),Yt,i(Q,{class:"popup_select",value:e(a).itemsRep.child,"onUpdate:value":p[14]||(p[14]=c=>e(a).itemsRep.child=c),options:e(F)(e(a).itemsRep.parent)},{default:E(()=>[Zt,q(t("option",es,"エラーバリュー",512),[[W,e(a).itemsRep.parent!==""]])]),_:1},8,["value","options"]),ts,i(Q,{class:"popup_select",value:e(a).itemsRep.rep,"onUpdate:value":p[15]||(p[15]=c=>e(a).itemsRep.rep=c),options:e(F)(e(a).itemsRep.parent)},{default:E(()=>[ss]),_:1},8,["value","options"]),os,t("button",{class:"popup_submit",onClick:p[16]||(p[16]=(...c)=>e(_)&&e(_)(...c)),disabled:e(a).itemsRep.parent===""&&e(a).itemsRep.child===""||e(a).itemsRep.rep==="",title:"置き換える"},[i(be,{class:"text-[1.2em]"})],8,ls)])],512),[[W,e(a).type===2]])]),t("footer",as,[t("button",{class:"popup_submit -cancel",onClick:p[17]||(p[17]=(...c)=>e(L)&&e(L)(...c)),title:"キャンセル"},"キャンセル")])])])),[[A,e(a).open]])}}},is=j(ns,[["__scopeId","data-v-cde933a9"]]),cs={name:"MaterialSymbolsArrowWarmUpRounded"},rs={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},us=t("path",{fill:"currentColor",d:"M12 13q-.425 0-.712-.288T11 12V5.825L7.1 9.7q-.275.275-.687.288T5.7 9.7q-.275-.275-.275-.7t.275-.7l5.6-5.6q.15-.15.325-.212T12 2.425t.375.063t.325.212l5.6 5.6q.275.275.275.688T18.3 9.7q-.3.3-.712.3t-.713-.3L13 5.825V12q0 .425-.288.713T12 13m0 5q-.425 0-.712-.288T11 17v-1q0-.425.288-.712T12 15t.713.288T13 16v1q0 .425-.288.713T12 18m0 4q-.425 0-.712-.288T11 21t.288-.712T12 20t.713.288T13 21t-.288.713T12 22"},null,-1),ds=[us];function ps(s,g,h,w,b,$){return f(),T("svg",rs,ds)}const De=j(cs,[["render",ps]]),hs={class:"chapter_head"},vs=["disabled"],_s=["disabled"],gs={__name:"Head",setup(s){const g=ge(),{deleteChapter:h,moveChapter:w}=g,{chapterIndex:b,chapterLength:$,chapterTarget:x,chapterData:C}=V(g),D=Te(),{search:F,searchResult:L}=V(D);return(m,_)=>(f(),T("header",hs,[i(ye,{class:"chapter_head_title",value:e(x).title,"onUpdate:value":_[0]||(_[0]=a=>e(x).title=a),placeholder:"タイトル"},null,8,["value"]),t("button",{class:M(["chapter_head_button",{"-active":e(L).result}]),onClick:_[1]||(_[1]=a=>e(F).open=!0),title:"サーチ"},[i(e(ve),{class:"!text-xl"})],2),t("button",{class:"chapter_head_button",onClick:_[2]||(_[2]=a=>e(w)(-1)),disabled:!e(b),title:"上に移動"},[i(De)],8,vs),t("button",{class:"chapter_head_button",onClick:_[3]||(_[3]=a=>e(w)(1)),disabled:!e($)||e(b)===e($)-1,title:"下に移動"},[i(De,{class:"-scale-y-100"})],8,_s),t("button",{class:"chapter_head_button",onClick:_[4]||(_[4]=(...a)=>e(h)&&e(h)(...a)),title:"削除"},[i(ze)])]))}},ms=j(gs,[["__scopeId","data-v-23626d87"]]),fs=["disabled"],ws={class:"whitespace-nowrap"},Ss={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(s,{emit:g}){const h=s,w=g,b=X(0);return _e(b,$=>w("update:value",$)),_e(()=>h.value,$=>b.value=$,{immediate:!0}),($,x)=>(f(),T("label",{class:M(["inline-flex items-center",s.disabled?"cursor-auto":"cursor-pointer"])},[q(t("input",{class:M(["checkbox",s.box]),"onUpdate:modelValue":x[0]||(x[0]=C=>b.value=C),disabled:s.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,fs),[[Pe,b.value]]),t("span",ws,ce(s.title),1),Me($.$slots,"default",{},void 0,!0)],2))}},Be=j(Ss,[["__scopeId","data-v-b7a95cdd"]]),bs={__name:"Inner",props:{value:{type:[Number,String],default:void 0},list:{type:[Array],default:()=>[]},type:{type:[String],default:""}},setup(s){const g=s,{findData:h}=xe(),w=P(()=>h(g.list,g.value)),b=P(()=>g.list.length?g.value!==""&&!w.value:!1),$=P(()=>({"-showtime":g.type==="showtime","!bg-red-500/50":b.value}));return(x,C)=>{var D;return f(),T("div",{class:M(["inner",$.value])},ce(((D=w.value)==null?void 0:D.name)??s.value),3)}}},H=j(bs,[["__scopeId","data-v-11a9e61f"]]),$s=s=>(Ce("data-v-f1131323"),s=s(),ke(),s),ys={class:"chapter log_scene"},xs=$s(()=>t("div",{class:"chapter log_switches xl:!hidden"},null,-1)),Cs={__name:"logShowHead",props:{log:{type:[Object],default:()=>({})}},emits:["more"],setup(s,{emit:g}){const h=g,w=fe(),{getShowList:b}=w;return($,x)=>(f(),T(ne,null,[t("div",{class:M(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[i(Be,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":x[0]||(x[0]=C=>s.log.is_selected=C)},null,8,["value"]),i(Ie,{class:"chapter log_control",onMore:x[1]||(x[1]=C=>h("more",C)),hasDel:!1,hasAdd:!1}),t("div",ys,[t("span",null,ce(s.log.人物),1),t("span",null,ce(s.log.show_time),1),i(H,{value:s.log.show_name,list:e(b)(s.log.show_time),type:"showtime"},null,8,["value","list"])])],2),xs],64))}},ks=j(Cs,[["__scopeId","data-v-f1131323"]]),Is={class:"chapter log_tr_2"},Ts=t("div",{class:"chapter log_td -col"},null,-1),Rs=t("div",{class:"chapter log_td -col"},null,-1),Es=t("div",{class:"chapter log_td -col"},null,-1),Ls={class:"chapter log_td -col"},qs={__name:"logShowBody",props:{log:{type:[Object],default:()=>({})}},setup(s){return(g,h)=>(f(),T("div",Is,[Ts,Rs,Es,t("div",Ls,[i(H,{value:s.log.備註},null,8,["value"])])]))}},Ds={class:"chapter log_comment"},Ms={class:"chapter log_switches"},Us={__name:"logCommentHead",props:{log:{type:[Object],default:()=>({})}},emits:["more","target"],setup(s,{emit:g}){const h=s,w=g,b=me(),{getCharacter:$}=b,x=ge(),{dialogType:C}=x,D=P(()=>$(h.log.人物));return(F,L)=>{const m=Ve("visible");return f(),T(ne,null,[t("div",{class:M(["chapter log_td -first",{"bg-secondary/60":s.log.is_selected}])},[i(Be,{class:"chapter log_check",value:s.log.is_selected,"onUpdate:value":L[0]||(L[0]=_=>s.log.is_selected=_)},null,8,["value"]),i(Ie,{class:"chapter log_control",onMore:L[2]||(L[2]=_=>w("more",_)),onDel:L[3]||(L[3]=_=>s.log.is_delete=!0),hasAdd:!1},{top:E(()=>[t("button",{class:"control_button",onClick:L[1]||(L[1]=_=>w("target")),title:"プレビューのセリフ画面へ"},[i(Ke,{class:"text-xl"})])]),_:1}),t("div",{class:M(["chapter log_info",{"flex-row-reverse":D.value.is_hero,"-replay":s.log.is_replay}])},[i(st,{class:"chapter log_avatar",name:D.value.name??s.log.人物},null,8,["name"]),t("div",Ds,[i(et,{class:"chapter log_dialog",value:s.log.和訳,type:e(C)(s.log)},null,8,["value","type"])])],2)],2),t("div",Ms,[q((f(),Y(he,{class:M(["chapter log_switch",{"text-replay":s.log.is_replay}]),active:s.log.is_replay,title:"再放送"},{default:E(()=>[Se("R")]),_:1},8,["active","class"])),[[m,s.log.is_replay]]),q((f(),Y(he,{class:M(["chapter log_switch",{"text-unknown":s.log.is_unknown}]),active:s.log.is_unknown,title:"未解明"},{default:E(()=>[Se("U")]),_:1},8,["active","class"])),[[m,s.log.is_unknown]]),q((f(),Y(he,{class:M(["chapter log_switch",{"-monolog":s.log.is_monolog}]),active:s.log.is_monolog,title:"独り言"},{default:E(()=>[Se("S")]),_:1},8,["active","class"])),[[m,s.log.is_monolog]])])],64)}}},Vs=j(Us,[["__scopeId","data-v-60d9644e"]]),Bs={class:"chapter log_tr_2"},As={class:"chapter log_td -col"},Os={class:"chapter log_td -col"},Hs={class:"chapter log_td -col"},Ns={class:"chapter log_td -col"},Ps={__name:"logCommentBody",props:{log:{type:[Object],default:()=>({})}},setup(s){const g=me(),{getCharacter:h}=g,{characterList:w}=V(g),b=fe(),{effectList:$,seList:x}=V(b);return(C,D)=>(f(),T("div",Bs,[t("div",As,[i(H,{class:"col-span-2",value:s.log.顯示角色,list:e(w)},null,8,["value","list"]),i(H,{value:s.log.角色差分,list:e(h)(s.log.顯示角色).sprite},null,8,["value","list"]),i(H,{value:s.log.差分特效,list:e($)},null,8,["value","list"])]),t("div",Os,[i(H,{class:"col-span-2",value:s.log.立ち絵2,list:e(w)},null,8,["value","list"]),i(H,{value:s.log.十六夜差分,list:e(h)(s.log.立ち絵2).sprite},null,8,["value","list"]),i(H,{value:s.log.主角特效,list:e($)},null,8,["value","list"])]),t("div",Hs,[i(H,{value:s.log.SE},null,8,["value"]),i(H,{value:s.log.Voice},null,8,["value"])]),t("div",Ns,[i(H,{value:s.log.備註},null,8,["value"])])]))}},Re=s=>(Ce("data-v-419d5ed1"),s=s(),ke(),s),js={class:"side_list"},Fs={class:"flex"},Gs=["onClick","title"],Ws={class:"chapter log"},zs={class:"chapter log_tr -lock"},Js={class:"mx-1 w-14 self-center"},Ks=Re(()=>t("div",{class:"chapter log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Qs=Re(()=>t("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),Xs=Re(()=>t("div",{class:"chapter log_tr_2 -lock"},[t("div",{class:"chapter log_th -col"},"立ち絵1．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"立ち絵2．差分＆エフェクト"),t("div",{class:"chapter log_th -col"},"SE＆ボイス"),t("div",{class:"chapter log_th -col"},"備考")],-1)),Ys={class:"contents"},Zs=["onDragstart","onDragend"],eo={__name:"index",setup(s){const g=je(),h=Fe(),w=ge(),{newChapter:b,deleteChapter:$,moveChapter:x}=w,{chapterIndex:C,chapterNames:D,chapterLength:F,chapterTarget:L,chapterData:m}=V(w),_=Qe(),{newLogId:a}=_,{logId:Z}=V(_),U=Te(),{chapterFilter:ee}=V(U),{findData:te,findIndex:z,getClientRect:oe}=xe(),{dragMove:le,dropMove:B}=Ge(),p=P(()=>m.value.some(u=>u.dragging)),A=P(()=>m.value.filter(u=>u.is_selected&&!u.is_delete).map(u=>u.id)),c=(u,r,n)=>{const R=te(m.value,r),y=m.value.indexOf(R);n&&le(u,{index:y}),A.value.some(ae=>ae===r)||(R.is_selected=1),A.value.forEach(ae=>{const pe=te(m.value,ae);pe.dragging=n,n||(pe.is_selected=0)})},N=(u,r)=>{const n=r===null?0:z(m.value,r)+1;A.value.forEach(R=>{const y=z(m.value,R);B(m.value,y,n)})},O=X(!1),J=X(0),G=X(null),se=(u,r)=>{const n=z(m.value,r);J.value=n===-1?null:n,G.value=u,O.value=r===null},re=({type:u})=>{const r=J.value,n=m.value[r];u==="delete"?we(n):u==="edit"?o(n.id,{}):u==="copy"?ue(n,r+1):o("add",{type:u})},ue=(u,r)=>{m.value.splice(r,0,{...u,id:a()})},we=u=>{u.is_delete=!0,A.value.forEach(r=>r.is_delete=!0)},ie=X(!1),K=Ue({id:0,type:"",index:0}),o=(u,{type:r})=>{K.id=u,K.type=r??"",K.index=J.value,ie.value=!0},l=u=>{const r=J.value===null?m.value.length:K.index+1;m.value.splice(r,0,u)},d=X(null),v=X({}),S=()=>{We(()=>{const u=v.value[Z.value];if(!u)return;const{height:r,top:n}=oe(u);d.value.mainScroll({top:n-r,left:0,behavior:"smooth"})})},I=u=>{Z.value=u,h.push({name:"Preview"})};return _e(C,S),_e(()=>g.name,u=>{u==="Chapters"&&S()}),(u,r)=>(f(),Y(Je,{ref_key:"wrap",ref:d},{side_foot:E(()=>[t("button",{class:"chapter_add",onClick:r[0]||(r[0]=(...n)=>e(b)&&e(b)(...n)),title:"新規"},[i(e(Le))])]),side:E(()=>[t("ul",js,[(f(!0),T(ne,null,$e(e(D),(n,R)=>(f(),T("li",Fs,[i(Ze,{class:"chapter_mark",active:R===e(C)},null,8,["active"]),t("button",{class:M(["side_item",{"side_item-active":R===e(C)}]),onClick:y=>C.value=R,title:n},ce(n),11,Gs)]))),256))])]),main_head:E(()=>[i(ms)]),default:E(()=>[t("div",Ws,[t("div",zs,[t("div",Js,[i(he,{class:"chapter_plus",title:"新規"},{default:E(()=>[i(e(Le),{class:"mt-0.1em"}),i(Ie,{class:"absolute left-0 top-0 opacity-0",onMore:r[1]||(r[1]=n=>se(n,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Ks,Qs]),Xs,i(qe,{class:"chapter log_dragline",onDrop:r[2]||(r[2]=n=>N(n,null)),dragging:p.value},null,8,["dragging"]),(f(!0),T(ne,null,$e(e(ee),(n,R)=>(f(),T(ne,{key:n.id},[q(t("section",Ys,[t("div",{class:M(["chapter log_tr",{"-dragging":n.dragging}]),draggable:!0,onDragstart:y=>c(y,n.id,!0),onDragend:y=>c(y,n.id,!1),onDrag:r[3]||(r[3]=Ee(()=>{},["prevent"])),onDrop:r[4]||(r[4]=Ee(()=>{},["prevent"])),ref_for:!0,ref:y=>v.value[n.id]=y},[n.is_showtime?(f(),Y(ks,{key:0,log:n,onMore:y=>se(y,n.id)},null,8,["log","onMore"])):(f(),Y(Vs,{key:1,log:n,onMore:y=>se(y,n.id),onTarget:y=>I(n.id)},null,8,["log","onMore","onTarget"]))],42,Zs),n.is_showtime?(f(),Y(qs,{key:0,log:n},null,8,["log"])):(f(),Y(Ps,{key:1,log:n},null,8,["log"]))],512),[[W,!n.is_delete]]),q(i(qe,{class:"chapter log_dragline",onDrop:y=>N(y,n.id),dragging:p.value},null,8,["onDrop","dragging"]),[[W,!n.is_delete]])],64))),128))]),i(Xe,{positions:G.value,onClear:se,onUse:re,onlyAdd:O.value},null,8,["positions","onlyAdd"]),i(is),i(Ye,{open:ie.value,"onUpdate:open":r[5]||(r[5]=n=>ie.value=n),id:K.id,type:K.type,onAdd:l},null,8,["open","id","type"])]),_:1},512))}},go=j(eo,[["__scopeId","data-v-419d5ed1"]]);export{go as default};
