import{_ as j,r as x,e as Q,o as n,c as p,w as v,e5 as ie,a as s,n as _,t as l,e6 as se,d as de,s as P,H as re,f as _e,h as he,g as X,e0 as pe,i as ue,e1 as M,e2 as m,j as Y,b as r,u,F,v as k,e7 as L,e8 as R,d_ as ve,d$ as ge}from"./index-D6QnUoO4.js";import{I as me}from"./round-close-PnnluxDo.js";import{W as fe}from"./Wrap-DLt6HStQ.js";import{C as W,D as Z,u as be}from"./useDrag-C-blWUFZ.js";import{D as ye,M as De,E as we}from"./Dialog-B-nP5hMo.js";import{M as ke}from"./Mark-D-bMOZhA.js";const xe=["disabled"],Se={class:"whitespace-nowrap"},Ce={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(i,{emit:D}){const w=i,U=D,b=x(0);return Q(b,g=>U("update:value",g)),Q(()=>w.value,g=>b.value=g,{immediate:!0}),(g,A)=>(n(),p("label",{class:_(["inline-flex items-center",i.disabled?"cursor-auto":"cursor-pointer"])},[v(s("input",{class:_(["checkbox",i.box]),"onUpdate:modelValue":A[0]||(A[0]=B=>b.value=B),disabled:i.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,xe),[[ie,b.value]]),s("span",Se,l(i.title),1),se(g.$slots,"default",{},void 0,!0)],2))}},ee=j(Ce,[["__scopeId","data-v-b7a95cdd"]]),Ie={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(i){return(D,w)=>(n(),p("button",{class:_(["switch",{"bg-current":i.active}])},[s("span",{class:_(["-mt-0.1em",{"text-white":i.active}])},[se(D.$slots,"default",{},void 0,!0)],2)],2))}},$=j(Ie,[["__scopeId","data-v-8bd1e4e9"]]),f=i=>(ve("data-v-08d713b9"),i=i(),ge(),i),Me={class:"side_list"},Le={class:"flex"},$e=["onClick","title"],Ue={class:"chapter_head"},Ae={class:"mr-9 grid xl:mr-0"},Be=["title"],Ee={class:"chapter_head_number"},Te={class:"chapter_head_desc"},Ne={class:"chapter_log"},Ve={class:"chapter_log_tr -lock"},Pe={class:"mx-2 w-12 self-center"},Fe=f(()=>s("div",{class:"chapter_log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Re=f(()=>s("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),We=f(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"話し手．主人公差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"脇役．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE＆ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),je={key:0,class:"contents"},ze=["draggable","onDragstart","onDragend"],Ge={class:"chapter_log_scene"},He=f(()=>s("div",{class:"chapter_log_switches xl:hidden"},null,-1)),Oe={class:"chapter_log_tr_2"},qe=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Je=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Ke=f(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Qe={class:"chapter_log_td -col"},Xe={class:"-inner"},Ye={key:1,class:"contents"},Ze=["draggable","onDragstart","onDragend"],es={class:"chapter_log_avatar"},ss=["src"],ts={class:"chapter_log_comment"},as={class:"chapter_log_switches"},os={class:"chapter_log_tr_2"},ls={class:"chapter_log_td -col"},cs={key:0,class:"-inner col-span-2"},ns={key:1,class:"-inner col-span-2"},is={class:"-inner"},ds={class:"-inner"},rs={class:"chapter_log_td -col"},_s={class:"-inner col-span-2"},hs={class:"-inner"},ps={class:"-inner"},us={class:"chapter_log_td -col"},vs={class:"-inner"},gs={class:"-inner"},ms={class:"chapter_log_td -col"},fs={class:"-inner"},bs={__name:"Chapters",setup(i){const D=de(),{sidebar:w}=P(D),U=re(),{characterList:b}=P(U),g=_e(),{newChapter:A,dialogType:B}=g,{chapterIndex:E,chapterNames:te,chapterTitle:z,chapterData:h}=P(g),{findData:G,findIndex:ae}=he(),{dragMove:oe,dropMove:le}=be(),T=o=>G(b.value,o.人物,"name")??{},H=X(()=>h.value.some(o=>o.dragging)),N=X(()=>h.value.filter(o=>o.is_selected).map(o=>o.id)),S=(o,t,d)=>{d&&oe(o,{index:t}),N.value.some(c=>h.value[t].id===c)||(h.value[t].is_selected=1),N.value.forEach(c=>{const a=G(h.value,c);a.dragging=d,d||(a.is_selected=0)})},O=(o,t)=>{N.value.forEach(d=>{const e=ae(h.value,d);le(h.value,e,t)})},q=x(!1),C=x(0),J=x(null),I=(o,t)=>{C.value=t,J.value=o,q.value=t===null},ce=({type:o})=>{const t=C.value,d=h.value[t];o==="delete"?d.is_delete=!0:o==="edit"?K(d.id,{}):K("add",{type:o})},V=x(!1),y=pe({id:0,type:"",index:0}),K=(o,{type:t})=>{y.id=o,y.type=t??"",y.index=C.value,V.value=!0},ne=o=>{const t=C.value===null?h.value.length:y.index+1;h.value.splice(t,0,o)};return(o,t)=>{const d=ue("visible");return n(),M(fe,null,{side:m(()=>[s("ul",Me,[(n(!0),p(F,null,Y(u(te),(e,c)=>(n(),p("li",Le,[r(ke,{class:"mt-0.6em bg-current/10",active:c===u(E)},null,8,["active"]),s("button",{class:_(["side_item",{"side_item-active":c===u(E)}]),onClick:a=>E.value=c,title:e},l(e),11,$e)]))),256))])]),main_head:m(()=>[s("header",Ue,[s("div",Ae,[s("h1",{class:"chapter_head_title",title:u(z)},l(u(z)),9,Be),v(s("span",Ee,"01.png",512),[[k,u(w)]])]),v(s("p",Te,"目が覚めたら見知らぬ教室、辺るは水族館のような不思議な光景…自己紹介した後、どこから来た「モノカイ」と自称するぬいぐるみは俺たちをここでコロシアイ学園生活を強いられた。ここから脱出する条件は一つ――誰にばれないように殺人をすることだった。",512),[[k,u(w)]])])]),default:m(()=>[s("div",Ne,[s("div",Ve,[s("div",Pe,[r($,{class:"relative text-primary bg-primary/25"},{default:m(()=>[r(u(me),{class:"mt-0.1em"}),r(W,{class:"absolute left-0 top-0 opacity-0",onMore:t[0]||(t[0]=e=>I(e,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Fe,Re]),We,r(Z,{class:"chapter_log_dragline",onDrop:t[1]||(t[1]=e=>O(e,0)),dragging:H.value},null,8,["dragging"]),(n(!0),p(F,null,Y(u(h),(e,c)=>(n(),p(F,{key:e.id},[e.is_showtime?v((n(),p("section",je,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:a=>S(a,c,!0),onDragend:a=>S(a,c,!1),onDrag:t[2]||(t[2]=L(()=>{},["prevent"])),onDrop:t[3]||(t[3]=L(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[r(ee,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),r(W,{class:"chapter_log_control",onMore:a=>I(a,c),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",Ge,[s("span",null,l(e.人物),1),s("span",null,l(e.show_time),1),s("span",null,l(e.show_name),1)])],2),He],42,ze),s("div",Oe,[qe,Je,Ke,s("div",Qe,[s("div",Xe,l(e.備註),1)])])],512)),[[k,!e.is_delete]]):v((n(),p("section",Ye,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:e.is_drag,onDragstart:a=>S(a,c,!0),onDragend:a=>S(a,c,!1),onDrag:t[4]||(t[4]=L(()=>{},["prevent"])),onDrop:t[5]||(t[5]=L(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[r(ee,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),r(W,{class:"chapter_log_control",onMore:a=>I(a,c),onDel:a=>e.is_delete=!0,hasDel:!1,hasAdd:!1},null,8,["onMore","onDel"]),s("div",{class:_(["chapter_log_info",{"flex-row-reverse":T(e).is_hero,"-replay":e.is_replay}])},[v((n(),p("div",es,[s("img",{src:T(e).image_head},null,8,ss)])),[[d,T(e).image_head]]),s("div",ts,[r(ye,{class:"chapter_log_dialog",value:e.和訳,type:u(B)(e)},null,8,["value","type"])])],2)],2),s("div",as,[v((n(),M($,{class:_(["chapter_log_switch",{"text-replay":e.is_replay}]),active:e.is_replay,title:"再放送"},{default:m(()=>[R("R")]),_:2},1032,["active","class"])),[[d,e.is_replay]]),v((n(),M($,{class:_(["chapter_log_switch",{"text-unknown":e.is_unknown}]),active:e.is_unknown,title:"未紹介"},{default:m(()=>[R("U")]),_:2},1032,["active","class"])),[[d,e.is_unknown]]),v((n(),M($,{class:_(["chapter_log_switch",{"-monolog":e.is_solo}]),active:e.is_solo,title:"独り言"},{default:m(()=>[R("S")]),_:2},1032,["active","class"])),[[d,e.is_solo]])])],42,Ze),s("div",os,[s("div",ls,[e.is_announce||e.is_system?(n(),p("div",cs,l(e.人物),1)):(n(),p("div",ns,l(e.人物),1)),s("div",is,l(e.十六夜差分),1),s("div",ds,l(e.主角特效),1)]),s("div",rs,[s("div",_s,l(e.顯示角色),1),s("div",hs,l(e.角色差分),1),s("div",ps,l(e.差分特效),1)]),s("div",us,[s("div",vs,l(e.SE),1),s("div",gs,l(e.Voice),1)]),s("div",ms,[s("div",fs,l(e.備註),1)])])],512)),[[k,!e.is_delete]]),v(r(Z,{class:"chapter_log_dragline",onDrop:a=>O(a,c+1),dragging:H.value},null,8,["onDrop","dragging"]),[[k,!e.is_delete]])],64))),128))]),r(De,{positions:J.value,onClear:I,onUse:ce,onlyAdd:q.value},null,8,["positions","onlyAdd"]),r(we,{open:V.value,"onUpdate:open":t[6]||(t[6]=e=>V.value=e),id:y.id,type:y.type,onAdd:ne},null,8,["open","id","type"])]),_:1})}}},Cs=j(bs,[["__scopeId","data-v-08d713b9"]]);export{Cs as default};
