import{_ as H,j,r as I,g as O,i as G,w as h,o as k,c as $,a as t,n as B,h as z,F as R,k as A,t as V,v as U,e as E,ea as F,eb as K,u as b,ec as W,e5 as Z,e8 as ee,ed as te,J as se,s as N,f as oe,b as m,d$ as le,e0 as ae,d as ne}from"./index-vgp2cxHb.js";import{a as ie}from"./round-close-B-BAJ8Jd.js";const ue={class:"menu_list"},ce={class:"contents"},pe=["onClick"],de={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(l,{emit:f}){const d=l,r=f,{getClientRect:c}=j(),a=I(null),i=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],p=O(()=>{const{width:e,height:x}=c(document.documentElement),{width:g,height:y}=c(a.value),{x:C,y:D,width:M,height:u}=d.positions??{},s=(D??0)+(u??0)/2-(y??0)/2,S=(s<20?20:s)+"px",o=(x??0)-(y??0)-20+"px",q=`min(${S}, ${o})`,J=(C??0)+(g??0)>e,Q=(C??0)+(M??0)+2,X=(C??0)-(g??0)-9-2,Y=(J?X:Q)+"px";return{top:q,left:Y}}),v=O(()=>{const{width:e}=c(document.documentElement),{width:x}=c(a.value),{x:g,y,width:C,height:D}=d.positions??{},M=(y??0)+(D??0)/2,u=(g??0)+(x??0)>e,s=(g??0)+(C??0)+3,S=(g??0)-3.2,o=u?S:s;return{top:M+"px",left:o+"px",turn:u}}),n=e=>{e.target.matches(".menu, .menu *")||r("clear",null)},w=e=>{r("use",{type:e}),r("clear",null)};return(e,x)=>{const g=G("visible");return h((k(),$("div",{class:"menu_container",onClick:n},[t("div",{class:B(["menu_triangle",{"-scale-x-100":v.value.turn}]),style:z(v.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:z(p.value),ref_key:"menu",ref:a},[t("ul",ue,[(k(),$(R,null,A(i,y=>t("li",ce,[h(t("button",{class:B(["menu_item",y.class]),onClick:C=>w(y.type)},V(y.title),11,pe),[[U,!(["edit","delete"].includes(y.type)&&l.onlyAdd)]])])),64))])],4)])),[[g,l.positions]])}}},it=H(de,[["__scopeId","data-v-dfb3886d"]]),re=["disabled","placeholder"],T={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){const d=l,r=f,c=I("");return E(c,a=>r("update:value",a)),E(()=>d.value,a=>c.value=a,{immediate:!0}),(a,i)=>{const p=G("verify");return h((k(),$("input",{"onUpdate:modelValue":i[0]||(i[0]=v=>c.value=v),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},null,8,re)),[[F,c.value,void 0,{lazy:!0,trim:!0}],[p,void 0,void 0,{check:!0}]])}}},ve=["disabled","placeholder"],_e=["value"],me={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:f}){K(i=>({"4ad1a84a":b(c).light.text}));const d=l,r=f,{colors:c}=W(),a=I("");return E(a,i=>r("update:value",i)),E(()=>d.value,i=>a.value=i,{immediate:!0}),(i,p)=>{const v=G("verify");return h((k(),$("select",{class:"select","onUpdate:modelValue":p[0]||(p[0]=n=>a.value=n),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},[ee(i.$slots,"default",{},void 0,!0),(k(!0),$(R,null,A(l.options,n=>h((k(),$("option",{value:n.id??n},V(n.title??n.id??n),9,_e)),[[U,n.show??!0]])),256))],8,ve)),[[Z,a.value,void 0,{lazy:!0,trim:!0}],[v,void 0,void 0,{check:!0}]])}}},L=H(me,[["__scopeId","data-v-1b98bee5"]]),he=["disabled","placeholder"],P={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(l,{emit:f}){const d=l,r=f,c=I(null),a=I(""),i=p=>{if(!p.ctrlKey)return;const{selectionStart:v,selectionEnd:n}=c.value;r("selected",{start:v,end:n})};return E(a,p=>r("update:value",p)),E(()=>d.value,p=>a.value=p,{immediate:!0}),(p,v)=>{const n=G("verify");return h((k(),$("textarea",{class:"scrollbar min-h-0 resize-none","onUpdate:modelValue":v[0]||(v[0]=w=>a.value=w),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder,onKeydown:te(i,["q"]),ref_key:"textarea",ref:c},null,40,he)),[[F,a.value,void 0,{lazy:!0,trim:!0}],[n,void 0,void 0,{check:!0}]])}}},_=l=>(le("data-v-9f0232e7"),l=l(),ae(),l),fe={class:"popup_window"},ye={class:"popup_header"},ge={class:"popup_close",title:"キャンセル"},we={class:"popup_container scrollbar"},be={class:"contents"},xe={class:"contents"},Se={class:"popup_label"},ke=_(()=>t("div",{class:"-col-2"},null,-1)),$e={class:"contents"},Ce=_(()=>t("span",{class:"popup_label"},"内容",-1)),Ue={class:"contents"},Te={class:"contents"},Be=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Ee={class:"popup_input"},Ie={class:"contents"},De=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Me=_(()=>t("div",{class:"-col-2"},null,-1)),Oe={class:"contents"},Ge=_(()=>t("span",{class:"popup_label"},"主人公差分",-1)),Le={class:"contents"},Ve=_(()=>t("span",{class:"popup_label"},"主人公エフェクト",-1)),He={class:"contents"},Ne=_(()=>t("span",{class:"popup_label"},"脇役",-1)),ze={class:"contents"},Pe=_(()=>t("span",{class:"popup_label"},"脇役差分",-1)),je={class:"contents"},Re=_(()=>t("span",{class:"popup_label"},"脇役エフェクト",-1)),Ae={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},Fe={class:"contents"},Ke=_(()=>t("span",{class:"popup_label"},"セリフ",-1)),We={class:"-col-3 grid gap-1"},qe=_(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Je={class:"contents"},Qe=_(()=>t("span",{class:"popup_label"},"SE",-1)),Xe={class:"contents"},Ye=_(()=>t("span",{class:"popup_label"},"ボイス",-1)),Ze={class:"contents"},et=_(()=>t("span",{class:"popup_label"},"備考",-1)),tt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(l,{emit:f}){const d=l,r=f,c=se(),{characterList:a}=N(c),i=oe(),{newChapter:p}=i,{chapterData:v}=N(i),{isDev:n,findData:w}=j(),e=I({}),x=O(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform},{id:"動畫",show:e.value.is_perform}]),g=[{id:"",title:"全"},{id:"前"},{id:"後"},{id:"續"}],y=O(()=>a.value.map(u=>({id:u.name,is_hero:u.is_hero}))),C=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},D=()=>{const u={...e.value};if(d.id==="add")r("add",u);else{const S=w(v.value,d.id);Object.assign(S,u)}r("update:open",!1),(!u.is_showtime||u.show_time==="暗場")&&r("target",u.id)},M=u=>{const s=u.target.matches(".popup_window, .popup_window *"),S=u.target.matches(".popup_close");(!s||S)&&r("update:open",!1)};return E(()=>d.open,u=>{u&&(d.id==="add"?e.value=p(d.type):e.value={...w(v.value,d.id)},n&&console.log({...e.value}))}),(u,s)=>{const S=G("visible");return h((k(),$("div",{class:"popup",onClick:M},[t("section",fe,[t("header",ye,[t("button",ge,[m(b(ie),{class:"pointer-events-none"})])]),t("div",we,[h(t("div",be,[t("div",xe,[t("span",Se,V(e.value.人物),1),m(L,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:x.value,onChange:C},null,8,["value","options"])]),ke,t("div",$e,[Ce,h(m(T,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[U,e.value.show_time!=="暗場"]]),h(m(L,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:g},null,8,["value"]),[[U,e.value.show_time==="暗場"]])])],512),[[U,e.value.is_showtime]]),h(t("div",Ue,[h(t("div",Te,[Be,t("span",Ee,V(e.value.人物),1)],512),[[U,e.value.is_announce||e.value.is_system]]),h(t("div",Ie,[De,m(L,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:y.value},null,8,["value","options"])],512),[[U,!(e.value.is_announce||e.value.is_system)]]),Me,t("div",Oe,[Ge,m(T,{class:"popup_input",value:e.value.十六夜差分,"onUpdate:value":s[4]||(s[4]=o=>e.value.十六夜差分=o)},null,8,["value"])]),t("div",Le,[Ve,m(T,{class:"popup_input",value:e.value.主角特效,"onUpdate:value":s[5]||(s[5]=o=>e.value.主角特效=o)},null,8,["value"])]),t("div",He,[Ne,m(L,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[6]||(s[6]=o=>e.value.顯示角色=o),options:y.value},null,8,["value","options"])]),t("div",ze,[Pe,m(T,{class:"popup_input",value:e.value.角色差分,"onUpdate:value":s[7]||(s[7]=o=>e.value.角色差分=o)},null,8,["value"])]),t("div",je,[Re,m(T,{class:"popup_input",value:e.value.差分特效,"onUpdate:value":s[8]||(s[8]=o=>e.value.差分特效=o)},null,8,["value"])]),t("div",Ae,[t("button",{class:B(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[9]||(s[9]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:B(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[10]||(s[10]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未紹介"},"未紹介",2),t("button",{class:B(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[11]||(s[11]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",Fe,[Ke,t("div",We,[m(P,{class:"popup_input h-24",value:e.value.和訳,"onUpdate:value":s[12]||(s[12]=o=>e.value.和訳=o)},null,8,["value"]),qe])]),t("div",Je,[Qe,m(T,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[13]||(s[13]=o=>e.value.SE=o)},null,8,["value"])]),t("div",Xe,[Ye,m(T,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[14]||(s[14]=o=>e.value.Voice=o)},null,8,["value"])])],512),[[U,!e.value.is_showtime]]),t("div",Ze,[et,m(P,{class:"popup_input -col-3 h-24",value:e.value.備註,"onUpdate:value":s[15]||(s[15]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:D,title:"セーフ"},"セーフ")])])])),[[S,l.open]])}}},ut=H(tt,[["__scopeId","data-v-9f0232e7"]]),st={class:"dialog_wrap"},ot=["data-content","innerHTML"],lt={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(l){K(n=>({"35896f63":b(a).lineHeight,"4d5ca058":b(a).letterSpace,"15be853d":b(a).fontLength,f66c4386:b(i).keyword.dark,"729921a5":b(i).monolog.dark,"0085a039":b(i).announce.dark}));const f=l,d=ne(),{fontFamily:r,fontWeight:c,fontStyle:a}=N(d),{colors:i}=W(),p=O(()=>{const n=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),w=v("keyword"),x=f.value.replace(n,`<span class="${w}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:f.value.replace(/\[|\]/g,""),html:x}}),v=n=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[n]??"text-white";return(n,w)=>(k(),$("div",{class:B(["dialog",[b(r).dialog,b(c).dialog]])},[t("div",st,[t("pre",{class:B(v(l.type)),"data-content":p.value.value,innerHTML:p.value.html},null,10,ot)])],2))}},ct=H(lt,[["__scopeId","data-v-0b46230a"]]);export{ct as D,ut as E,it as M};
