import{o as u,d as _,e as s,_ as B,B as S,r as w,C as F,m as b,h as f,f as k,c as O,D as M,n as I,E as U,G as N,s as R,w as H,F as V,j,y as C,z as A,A as P}from"./index-avX1HNBg.js";import{H as J}from"./Header-_ZJGL_p2.js";const G={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},X=s("path",{fill:"currentColor",d:"m12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72l3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41l-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08z"},null,-1),q=[X];function K(l,d){return u(),_("svg",G,[...q])}const Q={name:"ic-round-star",render:K},W={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Y=s("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2"},null,-1),Z=[Y];function ee(l,d){return u(),_("svg",W,[...Z])}const E={name:"ic-round-plus",render:ee},te={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},se=s("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),ne=[se];function oe(l,d){return u(),_("svg",te,[...ne])}const ae={name:"ic-round-close",render:oe},le={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ie=s("path",{fill:"currentColor",d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2s.9-2 2-2s2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2"},null,-1),de=[ie];function re(l,d){return u(),_("svg",le,[...de])}const ce={name:"ic-round-drag-indicator",render:re},ue={__name:"Control",props:{hasAdd:{type:[Boolean],default:!0},hasDel:{type:[Boolean],default:!0}},emits:["add","del","more"],setup(l,{emit:d}){const i=d,{getRectValue:g}=S(),r=w(null),m=n=>{const t=g(r.value);i(n,t)};return(n,t)=>{const a=F("visible");return u(),_("div",{class:"grid content-center justify-items-center gap-2 text-2xl",ref_key:"control",ref:r},[b((u(),_("button",{class:"control_button",onClick:t[0]||(t[0]=c=>m("add"))},[f(k(E))])),[[a,l.hasAdd]]),s("button",{class:"control_button",onClick:t[1]||(t[1]=c=>m("more"))},[f(k(ce))]),b((u(),_("button",{class:"control_button scale-90",onClick:t[2]||(t[2]=c=>m("del"))},[f(k(ae))])),[[a,l.hasDel]])],512)}}},_e=B(ue,[["__scopeId","data-v-659373ab"]]),ge={__name:"Menu",props:{positions:{type:[Object],default:null}},emits:["clear"],setup(l,{emit:d}){const i=l,g=d,{getRectValue:r}=S(),m=w(null),n=O(()=>{const{height:a}=r(document.documentElement),{height:c}=r(m.value),{x:$,y:h,height:L}=i.positions??{},v=(h??0)+(L??0)/2-(c??0)/2,p=(v<20?20:v)+"px",x=(a??0)-(c??0)-20+"px",e=`min(${p}, ${x})`,y=$+"px";return{top:e,left:y}}),t=a=>{a.target.matches(".menu, .menu *")||g("clear",null)};return(a,c)=>{const $=F("visible");return b((u(),_("div",{class:"fixed inset-0 z-50 h-screen w-screen",onClick:t},[s("div",{class:"menu",style:M(n.value),ref_key:"menu",ref:m},null,4)])),[[$,l.positions]])}}},pe=B(ge,[["__scopeId","data-v-1eb146a0"]]);function me(){const{findData:l}=S(),d=(n,t)=>{const a=t.replace(/\s/g,"").toLowerCase().split(","),c=n.name.slice(n.name.lastIndexOf(".")).toLowerCase();return t!==""?a.includes(c):!0},i=n=>n instanceof Blob;return{isFileType:d,isBlobFile:i,blobUrl:(n,t)=>{const a=c=>c.slice(-1)==="/"?"":c;return i(n)?URL.createObjectURL(n):a(t??"")},getFileName:n=>{var a;n=n??"";const t=(a=n.lastIndexOf)==null?void 0:a.call(n,"/");return i(n)||t===-1?n:n.slice(t).slice(1)},getFilesData:(n,t)=>{const a=t.filter(h=>!h.id),c=n.filter(h=>!l(t,h.id)).map(h=>h.name),$=n.filter(h=>l(t,h.id));return{addList:a,delList:c,resultList:$}}}}const ve={class:"upload"},fe={class:"upload_input"},he={class:"upload_image"},be=["src"],$e={__name:"Upload",props:{value:{type:[String],default:""},type:{type:[String],default:"contain"}},emits:["update:value"],setup(l,{emit:d}){const{blobUrl:i}=me(),g=d,r=n=>{const t=n.target.files[0],a=i(t,"");g("update:value",a)},m=()=>g("update:value","");return(n,t)=>{const a=F("visible");return u(),_("div",ve,[b((u(),_("label",fe,[f(k(E)),s("input",{class:"hidden",onChange:r,type:"file",accept:"image/*"},null,32)])),[[a,!l.value]]),b((u(),_("div",he,[s("img",{class:I(["h-full w-full",l.type==="cover"?"object-cover":"object-contain"]),src:l.value},null,10,be),s("button",{class:"upload_remove",onClick:m},[f(k(E),{class:"rotate-45"})])])),[[a,l.value]])])}}},z=B($e,[["__scopeId","data-v-36f67343"]]),xe={__name:"DropLine",emits:["drop"],setup(l,{emit:d}){const i=d,g=w(null),r=n=>{g.value.style.setProperty("opacity",n?1:0)},m=n=>{const t=n.dataTransfer.getData("text/plain");let a=null;try{a=JSON.parse(t)}catch{}r(!1),a!==null&&i("drop",a)};return(n,t)=>(u(),_("div",{class:"drag_line",onDragenter:t[0]||(t[0]=U(a=>r(!0),["prevent"])),onDragleave:t[1]||(t[1]=U(a=>r(!1),["prevent"])),onDragover:t[2]||(t[2]=U(()=>{},["prevent"])),onDrop:m,ref_key:"line",ref:g},null,544))}},T=B(xe,[["__scopeId","data-v-5a6107b9"]]),ye="/RonpaEditor-DEMO/assets/headshot_1-CxnizMm5.png",ke="/RonpaEditor-DEMO/assets/headshot_2-xVBmaB3M.png",De="/RonpaEditor-DEMO/assets/nametag_1-gPs7u1zN.png",Ce="/RonpaEditor-DEMO/assets/nametag_2-UDMsHms1.png",we=N("character",()=>{const l=w([{id:0,name:"？？？？",katakana:"？？？？",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",unknown:!0,is_drag:!0,dragging:!1},{id:1,name:"十六夜魔除",katakana:"イザヨイマヨ",name_bg:"#a64d79",name_text:"#ffff00",image_head:ye,image_name:De,is_hero:!0,is_drag:!0,dragging:!1},{id:2,name:"観月星知",katakana:"カンゲツセシル",name_bg:"#674ea7",name_text:"#d4c1a6",image_head:ke,image_name:Ce,is_hero:!1,is_drag:!0,dragging:!1}]),d=w({name:"",katakana:"",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",is_hero:!1,is_drag:!0});return{characterList:l,characterNew:d}});function Ue(){return{dragMove:(i,g)=>{i.dataTransfer.dropEffect="move",i.dataTransfer.setData("text/plain",JSON.stringify(g))},dropMove:(i,g,r)=>{const[m]=i.splice(g,1),n=g>=r?r:r-1,t=n<0?0:n;i.splice(t,0,m)}}}const D=l=>(A("data-v-60370857"),l=l(),P(),l),Be={class:"setting_wrap"},Le=D(()=>s("div",null,null,-1)),Me=D(()=>s("div",{class:"setting_head"},[s("h2",{class:"setting_title"},"アイコン"),s("p",{class:"setting_desc"},"ゲーム内表示"),s("p",{class:"setting_desc highlight"},"★ = 主人公")],-1)),Fe=D(()=>s("div",{class:"setting_head col-span-2"},[s("h2",{class:"setting_title"},"お名前"),s("p",{class:"setting_desc"},"EXCEL内表示")],-1)),Ve=D(()=>s("div",{class:"setting_head"},[s("h2",{class:"setting_title"},"名札"),s("p",{class:"setting_desc"},"ゲーム内表示"),s("p",{class:"setting_desc"},"（画像のない場合はカタカナ表示になります）")],-1)),Ie=["draggable","onDragstart","onDragend"],Ee={key:0,class:"setting_avatar setting_unknown"},Se={key:1,class:"setting_avatar"},ze=["onClick"],Te={class:"setting_detail",draggable:"false"},Oe=["onUpdate:modelValue","onFocus","onBlur"],Ne={class:"setting_col"},Re=D(()=>s("p",{class:"ml-0.5"},"名前の色",-1)),He=["onUpdate:modelValue","onFocus","onBlur"],je=["onUpdate:modelValue"],Ae={class:"setting_detail"},Pe=["onUpdate:modelValue","onFocus","onBlur"],Je={class:"setting_col"},Ge=D(()=>s("p",{class:"ml-0.5"},"名前の背景色",-1)),Xe=["onUpdate:modelValue","onFocus","onBlur"],qe=["onUpdate:modelValue"],Ke=D(()=>s("div",{class:"col-span-5 mb-4"},null,-1)),Qe={__name:"Character",setup(l){const d=we(),{characterList:i,characterNew:g}=R(d),{dragMove:r,dropMove:m}=Ue(),n=O(()=>i.value.some(v=>v.is_hero)),t=v=>{const p={...g.value},x=[...i.value].sort((e,y)=>y.id-e.id)[0];p.id=x?x.id+1:0,i.value.splice(v+1,0,p)},a=v=>i.value.splice(v,1),c=(v,p,x)=>{x&&r(v,{index:p}),i.value[p].dragging=x},$=(v,p)=>m(i.value,v.index,p),h=w(null),L=v=>{h.value=v};return(v,p)=>{const x=F("visible");return u(),_(V,null,[f(pe,{positions:h.value,onClear:L},null,8,["positions"]),s("div",Be,[f(J,{col:"col-span-5"},{default:H(()=>[Le,Me,Fe,Ve]),_:1}),f(T,{class:"col-span-5",onDrop:p[0]||(p[0]=e=>$(e,0))}),(u(!0),_(V,null,j(k(i),(e,y)=>(u(),_(V,{key:e.id},[s("div",{class:I(["setting_container",{"!bg-secondary/30":e.dragging}]),draggable:e.is_drag,onDragstart:o=>c(o,y,!0),onDragend:o=>c(o,y,!1),onDrag:p[1]||(p[1]=U(()=>{},["prevent"])),onDrop:p[2]||(p[2]=U(()=>{},["prevent"]))},[f(_e,{class:"row-span-2 -mr-6",hasDel:!e.unknown,onAdd:o=>t(y),onDel:o=>a(y),onMore:L},null,8,["hasDel","onAdd","onDel"]),e.unknown?(u(),_("div",Ee)):(u(),_("div",Se,[f(z,{class:"h-full w-full",value:e.image_head,"onUpdate:value":o=>e.image_head=o,type:"cover"},null,8,["value","onUpdate:value"]),b((u(),_("button",{class:I(["setting_star",{"setting_star-active":e.is_hero}]),onClick:o=>e.is_hero=!e.is_hero},[f(k(Q))],10,ze)),[[x,!(n.value&&!e.is_hero)]])])),s("div",Te,[b(s("input",{class:"setting_name last","onUpdate:modelValue":o=>e.name=o,style:M({"--name-bg":e.name_bg,"--name-text":e.name_text}),onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,44,Oe),[[C,e.name,void 0,{lazy:!0,trim:!0}]]),s("div",Ne,[Re,b(s("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_text=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,He),[[C,e.name_text,void 0,{lazy:!0,trim:!0}]]),s("label",{class:"setting_color",style:M({"background-color":e.name_text})},[b(s("input",{class:"hidden","onUpdate:modelValue":o=>e.name_text=o,type:"color"},null,8,je),[[C,e.name_text,void 0,{lazy:!0}]])],4)])]),s("div",Ae,[b(s("input",{class:"setting_name first","onUpdate:modelValue":o=>e.katakana=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,Pe),[[C,e.katakana,void 0,{lazy:!0,trim:!0}]]),s("div",Je,[Ge,b(s("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_bg=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,Xe),[[C,e.name_bg,void 0,{lazy:!0,trim:!0}]]),s("label",{class:"setting_color",style:M({"background-color":e.name_bg})},[b(s("input",{class:"hidden","onUpdate:modelValue":o=>e.name_bg=o,type:"color"},null,8,qe),[[C,e.name_bg,void 0,{lazy:!0}]])],4)])]),f(z,{class:"setting_nametag",value:e.image_name,"onUpdate:value":o=>e.image_name=o},null,8,["value","onUpdate:value"])],42,Ie),f(T,{class:"col-span-5",onDrop:o=>$(o,y+1)},null,8,["onDrop"])],64))),128)),Ke])],64)}}},Ze=B(Qe,[["__scopeId","data-v-60370857"]]);export{Ze as default};
