import{_ as G,o as s,c as r,a as f,u as ie,b as q,i as ce,F as E,t as D,d as e,e as g,w as $,v as U,n as H,f as W,s as B,r as M,g as k,h as x,j as ke,k as ue,l as Se,m as z,p as O,q as R,x as ze,y as K,z as ye,A as Ve,B as Pe,C as Ae,D as A,E as ne,G as le,H as He,I as je}from"./index-DMmDw4WN.js";import{I as be,a as Oe,D as Re}from"./IconDelete-BJudkFbd.js";import{u as Y,M as Fe,I as Ge,E as qe}from"./EditPopup-DcTy2oLv.js";import{D as We,S as Ke}from"./Dialog-DMDw_zAC.js";import{W as Je}from"./Wrap-v1FCeDCU.js";import{A as Qe}from"./Aspect-CgpkCsZf.js";import{I as we,S as Xe,U as Ye}from"./UiItem-DFHlskIF.js";import{R as Ze}from"./Range-bLdG_CQ1.js";import{_ as re}from"./Audio-C2EovodT.js";import{_ as X}from"./Image-DQcPrY4W.js";import{u as et}from"./useMouse-Uiw0LC_s.js";/* empty css                                                             */const tt={name:"RiShiningFill"},at={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},nt=f("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10z"},null,-1),st=[nt];function ot(t,c,a,d,h,_){return s(),r("svg",at,st)}const lt=G(tt,[["render",ot]]),it={name:"RiShiningLine"},ct={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},ut=f("path",{fill:"currentColor",d:"M1 11c5.523 0 10-4.477 10-10h2c0 5.523 4.477 10 10 10v2c-5.523 0-10 4.477-10 10h-2c0-5.523-4.477-10-10-10zm4.803 1A12.044 12.044 0 0 1 12 18.197A12.043 12.043 0 0 1 18.197 12A12.044 12.044 0 0 1 12 5.803A12.044 12.044 0 0 1 5.803 12"},null,-1),rt=[ut];function dt(t,c,a,d,h,_){return s(),r("svg",ct,rt)}const pt=G(it,[["render",dt]]),mt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},vt=f("path",{fill:"currentColor",d:"M14 6H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1m0 4H4c-.55 0-1 .45-1 1s.45 1 1 1h10c.55 0 1-.45 1-1s-.45-1-1-1M4 16h6c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1M19 6c-1.1 0-2 .9-2 2v6.18c-.31-.11-.65-.18-1-.18c-1.84 0-3.28 1.64-2.95 3.54c.21 1.21 1.2 2.2 2.41 2.41c1.9.33 3.54-1.11 3.54-2.95V8h2c.55 0 1-.45 1-1s-.45-1-1-1z"},null,-1),_t=[vt];function gt(t,c){return s(),r("svg",mt,[..._t])}const ft={name:"ic-round-queue-music",render:gt},ht={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},yt=f("path",{fill:"currentColor",d:"M12 15c1.66 0 2.99-1.34 2.99-3L15 6c0-1.66-1.34-3-3-3S9 4.34 9 6v6c0 1.66 1.34 3 3 3m5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 15 6.7 12H5c0 3.42 2.72 6.23 6 6.72V22h2v-3.28c3.28-.48 6-3.3 6-6.72z"},null,-1),bt=[yt];function wt(t,c){return s(),r("svg",ht,[...bt])}const $t={name:"ic-sharp-keyboard-voice",render:wt},xt={class:"contents"},kt={class:"preview_log_head"},St={class:"preview_log_title"},Bt={class:"preview_log_subtitle !text-base"},Ct={class:"preview_log_content"},It={class:"preview_log_foot"},Nt=["title"],Lt=["title"],Tt={class:"preview_log_head"},Et={key:0,class:"shrink-0 font-medium"},Dt={key:1,class:"shrink-0 font-medium"},Ut={key:2,class:"shrink-0 font-medium"},Mt={class:"preview_log_subtitle text-xs leading-none"},zt={class:"h-1em"},Vt={class:"h-1em"},Pt={class:"preview_log_content"},At={class:"preview_log_foot"},Ht={class:"preview_log_mark_1"},jt={class:"preview_log_mark_1"},Ot={class:"preview_log_mark_1"},Rt=["title"],Ft=["title"],Gt={__name:"LogItem",props:{id:{type:[Number,String],default:0},log:{type:[Object],default:()=>({})}},emits:["update:id","edit","delete","stop"],setup(t,{emit:c}){const a=c,d=ie(),{getCharacter:h,getSprite:_}=d,w=q(),{getShowName:y}=w,{t:l}=ce("lang");return(m,o)=>(s(),r("article",{class:H(["preview_log",{"-active":t.log.id===t.id}])},[t.log.is_showtime?(s(),r(E,{key:0},[f("div",xt,[f("header",kt,[f("h6",St,D(e(l)(`showtime.${t.log.speaker}`)),1),f("p",Bt,D(e(l)(`showtime.${t.log.show_time}`)),1)]),f("p",Ct,D(e(y)(t.log.show_time,t.log.show_name)),1)]),f("footer",It,[f("button",{class:"preview_button ml-auto",onClick:o[0]||(o[0]=n=>a("edit")),title:e(l)("button.edit")},[g(we,{class:"text-[0.9em]"})],8,Nt),f("button",{class:"preview_button ml-1",onClick:o[1]||(o[1]=n=>a("delete")),title:e(l)("button.del")},[g(be,{class:"text-[0.9em]"})],8,Lt)])],64)):(s(),r(E,{key:1},[f("button",{class:"group contents",onClick:o[2]||(o[2]=n=>{a("update:id",t.log.id),a("stop")})},[f("header",Tt,[t.log.is_announce?(s(),r("h6",Et,D(e(l)("showtime.announce")),1)):t.log.is_system?(s(),r("h6",Dt,D(e(l)("showtime.system")),1)):(s(),r("h6",Ut,D(e(h)(t.log.speaker).name),1)),f("p",Mt,[f("span",zt,D(e(h)(t.log.char_1).name)+" / "+D(e(_)(t.log.char_1,t.log.char_1_sprite).name),1),f("span",Vt,D(e(h)(t.log.char_2).name)+" / "+D(e(_)(t.log.char_2,t.log.char_2_sprite).name),1)])]),f("p",Pt,D(t.log.content),1)]),f("footer",At,[$(f("span",Ht,"R",512),[[U,t.log.is_replay]]),$(f("span",jt,"U",512),[[U,t.log.is_unknown]]),$(f("span",Ot,"S",512),[[U,t.log.is_monolog]]),$(g(lt,{class:"preview_log_mark_2"},null,512),[[U,t.log.char_1_effect!==""]]),$(g(pt,{class:"preview_log_mark_2"},null,512),[[U,t.log.char_2_effect!==""]]),$(g(e(ft),{class:"preview_log_mark_2"},null,512),[[U,t.log.se!==""]]),$(g(e($t),{class:"preview_log_mark_2"},null,512),[[U,t.log.voice!==""]]),f("button",{class:"preview_button ml-auto",onClick:o[3]||(o[3]=n=>a("edit")),title:e(l)("button.edit")},[g(we,{class:"text-[0.9em]"})],8,Rt),f("button",{class:"preview_button ml-1",onClick:o[4]||(o[4]=n=>a("delete")),title:e(l)("button.del")},[g(be,{class:"text-[0.9em]"})],8,Ft)])],64))],2))}},qt=G(Gt,[["__scopeId","data-v-a0a2b57c"]]),Wt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Kt=f("path",{fill:"currentColor",d:"M6 6h12v12H6z"},null,-1),Jt=[Kt];function Qt(t,c){return s(),r("svg",Wt,[...Jt])}const Xt={name:"ic-baseline-stop",render:Qt},Yt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Zt=f("path",{fill:"currentColor",d:"M8 5v14l11-7z"},null,-1),ea=[Zt];function ta(t,c){return s(),r("svg",Yt,[...ea])}const aa={name:"ic-baseline-play-arrow",render:ta},na={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},sa=f("path",{fill:"currentColor",d:"M6 6h2v12H6zm3.5 6l8.5 6V6z"},null,-1),oa=[sa];function la(t,c){return s(),r("svg",na,[...oa])}const $e={name:"ic-baseline-skip-previous",render:la},ia={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ca=f("path",{fill:"currentColor",d:"M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"},null,-1),ua=[ca];function ra(t,c){return s(),r("svg",ia,[...ua])}const da={name:"ic-baseline-fullscreen",render:ra},pa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ma=f("path",{fill:"currentColor",d:"M5 16h3v3h2v-5H5zm3-8H5v2h5V5H8zm6 11h2v-3h3v-2h-5zm2-11V5h-2v5h5V8z"},null,-1),va=[ma];function _a(t,c){return s(),r("svg",pa,[...va])}const ga={name:"ic-baseline-fullscreen-exit",render:_a},fa={class:"control_outer group"},ha={class:"control"},ya=["disabled","title"],ba=["title"],wa=["disabled","title"],$a=["title"],xa={__name:"Control",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1},voicing:{type:[Boolean],default:!1},animating:{type:[Boolean],default:!1}},emits:["update:index","update:play","target","stop"],setup(t,{emit:c}){const a=t,d=c,h=W(),{fullscreen:_,fontIntervals:w}=B(h),{t:y}=ce("lang"),l=M(0);k(l,n=>d("update:index",n)),k(()=>a.index,n=>l.value=n,{immediate:!0});const m=x(()=>a.play&&!a.black&&!a.voicing&&!a.typing&&!a.animating),o=()=>{const n=l.value;m&&setTimeout(()=>{const u=l.value>=a.length&&!a.black;a.index===n&&m.value&&!u&&(l.value+=1),u&&d("update:play",!1),o()},w.value.sentence)};return k(()=>a.play,o),k(()=>a.typing,o),k(()=>a.voicing,o),k(()=>a.animating,o),(n,u)=>(s(),r("div",fa,[f("div",ha,[f("button",{class:"preview_button",onClick:u[0]||(u[0]=p=>{l.value-=1,d("stop")}),disabled:l.value===0,title:e(y)("button.prev")},[g(e($e))],8,ya),f("button",{class:"preview_button",onClick:u[1]||(u[1]=p=>d("update:play",!t.play)),title:t.play?e(y)("button.stop"):e(y)("button.play")},[$(g(e(aa),null,null,512),[[U,!t.play]]),$(g(e(Xt),null,null,512),[[U,t.play]])],8,ba),f("button",{class:"preview_button",onClick:u[2]||(u[2]=p=>{l.value+=1,d("stop")}),disabled:l.value===t.length,title:e(y)("button.next")},[g(e($e),{class:"-scale-x-100"})],8,wa),g(Ze,{class:"mx-3 grow !bg-dark-text",value:l.value,"onUpdate:value":u[3]||(u[3]=p=>l.value=p),onChange:u[4]||(u[4]=p=>d("stop")),min:0,max:t.length,step:1,button:!1},null,8,["value","max"]),f("button",{class:"preview_button",onClick:u[5]||(u[5]=p=>_.value=!e(_)),title:e(y)("button.full-screen")},[$(g(e(da),null,null,512),[[U,!e(_)]]),$(g(e(ga),null,null,512),[[U,e(_)]])],8,$a)])]))}},ka=G(xa,[["__scopeId","data-v-16013f67"]]),Sa={__name:"Comment",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},typing:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:typing"],setup(t,{emit:c}){const a=t,d=c,h=W(),{fontIntervals:_}=B(h),w=ke(),{dialogType:y}=w,{getDialogStyle:l}=ue(),m=M({}),o=M(0),n=x(()=>m.value.content??""),u=x(()=>a.play?n.value.slice(0,o.value):n.value),p=x(()=>l(a.ui)),S=()=>{n.value&&(d("update:typing",!0),o.value=0)},b=()=>{if(!a.play||a.black)return;if(o.value===n.value.length)return d("update:typing",!1);setTimeout(()=>{a.typing?o.value+=1:o.value=n.value.length},_.value.word)};return k(()=>a.data,C=>{C.is_showtime||(m.value=C)}),k(m,S),k(n,b),k(u,b),k(o,b),k(()=>a.black,C=>{C||b()}),(C,L)=>(s(),r("article",{class:"preview_dialog",style:Se(p.value)},[g(We,{value:u.value,type:e(y)(t.data)},null,8,["value","type"])],4))}},Ba=G(Sa,[["__scopeId","data-v-ddd01d48"]]),Ca={class:"invisible",id:"Bgm"},Ia={__name:"BGM",props:{contents:{type:[Array],default:()=>[]},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1}},setup(t){const c=t,a=W(),{audioVolume:d}=B(a),h=q(),{getHistoryList:_}=h,{bgmList:w}=B(h),y=x(()=>{var n;return(n=_(c.contents,"bgm"))==null?void 0:n.show_name}),l=x(()=>c.play&&!c.pause),m=M({}),o=(n,u)=>{n&&(u&&l.value?n.play():n.pause())};return k(y,(n,u)=>{o(m.value[u],!1),o(m.value[n],!0)}),k(l,()=>o(m.value[y.value],!0)),(n,u)=>(s(),r("div",Ca,[(s(!0),r(E,null,z(e(w),p=>(s(),O(re,{src:p.path,volume:e(d).bgm,loop:!0,ref_for:!0,ref:S=>m.value[p.id]=S},null,8,["src","volume"]))),256))]))}},Na={class:"invisible",id:"Se"},La={__name:"SE",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1}},setup(t){const c=t,a=W(),{audioVolume:d}=B(a),h=q(),{getSeByName:_}=h,{seList:w}=B(h),y=x(()=>c.data.se),l=x(()=>c.play&&!c.pause),m=M({}),o=(n,u)=>{n&&(u&&l.value?n.play():n.pause())};return k(y,(n,u)=>o(m.value[n],!0)),k(l,()=>o(m.value[y.value],!0)),k(()=>c.data,()=>{var u,p;const n=((u=_("text_advancing"))==null?void 0:u.id)??"";o(m.value[n],!((p=c.data)!=null&&p.is_showtime)&&l.value)}),(n,u)=>(s(),r("div",Na,[(s(!0),r(E,null,z(e(w),p=>(s(),O(re,{src:p.path,volume:e(d).se,ref_for:!0,ref:S=>m.value[p.id]=S},null,8,["src","volume"]))),256))]))}},Ta={class:"invisible",id:"Se"},Ea={__name:"Voice",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},voicing:{type:[Boolean],default:!1}},emits:["update:voicing"],setup(t,{emit:c}){const a=t,d=c,h=W(),{audioVolume:_}=B(h),w=q(),{getSeByName:y}=w,{voiceList:l}=B(w),m=x(()=>a.data.voice),o=x(()=>a.play&&!a.pause),n=M({}),u=S=>d("update:voicing",!1),p=(S,b)=>{S&&(b&&o.value?(d("update:voicing",!0),S.play()):S.pause())};return k(m,S=>p(n.value[S],!0)),k(o,()=>p(n.value[m.value],!0)),k(()=>a.data,()=>{var b,C;const S=((b=y("text_advancing"))==null?void 0:b.id)??"";p(n.value[S],!((C=a.data)!=null&&C.is_showtime)&&o.value)}),(S,b)=>(s(),r("div",Ta,[(s(!0),r(E,null,z(e(l),C=>(s(),O(re,{src:C.path,volume:e(_).voice,onEnded:u,ref_for:!0,ref:L=>n.value[C.id]=L},null,8,["src","volume"]))),256))]))}},Da={class:"-ui z-10",id:"Se"},Ua=["src"],Ma={__name:"Video",props:{data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},animating:{type:[Boolean],default:!1}},emits:["update:pause","update:animating"],setup(t,{emit:c}){const a=t,d=c,h=W(),{audioVolume:_}=B(h),w=q(),{videoList:y}=B(w),{getUrl:l}=ze(),m=x(()=>a.data.show_time==="anime"),o=x(()=>a.data.show_name),n=x(()=>_.value.bgm),u=M({}),p=b=>{d("update:animating",!1),d("update:pause",!1)},S=(b,C)=>{b&&(C&&a.play&&m.value?(d("update:animating",!0),d("update:pause",!0),b.volume=n.value,b.currentTime=0,b.play()):(b.currentTime=0,b.pause()))};return k(o,(b,C)=>{b&&S(u.value[b],!0)}),k(()=>a.play,()=>S(u.value[o.value],!0)),(b,C)=>{const L=R("opacity");return $((s(),r("div",Da,[(s(!0),r(E,null,z(e(y),N=>$((s(),r("video",{class:"-ui",src:e(l)(N.path),onEnded:p,ref_for:!0,ref:T=>u.value[N.id]=T},null,40,Ua)),[[L,N.id===o.value]])),256))],512)),[[U,m.value]])}}},za={class:"-ui bg-black",id:"Background"},Va={__name:"Background",props:{contents:{type:[Array],default:()=>[]}},setup(t){const c=t,a=Y(),{playEase:d}=B(a),h=q(),{getHistoryList:_}=h,{backgroundList:w}=B(h),y=x(()=>{var l;return(l=_(c.contents,"bg"))==null?void 0:l.show_name});return(l,m)=>{const o=R("opacity");return s(),r("div",za,[(s(!0),r(E,null,z(e(w),n=>$((s(),O(X,{class:H(["-ui",e(d)]),src:n.path,alt:n.name},null,8,["src","alt","class"])),[[o,n.id===y.value]])),256))])}}},Pa={class:"-ui",id:"Effect"},Aa={__name:"Effect",props:{name:{type:[String],default:""},data:{type:[Object],default:()=>({})}},setup(t){const c=Y(),{playEase:a}=B(c),d=q(),{effectList:h}=B(d);return(_,w)=>{const y=R("opacity");return s(),r("div",Pa,[(s(!0),r(E,null,z(e(h),l=>$((s(),O(X,{class:H(["-ui",e(a)]),src:l.path,alt:l.name},null,8,["src","alt","class"])),[[y,l.id===t.data[t.name]]])),256))])}}},Ha=["data-name"],ja={__name:"Sprite",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Object],default:()=>({})},num:{type:[Number],default:1}},setup(t){const c=t,a=ie(),{getSpriteNow:d}=a,{characterList:h}=B(a),_=Y(),{logCGMode:w,playEase:y}=B(_),{getMask:l,geSpritePosition:m,geSpriteSize:o}=ue(),n={1:{name:"char_1",sprite:"char_1_sprite",effect:"char_1_effect"},2:{name:"char_2",sprite:"char_2_sprite",effect:"char_2_effect"}},u=x(()=>n[c.num]??{}),p=x(()=>w.value?"speaker":u.value.name),S=x(()=>d(c.contents,c.data[u.value.name],p.value,u.value.sprite)),b=x(()=>c.num===2?c.ui.sprite_number===2:!0),C=x(()=>"sprite_"+c.num);return x(()=>l(c.ui[C.value].mask)),x(()=>m(c.ui[C.value])),x(()=>o(c.ui[C.value])),(L,N)=>{const T=R("visible"),V=R("opacity");return $((s(),O(Xe,{id:"Sprite",data:t.ui[C.value],class:H(e(y))},{default:K(()=>[(s(!0),r(E,null,z(e(h),F=>$((s(),r("div",{key:F.id,class:H(["-ui",e(y)]),"data-name":F.name},[(s(!0),r(E,null,z(F.sprite??[],j=>$((s(),O(X,{key:j.id,class:"sprite",src:j.path,alt:j.name},null,8,["src","alt"])),[[T,j.id===S.value]])),128))],10,Ha)),[[V,F.id===t.data[p.value]]])),128)),g(Aa,{name:u.value.effect,data:t.data},null,8,["name","data"])]),_:1},8,["data","class"])),[[V,b.value]])}}},xe=G(ja,[["__scopeId","data-v-b8cd019a"]]),Oa={class:"-ui bg-black",id:"CG"},Ra={__name:"CG",props:{contents:{type:[Array],default:()=>[]}},setup(t){const c=t,a=q(),{getHistoryList:d}=a,{cgList:h}=B(a),_=x(()=>{var w;return(w=d(c.contents,"cg"))==null?void 0:w.show_name});return(w,y)=>{const l=R("opacity");return s(),r("div",Oa,[(s(!0),r(E,null,z(e(h),m=>$((s(),O(X,{class:"-ui !object-cover",src:m.path,alt:m.name},null,8,["src","alt"])),[[l,m.id===_.value]])),256))])}}},Fa={class:"-ui",id:"UI"},Ga={__name:"UI",props:{data:{type:[Object],default:()=>({})},contents:{type:[Array],default:()=>[]},ui:{type:[Number,String],default:()=>""}},setup(t){const c=Y(),{nameTag1Show:a,nameTag2Show:d,playEase:h}=B(c),_=q(),{uiList:w}=B(_);return(y,l)=>{const m=R("opacity");return s(),r("div",Fa,[(s(!0),r(E,null,z(e(w),o=>$((s(),O(Ye,{class:H(["-ui",e(h)]),data:o,nameTag1Show:e(a),nameTag2Show:e(d),hasContent:!!t.data.content},null,8,["data","nameTag1Show","nameTag2Show","hasContent","class"])),[[m,o.id===t.ui]])),256)),$(f("div",{class:H(["-ui -replay",e(h)])},null,2),[[m,t.data.is_replay]])])}}},qa=G(Ga,[["__scopeId","data-v-ce7447f5"]]),Wa={class:"-ui",id:"NameTag"},Ka={class:"-ui"},Ja={class:"name_tag -font"},Qa={class:"-ui"},Xa={class:"name_tag -font"},Ya={__name:"NameTag",props:{data:{type:[Object],default:()=>({})},ui:{type:[Object],default:()=>({})}},setup(t){const c=t,a=W(),{fontFamily:d,fontWeight:h}=B(a),_=ie(),{getCharacter:w}=_,{characterList:y,characterUnknown:l}=B(_),m=Y(),{isNameRight:o,isNameShow:n}=B(m),{getNameTagStyle:u}=ue(),p=x(()=>w(c.data.speaker)),S=x(()=>{const b=o.value?"name_tag_2":"name_tag_1";return u(c.ui[b])});return(b,C)=>{const L=R("opacity");return $((s(),r("div",Wa,[$((s(),r("div",{class:H(["absolute",[e(d).nameTag,e(h).nameTag]]),style:Se(S.value)},[$((s(),r("div",Ka,[(s(!0),r(E,null,z(e(y),N=>$((s(),r("div",{key:N.id,class:"-ui"},[$((s(),r("p",Ja,[ye(D(N.katakana),1)])),[[L,!N.image_name]]),$(g(X,{class:"name_tag",src:N.image_name,alt:N.name},null,8,["src","alt"]),[[L,N.image_name]])])),[[L,N.id===p.value.id]])),128))])),[[L,!t.data.is_unknown]]),$((s(),r("div",Qa,[$((s(),r("p",Xa,[ye(D(e(l).katakana),1)])),[[L,!e(l).image_name]]),g(X,{class:"name_tag",src:e(l).image_name,alt:e(l).name},null,8,["src","alt"])])),[[L,t.data.is_unknown]])],6)),[[L,e(n)]])])),[[L,!!t.data.content]])}}},Za=G(Ya,[["__scopeId","data-v-0cb05d38"]]),en=3e3,tn={__name:"Black",props:{index:{type:[Number,String],default:0},length:{type:[Number],default:0},data:{type:[Object],default:()=>({})},play:{type:[Boolean],default:!1},pause:{type:[Boolean],default:!1},black:{type:[Boolean],default:!1}},emits:["update:index","update:pause","update:black"],setup(t,{emit:c}){const a=t,d=c,h=x(()=>a.data.show_time==="black"),_=M({}),w=x(()=>(_.value.show_name??"").split(",")),y=x(()=>w.value.includes("fade-in")),l=x(()=>w.value.includes("fade-out")),m=x(()=>h.value&&!w.value.includes("music")),o=M(!1),n=M(!1),u=()=>{if(h.value){if(_.value={...a.data},n.value=a.play&&y.value,o.value=!0,d("update:black",!0),!a.play)return;setTimeout(()=>{a.index>=a.length||d("update:index",a.index+1)},en)}else n.value=a.play&&l.value,o.value=!1,d("update:black",!1)};return k(h,u),k(()=>a.play,u),k(m,p=>d("update:pause",p)),(p,S)=>(s(),r("div",{class:H(["-ui z-20 bg-black",{"opacity-0":!o.value,"duration-1000":n.value}]),id:"Black"},null,2))}},an={class:"preview_title"},nn=["value"],sn=["title"],on=["title"],ln=["onDragstart","onDragend","data-id"],cn={class:"contents"},un={class:"-ui pointer-events-none"},rn={__name:"index",setup(t){const c=Ve(),a=W(),{fullscreen:d}=B(a),h=ke(),{chapterIndex:_,chapterNames:w,chapterData:y}=B(h),l=Y(),{stopPlaying:m,changeLog:o}=l,{logId:n,logIndex:u,logData:p,logContents:S,logHistory:b,logCGMode:C,logUIId:L,logUI:N,logPlay:T,logPause:V,logTyping:F,logBlack:j,logVoicing:ee,logAnimating:te,playEase:Be}=B(l),{getClientRect:Ce}=Pe(),{dragMove:Ie,dropMove:Ne}=je(),{swipeStart:de,swipeEnd:Le}=et(),{t:pe}=ce("lang");k(_,m);const Te=x(()=>y.value.some(I=>I.dragging)),me=(I,i,Q)=>{Q&&Ie(I,{index:i}),y.value[i].dragging=Q},Ee=(I,i)=>Ne(y.value,I.index,i),ve=M({}),J=(I=!0)=>{He(()=>{const i=ve.value[n.value];if(!i)return;const{height:Q,top:oe}=Ce(i);i.parentElement.scrollBy({top:oe-Q,left:0,behavior:I?"smooth":"auto"})})};k(n,()=>{T.value&&J()}),k(_,()=>J(!1)),k(()=>c.name,I=>{I==="Preview"&&J(!1)});const _e=M(null);k(d,I=>{window.api?window.api.fullscreen(I):I?_e.value.requestFullscreen():document.exitFullscreen()});const ge=M(null),fe=I=>ge.value=I,se=M(!1),ae=Ae({id:0,type:""}),he=(I,{type:i})=>{ae.id=I,ae.type=i??"",se.value=!0},De=I=>y.value.push(I),Ue=I=>{n.value=I,setTimeout(()=>J(),100)},Me=I=>{Le(I)>0?o(1):o(-1)};return(I,i)=>{const Q=R("opacity"),oe=R("visible");return s(),O(Je,{class:"flex-row-reverse",main:"!p-0",side:"!p-0 border-4 border-transparent"},{side_head:K(()=>[g(Fe,{positions:ge.value,onClear:fe,onUse:i[0]||(i[0]=v=>he("add",v)),onlyAdd:!0},null,8,["positions"]),f("section",an,[g(Ke,{class:"preview_title_select",value:e(_),"onUpdate:value":i[1]||(i[1]=v=>A(_)?_.value=v:null)},{default:K(()=>[(s(!0),r(E,null,z(e(w),(v,Z)=>(s(),r("option",{value:Z},D(v),9,nn))),256))]),_:1},8,["value"]),$(f("button",{class:"preview_button",onClick:i[2]||(i[2]=v=>J()),title:e(pe)("button.target-log")},[g(Ge)],8,sn),[[U,!e(d)]]),f("button",{class:"preview_button",onClick:fe,title:e(pe)("button.new")},[g(e(Oe))],8,on)])]),side:K(()=>[(s(!0),r(E,null,z(e(y),(v,Z)=>$((s(),r("div",{key:v.id,class:H(["relative",{"-dragging":v.dragging}]),draggable:!0,onDragstart:P=>me(P,Z,!0),onDragend:P=>me(P,Z,!1),onDrag:i[4]||(i[4]=ne(()=>{},["prevent"])),onDrop:i[5]||(i[5]=ne(()=>{},["prevent"])),"data-id":v.id,ref_for:!0,ref:P=>ve.value[v.id]=P},[g(qt,{id:e(n),"onUpdate:id":i[3]||(i[3]=P=>A(n)?n.value=P:null),log:v,onEdit:P=>he(v.id,{}),onDelete:P=>v.is_delete=!0,onStop:e(m)},null,8,["id","log","onEdit","onDelete","onStop"]),g(Re,{class:"preview_dragline !h-1 !text-secondary/50",onDrop:P=>Ee(P,Z+1),dragging:Te.value},null,8,["onDrop","dragging"])],42,ln)),[[U,!v.is_delete]])),128))]),default:K(()=>[f("div",{class:"preview",onKeydown:[i[16]||(i[16]=le(v=>T.value=!e(T),["space"])),i[17]||(i[17]=le(v=>e(o)(-1),["left"])),i[18]||(i[18]=le(v=>e(o)(1),["right"]))],onTouchstart:i[19]||(i[19]=ne((...v)=>e(de)&&e(de)(...v),["prevent"])),onTouchend:ne(Me,["prevent"]),tabindex:"0",ref_key:"preview",ref:_e},[g(Qe,{box:"lattice"},{outer:K(()=>[g(ka,{index:e(u),"onUpdate:index":i[13]||(i[13]=v=>A(u)?u.value=v:null),play:e(T),"onUpdate:play":i[14]||(i[14]=v=>A(T)?T.value=v:null),typing:e(F),black:e(j),voicing:e(ee),animating:e(te),length:e(S).length-1,onTarget:i[15]||(i[15]=v=>J()),onStop:e(m)},null,8,["index","play","typing","black","voicing","animating","length","onStop"])]),default:K(()=>[f("div",cn,[g(Ia,{contents:e(b),play:e(T),pause:e(V)},null,8,["contents","play","pause"]),g(La,{data:e(p),play:e(T),pause:e(V)},null,8,["data","play","pause"]),g(Ea,{data:e(p),play:e(T),pause:e(V),voicing:e(ee),"onUpdate:voicing":i[6]||(i[6]=v=>A(ee)?ee.value=v:null)},null,8,["data","play","pause","voicing"])]),$((s(),r("div",un,[g(Va,{contents:e(b)},null,8,["contents"]),g(xe,{data:e(p),contents:e(b),ui:e(N),num:1},null,8,["data","contents","ui"]),g(xe,{data:e(p),contents:e(b),ui:e(N),num:2},null,8,["data","contents","ui"]),$(g(Ra,{contents:e(b),class:H(e(Be))},null,8,["contents","class"]),[[Q,e(C)]]),g(qa,{data:e(p),contents:e(b),ui:e(L)},null,8,["data","contents","ui"]),g(Za,{data:e(p),ui:e(N)},null,8,["data","ui"])])),[[oe,e(y).length]]),g(Ba,{class:"pointer-events-none",data:e(p),ui:e(N),play:e(T),typing:e(F),"onUpdate:typing":i[7]||(i[7]=v=>A(F)?F.value=v:null),black:e(j)},null,8,["data","ui","play","typing","black"]),g(tn,{index:e(u),"onUpdate:index":i[8]||(i[8]=v=>A(u)?u.value=v:null),data:e(p),play:e(T),pause:e(V),"onUpdate:pause":i[9]||(i[9]=v=>A(V)?V.value=v:null),black:e(j),"onUpdate:black":i[10]||(i[10]=v=>A(j)?j.value=v:null),length:e(S).length-1},null,8,["index","data","play","pause","black","length"]),g(Ma,{data:e(p),play:e(T),pause:e(V),"onUpdate:pause":i[11]||(i[11]=v=>A(V)?V.value=v:null),animating:e(te),"onUpdate:animating":i[12]||(i[12]=v=>A(te)?te.value=v:null)},null,8,["data","play","pause","animating"])]),_:1})],544),g(qe,{open:se.value,"onUpdate:open":i[20]||(i[20]=v=>se.value=v),id:ae.id,type:ae.type,onAdd:De,onTarget:Ue},null,8,["open","id","type"])]),_:1})}}},xn=G(rn,[["__scopeId","data-v-e552b967"]]);export{xn as default};
