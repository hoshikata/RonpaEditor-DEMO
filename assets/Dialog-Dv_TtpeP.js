import{_ as M,W as R,r as F,h as T,j,w as H,o as $,c as C,a as c,n as w,k as L,F as z,a0 as A,t as I,v as P,a5 as V,d as W,s as N,a6 as q,u as n}from"./index-DjFC1Eq4.js";import"./Menu.vue_vue_type_style_index_0_scoped_c8f5dede_lang-Bp3pNzl9.js";const J={class:"menu_list"},K={class:"contents"},Q=["onClick"],U={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(i,{emit:_}){const h=i,d=_,{getClientRect:r}=R(),o=F(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：動画",type:"perform_anime"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],y=T(()=>{const{width:t,height:l}=r(document.documentElement),{width:e,height:s}=r(o.value),{x:u,y:x,width:k,height:f}=h.positions??{},v=(x??0)+(f??0)/2-(s??0)/2,b=(v<20?20:v)+"px",S=(l??0)-(s??0)-20+"px",B=`min(${b}, ${S})`,D=(u??0)+(e??0)>t,E=(u??0)+(k??0)+2,O=(u??0)-(e??0)-9-2,G=(D?O:E)+"px";return{top:B,left:G}}),m=T(()=>{const{width:t}=r(document.documentElement),{width:l}=r(o.value),{x:e,y:s,width:u,height:x}=h.positions??{},k=(s??0)+(x??0)/2,f=(e??0)+(l??0)>t,v=(e??0)+(u??0)+3,b=(e??0)-3.2,S=f?b:v;return{top:k+"px",left:S+"px",turn:f}}),a=t=>{t.target.matches(".menu, .menu *")||d("clear",null)},g=t=>{d("use",{type:t}),d("clear",null)};return(t,l)=>{const e=j("visible");return H(($(),C("div",{class:"menu_container",onClick:a},[c("div",{class:w(["menu_triangle",{"-scale-x-100":m.value.turn}]),style:L(m.value)},null,6),c("div",{class:"menu scrollbar overflow-y-auto",style:L(y.value),ref_key:"menu",ref:o},[c("ul",J,[($(),C(z,null,A(p,s=>c("li",K,[H(c("button",{class:w(["menu_item",s.class]),onClick:u=>g(s.type)},I(s.title),11,Q),[[P,!(s.type==="delete"&&i.onlyAdd)]])])),64))])],4)])),[[e,i.positions]])}}},st=M(U,[["__scopeId","data-v-c8f5dede"]]),X={class:"dialog_wrap"},Y=["data-content","innerHTML"],Z={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(i){V(a=>({"35896f63":n(o).lineHeight,"4d5ca058":n(o).letterSpace,"15be853d":n(o).fontLength,f66c4386:n(p).keyword.dark,"729921a5":n(p).monolog.dark,"0085a039":n(p).announce.dark}));const _=i,h=W(),{fontFamily:d,fontWeight:r,fontStyle:o}=N(h),{colors:p}=q(),y=T(()=>{const a=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),g=m("keyword"),l=_.value.replace(a,`<span class="${g}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:_.value.replace(/\[|\]/g,""),html:l}}),m=a=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[a]??"text-white";return(a,g)=>($(),C("div",{class:w(["dialog",[n(d).dialog,n(r).dialog]])},[c("div",X,[c("pre",{class:w(m(i.type)),"data-content":y.value.value,innerHTML:y.value.html},null,10,Y)])],2))}},nt=M(Z,[["__scopeId","data-v-0b46230a"]]);export{nt as D,st as M};
