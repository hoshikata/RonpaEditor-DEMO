import{o as c,d,e as t,_ as L,B as S,r as B,C as I,m as b,h,f as k,c as O,F as M,j as N,n as V,t as H,D as F,E as U,G as j,s as A,w as P,y as w,z as G,A as J}from"./index-DVknFsLz.js";import{H as X}from"./Header-DEMCp5KC.js";const q={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},K=t("path",{fill:"currentColor",d:"m12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72l3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41l-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08z"},null,-1),Q=[K];function W(a,r){return c(),d("svg",q,[...Q])}const Y={name:"ic-round-star",render:W},Z={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ee=t("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2"},null,-1),te=[ee];function se(a,r){return c(),d("svg",Z,[...te])}const E={name:"ic-round-plus",render:se},ne={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},oe=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),ae=[oe];function le(a,r){return c(),d("svg",ne,[...ae])}const ie={name:"ic-round-close",render:le},ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},de=t("path",{fill:"currentColor",d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2s.9-2 2-2s2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2"},null,-1),re=[de];function ue(a,r){return c(),d("svg",ce,[...re])}const _e={name:"ic-round-drag-indicator",render:ue},pe={__name:"Control",props:{hasAdd:{type:[Boolean],default:!0},hasDel:{type:[Boolean],default:!0}},emits:["add","del","more"],setup(a,{emit:r}){const i=r,{getRectValue:p}=S(),u=B(null),m=n=>{const s=p(u.value);i(n,s)};return(n,s)=>{const l=I("visible");return c(),d("div",{class:"grid content-center justify-items-center gap-2 text-2xl",ref_key:"control",ref:u},[b((c(),d("button",{class:"control_button",onClick:s[0]||(s[0]=_=>m("add"))},[h(k(E))])),[[l,a.hasAdd]]),t("button",{class:"control_button",onClick:s[1]||(s[1]=_=>m("more"))},[h(k(_e))]),b((c(),d("button",{class:"control_button scale-90",onClick:s[2]||(s[2]=_=>m("del"))},[h(k(ie))])),[[l,a.hasDel]])],512)}}},ge=L(pe,[["__scopeId","data-v-659373ab"]]),me={class:"menu_list"},ve={class:"contents"},fe={__name:"Menu",props:{positions:{type:[Object],default:null}},emits:["clear"],setup(a,{emit:r}){const i=a,p=r,{getRectValue:u}=S(),m=B(null),n=[{title:"セリフ：主人公",type:""},{title:"セリフ：独り言",type:"",class:"!text-monolog"},{title:"セリフ：脇役",type:""},{title:"切り替え：背景",type:""},{title:"切り替え：BGM",type:""},{title:"演出：CG",type:""},{title:"演出：CG終了",type:""},{title:"演出：動画",type:""},{title:"演出：暗転",type:""},{title:"アナウンス",type:"",class:"!text-announce"},{title:"システム",type:"",class:"!text-announce"}],s=O(()=>{const{height:_}=u(document.documentElement),{height:y}=u(m.value),{x:v,y:D,width:f,height:g}=i.positions??{},x=(D??0)+(g??0)/2-(y??0)/2,e=(x<20?20:x)+"px",$=(_??0)-(y??0)-20+"px",o=`min(${e}, ${$})`,R=(v??0)+(f??0)+"px";return{top:o,left:R}}),l=_=>{_.target.matches(".menu, .menu *")||p("clear",null)};return(_,y)=>{const v=I("visible");return b((c(),d("div",{class:"fixed inset-0 z-50 h-screen w-screen",onClick:l},[t("div",{class:"menu",style:F(s.value),ref_key:"menu",ref:m},[t("ul",me,[(c(),d(M,null,N(n,D=>t("li",ve,[t("button",{class:V(["menu_item",D.class])},H(D.title),3)])),64))])],4)])),[[v,a.positions]])}}},he=L(fe,[["__scopeId","data-v-16887f50"]]);function be(){const{findData:a}=S(),r=(n,s)=>{const l=s.replace(/\s/g,"").toLowerCase().split(","),_=n.name.slice(n.name.lastIndexOf(".")).toLowerCase();return s!==""?l.includes(_):!0},i=n=>n instanceof Blob;return{isFileType:r,isBlobFile:i,blobUrl:(n,s)=>{const l=_=>_.slice(-1)==="/"?"":_;return i(n)?URL.createObjectURL(n):l(s??"")},getFileName:n=>{var l;n=n??"";const s=(l=n.lastIndexOf)==null?void 0:l.call(n,"/");return i(n)||s===-1?n:n.slice(s).slice(1)},getFilesData:(n,s)=>{const l=s.filter(v=>!v.id),_=n.filter(v=>!a(s,v.id)).map(v=>v.name),y=n.filter(v=>a(s,v.id));return{addList:l,delList:_,resultList:y}}}}const ye={class:"upload"},xe={class:"upload_input"},$e={class:"upload_image"},De=["src"],ke={__name:"Upload",props:{value:{type:[String],default:""},type:{type:[String],default:"contain"}},emits:["update:value"],setup(a,{emit:r}){const{blobUrl:i}=be(),p=r,u=n=>{const s=n.target.files[0],l=i(s,"");p("update:value",l)},m=()=>p("update:value","");return(n,s)=>{const l=I("visible");return c(),d("div",ye,[b((c(),d("label",xe,[h(k(E)),t("input",{class:"hidden",onChange:u,type:"file",accept:"image/*"},null,32)])),[[l,!a.value]]),b((c(),d("div",$e,[t("img",{class:V(["h-full w-full",a.type==="cover"?"object-cover":"object-contain"]),src:a.value},null,10,De),t("button",{class:"upload_remove",onClick:m},[h(k(E),{class:"rotate-45"})])])),[[l,a.value]])])}}},z=L(ke,[["__scopeId","data-v-36f67343"]]),Ce={__name:"DropLine",emits:["drop"],setup(a,{emit:r}){const i=r,p=B(null),u=n=>{p.value.style.setProperty("opacity",n?1:0)},m=n=>{const s=n.dataTransfer.getData("text/plain");let l=null;try{l=JSON.parse(s)}catch{}u(!1),l!==null&&i("drop",l)};return(n,s)=>(c(),d("div",{class:"drag_line",onDragenter:s[0]||(s[0]=U(l=>u(!0),["prevent"])),onDragleave:s[1]||(s[1]=U(l=>u(!1),["prevent"])),onDragover:s[2]||(s[2]=U(()=>{},["prevent"])),onDrop:m,ref_key:"line",ref:p},null,544))}},T=L(Ce,[["__scopeId","data-v-5a6107b9"]]),we="/RonpaEditor-DEMO/assets/headshot_1-CxnizMm5.png",Be="/RonpaEditor-DEMO/assets/headshot_2-xVBmaB3M.png",Ue="/RonpaEditor-DEMO/assets/nametag_1-gPs7u1zN.png",Le="/RonpaEditor-DEMO/assets/nametag_2-UDMsHms1.png",Me=j("character",()=>{const a=B([{id:0,name:"？？？？",katakana:"？？？？",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",unknown:!0,is_drag:!0,dragging:!1},{id:1,name:"十六夜魔除",katakana:"イザヨイマヨ",name_bg:"#a64d79",name_text:"#ffff00",image_head:we,image_name:Ue,is_hero:!0,is_drag:!0,dragging:!1},{id:2,name:"観月星知",katakana:"カンゲツセシル",name_bg:"#674ea7",name_text:"#d4c1a6",image_head:Be,image_name:Le,is_hero:!1,is_drag:!0,dragging:!1}]),r=B({name:"",katakana:"",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",is_hero:!1,is_drag:!0});return{characterList:a,characterNew:r}});function Fe(){return{dragMove:(i,p)=>{i.dataTransfer.dropEffect="move",i.dataTransfer.setData("text/plain",JSON.stringify(p))},dropMove:(i,p,u)=>{const[m]=i.splice(p,1),n=p>=u?u:u-1,s=n<0?0:n;i.splice(s,0,m)}}}const C=a=>(G("data-v-60370857"),a=a(),J(),a),Ve={class:"setting_wrap"},Ie=C(()=>t("div",null,null,-1)),Ee=C(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"アイコン"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc highlight"},"★ = 主人公")],-1)),Se=C(()=>t("div",{class:"setting_head col-span-2"},[t("h2",{class:"setting_title"},"お名前"),t("p",{class:"setting_desc"},"EXCEL内表示")],-1)),ze=C(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"名札"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc"},"（画像のない場合はカタカナ表示になります）")],-1)),Te=["draggable","onDragstart","onDragend"],Oe={key:0,class:"setting_avatar setting_unknown"},Ne={key:1,class:"setting_avatar"},Re=["onClick"],He={class:"setting_detail",draggable:"false"},je=["onUpdate:modelValue","onFocus","onBlur"],Ae={class:"setting_col"},Pe=C(()=>t("p",{class:"ml-0.5"},"名前の色",-1)),Ge=["onUpdate:modelValue","onFocus","onBlur"],Je=["onUpdate:modelValue"],Xe={class:"setting_detail"},qe=["onUpdate:modelValue","onFocus","onBlur"],Ke={class:"setting_col"},Qe=C(()=>t("p",{class:"ml-0.5"},"名前の背景色",-1)),We=["onUpdate:modelValue","onFocus","onBlur"],Ye=["onUpdate:modelValue"],Ze=C(()=>t("div",{class:"col-span-5 mb-4"},null,-1)),et={__name:"Character",setup(a){const r=Me(),{characterList:i,characterNew:p}=A(r),{dragMove:u,dropMove:m}=Fe(),n=O(()=>i.value.some(f=>f.is_hero)),s=f=>{const g={...p.value},x=[...i.value].sort((e,$)=>$.id-e.id)[0];g.id=x?x.id+1:0,i.value.splice(f+1,0,g)},l=f=>i.value.splice(f,1),_=(f,g,x)=>{x&&u(f,{index:g}),i.value[g].dragging=x},y=(f,g)=>m(i.value,f.index,g),v=B(null),D=f=>{v.value=f};return(f,g)=>{const x=I("visible");return c(),d(M,null,[h(he,{positions:v.value,onClear:D},null,8,["positions"]),t("div",Ve,[h(X,{col:"col-span-5"},{default:P(()=>[Ie,Ee,Se,ze]),_:1}),h(T,{class:"col-span-5",onDrop:g[0]||(g[0]=e=>y(e,0))}),(c(!0),d(M,null,N(k(i),(e,$)=>(c(),d(M,{key:e.id},[t("div",{class:V(["setting_container",{"!bg-secondary/30":e.dragging}]),draggable:e.is_drag,onDragstart:o=>_(o,$,!0),onDragend:o=>_(o,$,!1),onDrag:g[1]||(g[1]=U(()=>{},["prevent"])),onDrop:g[2]||(g[2]=U(()=>{},["prevent"]))},[h(ge,{class:"row-span-2 -mr-6",hasDel:!e.unknown,onAdd:o=>s($),onDel:o=>l($),onMore:D},null,8,["hasDel","onAdd","onDel"]),e.unknown?(c(),d("div",Oe)):(c(),d("div",Ne,[h(z,{class:"h-full w-full",value:e.image_head,"onUpdate:value":o=>e.image_head=o,type:"cover"},null,8,["value","onUpdate:value"]),b((c(),d("button",{class:V(["setting_star",{"setting_star-active":e.is_hero}]),onClick:o=>e.is_hero=!e.is_hero},[h(k(Y))],10,Re)),[[x,!(n.value&&!e.is_hero)]])])),t("div",He,[b(t("input",{class:"setting_name last","onUpdate:modelValue":o=>e.name=o,style:F({"--name-bg":e.name_bg,"--name-text":e.name_text}),onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,44,je),[[w,e.name,void 0,{lazy:!0,trim:!0}]]),t("div",Ae,[Pe,b(t("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_text=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,Ge),[[w,e.name_text,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:F({"background-color":e.name_text})},[b(t("input",{class:"hidden","onUpdate:modelValue":o=>e.name_text=o,type:"color"},null,8,Je),[[w,e.name_text,void 0,{lazy:!0}]])],4)])]),t("div",Xe,[b(t("input",{class:"setting_name first","onUpdate:modelValue":o=>e.katakana=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,qe),[[w,e.katakana,void 0,{lazy:!0,trim:!0}]]),t("div",Ke,[Qe,b(t("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_bg=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,We),[[w,e.name_bg,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:F({"background-color":e.name_bg})},[b(t("input",{class:"hidden","onUpdate:modelValue":o=>e.name_bg=o,type:"color"},null,8,Ye),[[w,e.name_bg,void 0,{lazy:!0}]])],4)])]),h(z,{class:"setting_nametag",value:e.image_name,"onUpdate:value":o=>e.image_name=o},null,8,["value","onUpdate:value"])],42,Te),h(T,{class:"col-span-5",onDrop:o=>y(o,$+1)},null,8,["onDrop"])],64))),128)),Ze])],64)}}},nt=L(et,[["__scopeId","data-v-60370857"]]);export{nt as default};
