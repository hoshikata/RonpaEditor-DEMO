import{_ as T,r as S,e as J,o as r,c as v,w as m,e9 as de,a as s,n as _,t as n,ea as ee,M as se,g as N,m as te,b as l,h as _e,e4 as E,d as ue,s as K,f as pe,k as he,e5 as ve,q as U,e6 as b,u as h,p as Q,F as z,v as F,eb as L,e2 as ge,e3 as me}from"./index-Ciiw17-W.js";import{I as X}from"./round-close-BjAhFRG9.js";import{_ as fe,a as be,D as ye,M as De,E as we}from"./Image-DfWnWtdz.js";import{W as ke}from"./Wrap-xzl0t6gB.js";import{C as R,D as Y,u as xe}from"./useDrag-lePRrBEy.js";import{M as Ce}from"./Mark-tER8CO2L.js";const Se=["disabled"],Ie={class:"whitespace-nowrap"},Me={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(c,{emit:f}){const D=c,C=f,d=S(0);return J(d,g=>C("update:value",g)),J(()=>D.value,g=>d.value=g,{immediate:!0}),(g,w)=>(r(),v("label",{class:_(["inline-flex items-center",c.disabled?"cursor-auto":"cursor-pointer"])},[m(s("input",{class:_(["checkbox",c.box]),"onUpdate:modelValue":w[0]||(w[0]=k=>d.value=k),disabled:c.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,Se),[[de,d.value]]),s("span",Ie,n(c.title),1),ee(g.$slots,"default",{},void 0,!0)],2))}},Z=T(Me,[["__scopeId","data-v-b7a95cdd"]]),$e={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(c){return(f,D)=>(r(),v("button",{class:_(["switch",{"bg-current":c.active}])},[s("span",{class:_(["-mt-0.1em",{"text-white":c.active}])},[ee(f.$slots,"default",{},void 0,!0)],2)],2))}},B=T($e,[["__scopeId","data-v-8bd1e4e9"]]),Ae={class:"avatar"},Ue={__name:"Avatar",props:{name:{type:[String],default:""}},setup(c){const f=c,D=se(),{getCharacter:C}=D,d=N(()=>C(f.name)),g=N(()=>f.name.replaceAll(/\s|=|＝|‧|・/g,`
`));return(w,k)=>{const I=te("visible");return r(),v("div",Ae,[m(l(fe,{src:d.value.image_head},null,8,["src"]),[[I,d.value.image_head]]),m((r(),v("div",{class:"avatar_text",style:_e({color:d.value.name_text,"background-color":d.value.name_bg})},[E(n(g.value),1)],4)),[[I,!d.value.image_head]])])}}},Le=T(Ue,[["__scopeId","data-v-57da6b2f"]]),y=c=>(ge("data-v-c2123788"),c=c(),me(),c),Be={class:"side_list"},Ee={class:"flex"},Ne=["onClick","title"],Te={class:"chapter_head"},Ve={class:"chapter_log"},Pe={class:"chapter_log_tr -lock"},ze={class:"mx-1 w-14 self-center"},Fe=y(()=>s("div",{class:"chapter_log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),Re=y(()=>s("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),We=y(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"立ち絵1．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"立ち絵2．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE＆ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),qe={key:0,class:"contents"},Ge=["onDragstart","onDragend"],Oe={class:"chapter_log_scene"},je=y(()=>s("div",{class:"chapter_log_switches xl:!hidden"},null,-1)),He={class:"chapter_log_tr_2"},Je=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Ke=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Qe=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Xe={class:"chapter_log_td -col"},Ye={class:"-inner"},Ze={key:1,class:"contents"},es=["onDragstart","onDragend"],ss={class:"chapter_log_comment"},ts={class:"chapter_log_switches"},as={class:"chapter_log_tr_2"},os={class:"chapter_log_td -col"},ls={class:"-inner col-span-2"},ns={class:"-inner"},cs={class:"-inner"},is={class:"chapter_log_td -col"},rs={class:"-inner col-span-2"},ds={class:"-inner"},_s={class:"-inner"},us={class:"chapter_log_td -col"},ps={class:"-inner"},hs={class:"-inner"},vs={class:"chapter_log_td -col"},gs={class:"-inner"},ms={__name:"Chapters",setup(c){const f=ue();K(f);const D=se(),{getCharacter:C}=D,d=pe(),{dialogType:g,newChapter:w}=d,{chapterIndex:k,chapterNames:I,chapterTarget:W,chapterData:p}=K(d),{findData:ae,findIndex:oe}=he(),{dragMove:le,dropMove:ne}=xe(),ce=o=>C(o.人物),q=N(()=>p.value.some(o=>o.dragging)),V=N(()=>p.value.filter(o=>o.is_selected).map(o=>o.id)),M=(o,t,u)=>{u&&le(o,{index:t}),V.value.some(i=>p.value[t].id===i)||(p.value[t].is_selected=1),V.value.forEach(i=>{const a=ae(p.value,i);a.dragging=u,u||(a.is_selected=0)})},G=(o,t)=>{V.value.forEach(u=>{const e=oe(p.value,u);ne(p.value,e,t)})},O=S(!1),$=S(0),j=S(null),A=(o,t)=>{$.value=t,j.value=o,O.value=t===null},ie=({type:o})=>{const t=$.value,u=p.value[t];o==="delete"?u.is_delete=!0:o==="edit"?H(u.id,{}):H("add",{type:o})},P=S(!1),x=ve({id:0,type:"",index:0}),H=(o,{type:t})=>{x.id=o,x.type=t??"",x.index=$.value,P.value=!0},re=o=>{const t=$.value===null?p.value.length:x.index+1;p.value.splice(t,0,o)};return(o,t)=>{const u=te("visible");return r(),U(ke,null,{side_foot:b(()=>[s("button",{class:"chapter_add",onClick:t[0]||(t[0]=(...e)=>h(w)&&h(w)(...e))},[l(h(X))])]),side:b(()=>[s("ul",Be,[(r(!0),v(z,null,Q(h(I),(e,i)=>(r(),v("li",Ee,[l(Ce,{class:"chapter_mark",active:i===h(k)},null,8,["active"]),s("button",{class:_(["side_item",{"side_item-active":i===h(k)}]),onClick:a=>k.value=i,title:e},n(e),11,Ne)]))),256))])]),main_head:b(()=>[s("header",Te,[l(be,{class:"chapter_head_title",value:h(W).title,"onUpdate:value":t[1]||(t[1]=e=>h(W).title=e),placeholder:"タイトル"},null,8,["value"])])]),default:b(()=>[s("div",Ve,[s("div",Pe,[s("div",ze,[l(B,{class:"chapter_plus"},{default:b(()=>[l(h(X),{class:"mt-0.1em"}),l(R,{class:"absolute left-0 top-0 opacity-0",onMore:t[2]||(t[2]=e=>A(e,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Fe,Re]),We,l(Y,{class:"chapter_log_dragline",onDrop:t[3]||(t[3]=e=>G(e,0)),dragging:q.value},null,8,["dragging"]),(r(!0),v(z,null,Q(h(p),(e,i)=>(r(),v(z,{key:e.id},[e.is_showtime?m((r(),v("section",qe,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:!0,onDragstart:a=>M(a,i,!0),onDragend:a=>M(a,i,!1),onDrag:t[4]||(t[4]=L(()=>{},["prevent"])),onDrop:t[5]||(t[5]=L(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[l(Z,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),l(R,{class:"chapter_log_control",onMore:a=>A(a,i),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",Oe,[s("span",null,n(e.人物),1),s("span",null,n(e.show_time),1),s("span",null,n(e.show_name),1)])],2),je],42,Ge),s("div",He,[Je,Ke,Qe,s("div",Xe,[s("div",Ye,n(e.備註),1)])])],512)),[[F,!e.is_delete]]):m((r(),v("section",Ze,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:!0,onDragstart:a=>M(a,i,!0),onDragend:a=>M(a,i,!1),onDrag:t[6]||(t[6]=L(()=>{},["prevent"])),onDrop:t[7]||(t[7]=L(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[l(Z,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),l(R,{class:"chapter_log_control",onMore:a=>A(a,i),onDel:a=>e.is_delete=!0,hasDel:!1,hasAdd:!1},null,8,["onMore","onDel"]),s("div",{class:_(["chapter_log_info",{"flex-row-reverse":ce(e).is_hero,"-replay":e.is_replay}])},[l(Le,{class:"chapter_log_avatar",name:e.人物},null,8,["name"]),s("div",ss,[l(ye,{class:"chapter_log_dialog",value:e.和訳,type:h(g)(e)},null,8,["value","type"])])],2)],2),s("div",ts,[m((r(),U(B,{class:_(["chapter_log_switch",{"text-replay":e.is_replay}]),active:e.is_replay,title:"再放送"},{default:b(()=>[E("R")]),_:2},1032,["active","class"])),[[u,e.is_replay]]),m((r(),U(B,{class:_(["chapter_log_switch",{"text-unknown":e.is_unknown}]),active:e.is_unknown,title:"未解明"},{default:b(()=>[E("U")]),_:2},1032,["active","class"])),[[u,e.is_unknown]]),m((r(),U(B,{class:_(["chapter_log_switch",{"-monolog":e.is_monolog}]),active:e.is_monolog,title:"独り言"},{default:b(()=>[E("S")]),_:2},1032,["active","class"])),[[u,e.is_monolog]])])],42,es),s("div",as,[s("div",os,[s("div",ls,n(e.顯示角色),1),s("div",ns,n(e.角色差分),1),s("div",cs,n(e.差分特效),1)]),s("div",is,[s("div",rs,n(e.立ち絵2),1),s("div",ds,n(e.十六夜差分),1),s("div",_s,n(e.主角特效),1)]),s("div",us,[s("div",ps,n(e.SE),1),s("div",hs,n(e.Voice),1)]),s("div",vs,[s("div",gs,n(e.備註),1)])])],512)),[[F,!e.is_delete]]),m(l(Y,{class:"chapter_log_dragline",onDrop:a=>G(a,i+1),dragging:q.value},null,8,["onDrop","dragging"]),[[F,!e.is_delete]])],64))),128))]),l(De,{positions:j.value,onClear:A,onUse:ie,onlyAdd:O.value},null,8,["positions","onlyAdd"]),l(we,{open:P.value,"onUpdate:open":t[8]||(t[8]=e=>P.value=e),id:x.id,type:x.type,onAdd:re},null,8,["open","id","type"])]),_:1})}}},xs=T(ms,[["__scopeId","data-v-c2123788"]]);export{xs as default};
