import{o as _,d as g,e as t,_ as I,B as T,r as U,C as V,q as y,h as f,f as D,c as S,D as L,F as E,i as R,n as F,t as A,E as M,G as P,s as G,w as J,A as B,p as q,j as X}from"./index-DjDfTpOa.js";import{H as K}from"./Header-DcOKIG0I.js";const Q={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},W=t("path",{fill:"currentColor",d:"m12 17.27l4.15 2.51c.76.46 1.69-.22 1.49-1.08l-1.1-4.72l3.67-3.18c.67-.58.31-1.68-.57-1.75l-4.83-.41l-1.89-4.46c-.34-.81-1.5-.81-1.84 0L9.19 8.63l-4.83.41c-.88.07-1.24 1.17-.57 1.75l3.67 3.18l-1.1 4.72c-.2.86.73 1.54 1.49 1.08z"},null,-1),Y=[W];function Z(a,p){return _(),g("svg",Q,[...Y])}const ee={name:"ic-round-star",render:Z},te={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},se=t("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2"},null,-1),ne=[se];function oe(a,p){return _(),g("svg",te,[...ne])}const z={name:"ic-round-plus",render:oe},ae={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},le=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),ie=[le];function de(a,p){return _(),g("svg",ae,[...ie])}const ce={name:"ic-round-close",render:de},re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ue=t("path",{fill:"currentColor",d:"M11 18c0 1.1-.9 2-2 2s-2-.9-2-2s.9-2 2-2s2 .9 2 2m-2-8c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0-6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m6 4c1.1 0 2-.9 2-2s-.9-2-2-2s-2 .9-2 2s.9 2 2 2m0 2c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2m0 6c-1.1 0-2 .9-2 2s.9 2 2 2s2-.9 2-2s-.9-2-2-2"},null,-1),_e=[ue];function ge(a,p){return _(),g("svg",re,[..._e])}const pe={name:"ic-round-drag-indicator",render:ge},me={__name:"Control",props:{hasAdd:{type:[Boolean],default:!0},hasDel:{type:[Boolean],default:!0}},emits:["add","del","more"],setup(a,{emit:p}){const l=p,{getClientRect:c}=T(),m=U(null),v=n=>{const s=c(m.value);l(n,s)};return(n,s)=>{const i=V("visible");return _(),g("div",{class:"grid content-center justify-items-center gap-2 text-2xl",ref_key:"control",ref:m},[y((_(),g("button",{class:"control_button",onClick:s[0]||(s[0]=h=>v("add"))},[f(D(z))])),[[i,a.hasAdd]]),t("button",{class:"control_button",onClick:s[1]||(s[1]=h=>v("more"))},[f(D(pe))]),y((_(),g("button",{class:"control_button scale-90",onClick:s[2]||(s[2]=h=>v("del"))},[f(D(ce))])),[[i,a.hasDel]])],512)}}},ve=I(me,[["__scopeId","data-v-bcee1554"]]),he={class:"menu_list"},fe={class:"contents"},ye=["onClick"],be={__name:"Menu",props:{positions:{type:[Object],default:null}},emits:["use","clear"],setup(a,{emit:p}){const l=a,c=p,{getClientRect:m}=T(),v=U(null),n=[{title:"セリフ：主人公",type:""},{title:"セリフ：独り言",type:"",class:"!text-cyan-400 !dark:text-monolog"},{title:"セリフ：脇役",type:""},{title:"切り替え：背景",type:""},{title:"切り替え：BGM",type:""},{title:"演出：CG",type:""},{title:"演出：CG終了",type:""},{title:"演出：動画",type:""},{title:"演出：暗転",type:""},{title:"アナウンス",type:"",class:"!text-announce"},{title:"システム",type:"",class:"!text-announce"}],s=S(()=>{const{height:r}=m(document.documentElement),{height:x}=m(v.value),{x:C,y:d,width:u,height:b}=l.positions??{},e=(d??0)+(b??0)/2-(x??0)/2,$=(e<20?20:e)+"px",o=(r??0)-(x??0)-20+"px",H=`min(${$}, ${o})`,j=(C??0)+(u??0)+2+"px";return{top:H,left:j}}),i=S(()=>{const{x:r,y:x,width:C,height:d}=l.positions??{},u=(x??0)+(d??0)/2,b=(r??0)+(C??0)+3;return{top:u+"px",left:b+"px"}}),h=r=>{r.target.matches(".menu, .menu *")||c("clear",null)},k=r=>{c("use",{type:r}),c("clear",null)};return(r,x)=>{const C=V("visible");return y((_(),g("div",{class:"fixed inset-0 z-50 h-dvh w-dvw overflow-hidden",onClick:h},[t("div",{class:"menu_triangle",style:L(i.value)},null,4),t("div",{class:"menu scrollbar overflow-y-auto",style:L(s.value),ref_key:"menu",ref:v},[t("ul",he,[(_(),g(E,null,R(n,d=>t("li",fe,[t("button",{class:F(["menu_item",d.class]),onClick:u=>k(d.type)},A(d.title),11,ye)])),64))])],4)])),[[C,a.positions]])}}},xe=I(be,[["__scopeId","data-v-51efad7a"]]);function $e(){const{findData:a}=T(),p=(n,s)=>{const i=s.replace(/\s/g,"").toLowerCase().split(","),h=n.name.slice(n.name.lastIndexOf(".")).toLowerCase();return s!==""?i.includes(h):!0},l=n=>n instanceof Blob;return{isFileType:p,isBlobFile:l,blobUrl:(n,s)=>{const i=h=>h.slice(-1)==="/"?"":h;return l(n)?URL.createObjectURL(n):i(s??"")},getFileName:n=>{var i;n=n??"";const s=(i=n.lastIndexOf)==null?void 0:i.call(n,"/");return l(n)||s===-1?n:n.slice(s).slice(1)},getFilesData:(n,s)=>{const i=s.filter(r=>!r.id),h=n.filter(r=>!a(s,r.id)).map(r=>r.name),k=n.filter(r=>a(s,r.id));return{addList:i,delList:h,resultList:k}}}}const Ce={class:"upload"},ke={class:"upload_input"},De={class:"upload_image"},we=["src"],Be={__name:"Upload",props:{value:{type:[String],default:""},type:{type:[String],default:"contain"}},emits:["update:value"],setup(a,{emit:p}){const{blobUrl:l}=$e(),c=p,m=n=>{const s=n.target.files[0],i=l(s,"");c("update:value",i)},v=()=>c("update:value","");return(n,s)=>{const i=V("visible");return _(),g("div",Ce,[y((_(),g("label",ke,[f(D(z)),t("input",{class:"hidden",onChange:m,type:"file",accept:"image/*"},null,32)])),[[i,!a.value]]),y((_(),g("div",De,[t("img",{class:F(["h-full w-full",a.type==="cover"?"object-cover":"object-contain"]),src:a.value},null,10,we),t("button",{class:"upload_remove",onClick:v},[f(D(z),{class:"rotate-45"})])])),[[i,a.value]])])}}},O=I(Be,[["__scopeId","data-v-36f67343"]]),Ue={__name:"DropLine",props:{dragging:{type:[Boolean],default:!1}},emits:["drop"],setup(a,{emit:p}){const l=p,c=U(null),m=n=>{c.value.style.opacity=n?1:""},v=n=>{const s=n.dataTransfer.getData("text/plain");let i=null;try{i=JSON.parse(s)}catch{}m(!1),i!==null&&l("drop",i)};return(n,s)=>(_(),g("div",{class:F(["drag_line invisible opacity-0",{"!visible":a.dragging}]),onDragenter:s[0]||(s[0]=M(i=>m(!0),["prevent"])),onDragleave:s[1]||(s[1]=M(i=>m(!1),["prevent"])),onDragover:s[2]||(s[2]=M(()=>{},["prevent"])),onDrop:v,ref_key:"line",ref:c},null,34))}},N=I(Ue,[["__scopeId","data-v-55dbec76"]]),Le="/RonpaEditor-DEMO/assets/headshot_1-CxnizMm5.png",Me="/RonpaEditor-DEMO/assets/headshot_2-xVBmaB3M.png",Fe="/RonpaEditor-DEMO/assets/nametag_1-gPs7u1zN.png",Ie="/RonpaEditor-DEMO/assets/nametag_2-UDMsHms1.png",Ee=P("character",()=>{const a=U([{id:0,name:"？？？？",katakana:"？？？？",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",unknown:!0,is_drag:!0,dragging:!1},{id:1,name:"十六夜魔除",katakana:"イザヨイマヨ",name_bg:"#a64d79",name_text:"#ffff00",image_head:Le,image_name:Fe,is_hero:!0,is_drag:!0,dragging:!1},{id:2,name:"観月星知",katakana:"カンゲツセシル",name_bg:"#674ea7",name_text:"#d4c1a6",image_head:Me,image_name:Ie,is_hero:!1,is_drag:!0,dragging:!1}]),p=U({name:"",katakana:"",name_bg:"#222222",name_text:"#ffffff",image_head:"",image_name:"",is_hero:!1,is_drag:!0,dragging:!1});return{characterList:a,characterNew:p}});function Se(){return{dragMove:(l,c)=>{l.dataTransfer.dropEffect="move",l.dataTransfer.setData("text/plain",JSON.stringify(c))},dropMove:(l,c,m)=>{const[v]=l.splice(c,1),n=c>=m?m:m-1,s=n<0?0:n;l.splice(s,0,v)}}}const w=a=>(q("data-v-cad366d5"),a=a(),X(),a),Ve={class:"setting_wrap"},ze=w(()=>t("div",null,null,-1)),Te=w(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"アイコン"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc highlight"},"★ = 主人公")],-1)),Oe=w(()=>t("div",{class:"setting_head col-span-2"},[t("h2",{class:"setting_title"},"お名前"),t("p",{class:"setting_desc"},"EXCEL内表示")],-1)),Ne=w(()=>t("div",{class:"setting_head"},[t("h2",{class:"setting_title"},"名札"),t("p",{class:"setting_desc"},"ゲーム内表示"),t("p",{class:"setting_desc"},"（画像のない場合はカタカナ表示になります）")],-1)),Re=["draggable","onDragstart","onDragend"],He={key:0,class:"setting_avatar setting_unknown"},je={key:1,class:"setting_avatar"},Ae=["onClick"],Pe={class:"setting_detail",draggable:"false"},Ge=["onUpdate:modelValue","onFocus","onBlur"],Je={class:"setting_col"},qe=w(()=>t("p",{class:"ml-0.5"},"名前の色",-1)),Xe=["onUpdate:modelValue","onFocus","onBlur"],Ke=["onUpdate:modelValue"],Qe={class:"setting_detail"},We=["onUpdate:modelValue","onFocus","onBlur"],Ye={class:"setting_col"},Ze=w(()=>t("p",{class:"ml-0.5"},"名前の背景色",-1)),et=["onUpdate:modelValue","onFocus","onBlur"],tt=["onUpdate:modelValue"],st=w(()=>t("div",{class:"col-span-5 mb-4"},null,-1)),nt={__name:"Character",setup(a){const p=Ee(),{characterList:l,characterNew:c}=G(p),{dragMove:m,dropMove:v}=Se(),n=S(()=>l.value.some(d=>d.is_hero)),s=S(()=>l.value.some(d=>d.dragging)),i=d=>{const u={...c.value},b=[...l.value].sort((e,$)=>$.id-e.id)[0];u.id=b?b.id+1:0,l.value.splice(d+1,0,u)},h=d=>l.value.splice(d,1),k=(d,u,b)=>{b&&m(d,{index:u}),l.value[u].dragging=b},r=(d,u)=>v(l.value,d.index,u),x=U(null),C=d=>x.value=d;return(d,u)=>{const b=V("visible");return _(),g(E,null,[f(xe,{positions:x.value,onClear:C},null,8,["positions"]),t("div",Ve,[f(K,{col:"col-span-5"},{default:J(()=>[ze,Te,Oe,Ne]),_:1}),f(N,{class:"setting_dragline",onDrop:u[0]||(u[0]=e=>r(e,0)),dragging:s.value},null,8,["dragging"]),(_(!0),g(E,null,R(D(l),(e,$)=>(_(),g(E,{key:e.id},[t("div",{class:F(["setting_container",{dragging:e.dragging}]),draggable:e.is_drag,onDragstart:o=>k(o,$,!0),onDragend:o=>k(o,$,!1),onDrag:u[1]||(u[1]=M(()=>{},["prevent"])),onDrop:u[2]||(u[2]=M(()=>{},["prevent"]))},[f(ve,{class:"row-span-2 -mr-6",hasDel:!e.unknown,onAdd:o=>i($),onDel:o=>h($),onMore:C},null,8,["hasDel","onAdd","onDel"]),e.unknown?(_(),g("div",He)):(_(),g("div",je,[f(O,{class:"h-full w-full",value:e.image_head,"onUpdate:value":o=>e.image_head=o,type:"cover"},null,8,["value","onUpdate:value"]),y((_(),g("button",{class:F(["setting_star",{"setting_star-active":e.is_hero}]),onClick:o=>e.is_hero=!e.is_hero},[f(D(ee))],10,Ae)),[[b,!(n.value&&!e.is_hero)]])])),t("div",Pe,[y(t("input",{class:"setting_name last","onUpdate:modelValue":o=>e.name=o,style:L({"--name-bg":e.name_bg,"--name-text":e.name_text}),onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,44,Ge),[[B,e.name,void 0,{lazy:!0,trim:!0}]]),t("div",Je,[qe,y(t("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_text=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,Xe),[[B,e.name_text,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:L({"background-color":e.name_text})},[y(t("input",{class:"hidden","onUpdate:modelValue":o=>e.name_text=o,type:"color"},null,8,Ke),[[B,e.name_text,void 0,{lazy:!0}]])],4)])]),t("div",Qe,[y(t("input",{class:"setting_name first","onUpdate:modelValue":o=>e.katakana=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,We),[[B,e.katakana,void 0,{lazy:!0,trim:!0}]]),t("div",Ye,[Ze,y(t("input",{class:"setting_input","onUpdate:modelValue":o=>e.name_bg=o,onFocus:o=>e.is_drag=!1,onBlur:o=>e.is_drag=!0},null,40,et),[[B,e.name_bg,void 0,{lazy:!0,trim:!0}]]),t("label",{class:"setting_color",style:L({"background-color":e.name_bg})},[y(t("input",{class:"hidden","onUpdate:modelValue":o=>e.name_bg=o,type:"color"},null,8,tt),[[B,e.name_bg,void 0,{lazy:!0}]])],4)])]),f(O,{class:"setting_nametag",value:e.image_name,"onUpdate:value":o=>e.image_name=o},null,8,["value","onUpdate:value"])],42,Re),f(N,{class:"setting_dragline",onDrop:o=>r(o,$+1),dragging:s.value},null,8,["onDrop","dragging"])],64))),128)),st])],64)}}},lt=I(nt,[["__scopeId","data-v-cad366d5"]]);export{lt as default};
