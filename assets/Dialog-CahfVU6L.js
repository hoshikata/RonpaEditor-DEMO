import{_ as H,h as j,r as D,g as O,i as G,w as h,o as k,c as $,a as t,n as E,U as z,F as R,j as A,t as S,v as T,e as U,e9 as F,ea as K,u as g,eb as W,e3 as Z,e6 as ee,ec as te,H as se,s as N,f as oe,b as x,d_ as le,d$ as ae,d as ne}from"./index-Tpgw5ASB.js";import{a as ie}from"./round-close-YX2Y6b9k.js";const ce={class:"menu_list"},ue={class:"contents"},pe=["onClick"],de={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(s,{emit:m}){const d=s,r=m,{getClientRect:c}=j(),l=D(null),i=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：動画",type:"perform_anime"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"システム",type:"dialog_system",class:"!text-announce"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],u=O(()=>{const{width:e,height:b}=c(document.documentElement),{width:f,height:y}=c(l.value),{x:C,y:M,width:I,height:v}=d.positions??{},o=(M??0)+(v??0)/2-(y??0)/2,B=(o<20?20:o)+"px",n=(b??0)-(y??0)-20+"px",q=`min(${B}, ${n})`,J=(C??0)+(f??0)>e,Q=(C??0)+(I??0)+2,X=(C??0)-(f??0)-9-2,Y=(J?X:Q)+"px";return{top:q,left:Y}}),p=O(()=>{const{width:e}=c(document.documentElement),{width:b}=c(l.value),{x:f,y,width:C,height:M}=d.positions??{},I=(y??0)+(M??0)/2,v=(f??0)+(b??0)>e,o=(f??0)+(C??0)+3,B=(f??0)-3.2,n=v?B:o;return{top:I+"px",left:n+"px",turn:v}}),a=e=>{e.target.matches(".menu, .menu *")||r("clear",null)},w=e=>{r("use",{type:e}),r("clear",null)};return(e,b)=>{const f=G("visible");return h((k(),$("div",{class:"menu_container",onClick:a},[t("div",{class:E(["menu_triangle",{"-scale-x-100":p.value.turn}]),style:z(p.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:z(u.value),ref_key:"menu",ref:l},[t("ul",ce,[(k(),$(R,null,A(i,y=>t("li",ue,[h(t("button",{class:E(["menu_item",y.class]),onClick:C=>w(y.type)},S(y.title),11,pe),[[T,!(["edit","delete"].includes(y.type)&&s.onlyAdd)]])])),64))])],4)])),[[f,s.positions]])}}},pt=H(de,[["__scopeId","data-v-cce6ede3"]]),re=["disabled","placeholder"],L={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(s,{emit:m}){const d=s,r=m,c=D("");return U(c,l=>r("update:value",l)),U(()=>d.value,l=>c.value=l,{immediate:!0}),(l,i)=>{const u=G("verify");return h((k(),$("input",{"onUpdate:modelValue":i[0]||(i[0]=p=>c.value=p),disabled:s.disabled,placeholder:s.disabled?"":s.placeholder},null,8,re)),[[F,c.value,void 0,{lazy:!0,trim:!0}],[u,void 0,void 0,{check:!0}]])}}},ve=["disabled","placeholder"],_e=["value"],he={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(s,{emit:m}){K(i=>({"4ad1a84a":g(c).light.text}));const d=s,r=m,{colors:c}=W(),l=D("");return U(l,i=>r("update:value",i)),U(()=>d.value,i=>l.value=i,{immediate:!0}),(i,u)=>{const p=G("verify");return h((k(),$("select",{class:"select","onUpdate:modelValue":u[0]||(u[0]=a=>l.value=a),disabled:s.disabled,placeholder:s.disabled?"":s.placeholder},[ee(i.$slots,"default",{},void 0,!0),(k(!0),$(R,null,A(s.options,a=>h((k(),$("option",{value:a.id??a},S(a.title??a.id??a),9,_e)),[[T,a.show??!0]])),256))],8,ve)),[[Z,l.value,void 0,{lazy:!0,trim:!0}],[p,void 0,void 0,{check:!0}]])}}},V=H(he,[["__scopeId","data-v-1b98bee5"]]),me=["disabled","placeholder"],P={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(s,{emit:m}){const d=s,r=m,c=D(null),l=D(""),i=u=>{if(!u.ctrlKey)return;const{selectionStart:p,selectionEnd:a}=c.value;r("selected",{start:p,end:a})};return U(l,u=>r("update:value",u)),U(()=>d.value,u=>l.value=u,{immediate:!0}),(u,p)=>{const a=G("verify");return h((k(),$("textarea",{class:"scrollbar min-h-0 resize-none","onUpdate:modelValue":p[0]||(p[0]=w=>l.value=w),disabled:s.disabled,placeholder:s.disabled?"":s.placeholder,onKeydown:te(i,["q"]),ref_key:"textarea",ref:c},null,40,me)),[[F,l.value,void 0,{lazy:!0,trim:!0}],[a,void 0,void 0,{check:!0}]])}}},_=s=>(le("data-v-6208f0e3"),s=s(),ae(),s),fe={class:"popup_window"},ye={class:"popup_header"},we={class:"popup_close",title:"キャンセル"},ge={class:"popup_container scrollbar"},be={class:"contents"},xe={class:"contents"},Se={class:"popup_label"},ke=_(()=>t("div",{class:"col-span-2"},null,-1)),$e={class:"contents"},Ce=_(()=>t("span",{class:"popup_label"},"内容",-1)),Te={class:"contents"},Be={class:"contents"},Ee=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Ue={class:"popup_input"},De={class:"contents"},Me=_(()=>t("span",{class:"popup_label"},"話し手",-1)),Ie=_(()=>t("div",{class:"col-span-2"},null,-1)),Oe={class:"contents"},Ge=_(()=>t("span",{class:"popup_label"},"主人公差分",-1)),He={class:"popup_input"},Le={class:"contents"},Ve=_(()=>t("span",{class:"popup_label"},"主人公エフェクト",-1)),Ne={class:"popup_input"},ze={class:"contents"},Pe=_(()=>t("span",{class:"popup_label"},"脇役",-1)),je={class:"popup_input"},Re={class:"contents"},Ae=_(()=>t("span",{class:"popup_label"},"脇役差分",-1)),Fe={class:"popup_input"},Ke={class:"contents"},We=_(()=>t("span",{class:"popup_label"},"脇役エフェクト",-1)),qe={class:"popup_input"},Je={class:"col-span-2 flex justify-end gap-3"},Qe={class:"contents"},Xe=_(()=>t("span",{class:"popup_label"},"セリフ",-1)),Ye={class:"contents"},Ze=_(()=>t("span",{class:"popup_label"},"SE",-1)),et={class:"contents"},tt=_(()=>t("span",{class:"popup_label"},"ボイス",-1)),st={class:"contents"},ot=_(()=>t("span",{class:"popup_label"},"備考",-1)),lt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","save"],setup(s,{emit:m}){const d=s,r=m,c=se(),{characterList:l}=N(c),i=oe(),{newChapter:u}=i,{chapterData:p}=N(i),{isDev:a,findData:w}=j(),e=D({}),b=O(()=>[{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform},{id:"動畫",show:e.value.is_perform}]),f=[{id:"",title:"全"},{id:"前"},{id:"後"},{id:"續"}],y=O(()=>l.value.map(v=>({id:v.name}))),C=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},M=()=>{if(d.id==="add")p.value.push({...e.value});else{const v=w(p.value,d.id);Object.assign(v,{...e.value})}r("update:open",!1)},I=v=>{const o=v.target.matches(".popup_window, .popup_window *"),B=v.target.matches(".popup_close");(!o||B)&&r("update:open",!1)};return U(()=>d.open,v=>{v&&(d.id==="add"?e.value=u(d.type):e.value={...w(p.value,d.id)},a&&console.log({...e.value}))}),(v,o)=>{const B=G("visible");return h((k(),$("div",{class:"popup",onClick:I},[t("section",fe,[t("header",ye,[t("button",we,[x(g(ie),{class:"pointer-events-none"})])]),t("div",ge,[h(t("div",be,[t("div",xe,[t("span",Se,S(e.value.人物),1),x(V,{class:"popup_select",value:e.value.show_time,"onUpdate:value":o[0]||(o[0]=n=>e.value.show_time=n),options:b.value,onChange:C},null,8,["value","options"])]),ke,t("div",$e,[Ce,h(x(L,{class:"popup_input col-span-3",value:e.value.show_name,"onUpdate:value":o[1]||(o[1]=n=>e.value.show_name=n)},null,8,["value"]),[[T,e.value.show_time!=="暗場"]]),h(x(V,{class:"popup_select col-span-3",value:e.value.show_name,"onUpdate:value":o[2]||(o[2]=n=>e.value.show_name=n),options:f},null,8,["value"]),[[T,e.value.show_time==="暗場"]])])],512),[[T,e.value.is_showtime]]),h(t("div",Te,[h(t("div",Be,[Ee,t("span",Ue,S(e.value.人物),1)],512),[[T,e.value.is_announce||e.value.is_system]]),h(t("div",De,[Me,x(V,{class:"popup_select",value:e.value.人物,"onUpdate:value":o[3]||(o[3]=n=>e.value.人物=n),options:y.value},null,8,["value","options"])],512),[[T,!(e.value.is_announce||e.value.is_system)]]),Ie,t("div",Oe,[Ge,t("span",He,S(e.value.十六夜差分),1)]),t("div",Le,[Ve,t("span",Ne,S(e.value.主角特效),1)]),t("div",ze,[Pe,t("span",je,S(e.value.顯示角色),1)]),t("div",Re,[Ae,t("span",Fe,S(e.value.角色差分),1)]),t("div",Ke,[We,t("span",qe,S(e.value.差分特效),1)]),t("div",Je,[t("button",{class:E(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:o[4]||(o[4]=n=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:E(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:o[5]||(o[5]=n=>e.value.is_unknown=!e.value.is_unknown),title:"未紹介"},"未紹介",2),t("button",{class:E(["popup_switch -monolog",{"-active":e.value.is_solo}]),onClick:o[6]||(o[6]=n=>e.value.is_solo=!e.value.is_solo),title:"独り言"},"独り言",2)]),t("div",Qe,[Xe,x(P,{class:"popup_input col-span-3 h-32",value:e.value.和訳,"onUpdate:value":o[7]||(o[7]=n=>e.value.和訳=n)},null,8,["value"])]),t("div",Ye,[Ze,x(L,{class:"popup_input",value:e.value.SE,"onUpdate:value":o[8]||(o[8]=n=>e.value.SE=n)},null,8,["value"])]),t("div",et,[tt,x(L,{class:"popup_input",value:e.value.Voice,"onUpdate:value":o[9]||(o[9]=n=>e.value.Voice=n)},null,8,["value"])])],512),[[T,!e.value.is_showtime]]),t("div",st,[ot,x(P,{class:"popup_input col-span-3 h-32",value:e.value.備註,"onUpdate:value":o[10]||(o[10]=n=>e.value.備註=n)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:M,title:"セーフ"},"セーフ")])])])),[[B,s.open]])}}},dt=H(lt,[["__scopeId","data-v-6208f0e3"]]),at={class:"dialog_wrap"},nt=["data-content","innerHTML"],it={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(s){K(a=>({"35896f63":g(l).lineHeight,"4d5ca058":g(l).letterSpace,"15be853d":g(l).fontLength,f66c4386:g(i).keyword.dark,"729921a5":g(i).monolog.dark,"0085a039":g(i).announce.dark}));const m=s,d=ne(),{fontFamily:r,fontWeight:c,fontStyle:l}=N(d),{colors:i}=W(),u=O(()=>{const a=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),w=p("keyword"),b=m.value.replace(a,`<span class="${w}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:m.value.replace(/\[|\]/g,""),html:b}}),p=a=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[a]??"text-white";return(a,w)=>(k(),$("div",{class:E(["dialog",[g(r).dialog,g(c).dialog]])},[t("div",at,[t("pre",{class:E(p(s.type)),"data-content":u.value.value,innerHTML:u.value.html},null,10,nt)])],2))}},rt=H(it,[["__scopeId","data-v-0b46230a"]]);export{rt as D,dt as E,pt as M};
