import{_ as q,p as ee,r as K,j as w,x as H,w as m,o as I,c as D,a as t,n as M,k as Y,F as ce,y as de,t as j,v as k,g as F,M as ve,G as _e,u as re,s as z,h as he,b as me,e as i,d as O,C,K as fe,L as ge}from"./index-CyJrGj8D.js";/* empty css                                                             */import{S as g,_ as A}from"./Dialog-CESR4OxB.js";const we={class:"menu_list"},ye={class:"contents"},be=["onClick","title"],xe={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(a,{emit:L}){const p=a,u=L,{getClientRect:r}=ee(),c=K(null),B=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],d=w(()=>{const{width:v,height:b}=r(document.documentElement),{width:f,height:_}=r(c.value),{x,y:N,width:P,height:$}=p.positions??{},S=(N??0)+($??0)/2-(_??0)/2,T=(S<20?20:S)+"px",E=(b??0)-(_??0)-20+"px",W=`min(${T}, ${E})`,J=(x??0)+(f??0)>v,R=(x??0)+(P??0)+2,V=(x??0)-(f??0)-9-2,e=(J?V:R)+"px";return{top:W,left:e}}),h=w(()=>{const{width:v}=r(document.documentElement),{width:b}=r(c.value),{x:f,y:_,width:x,height:N}=p.positions??{},P=(_??0)+(N??0)/2,$=(f??0)+(b??0)>v,S=(f??0)+(x??0)+3,T=(f??0)-3.2,E=$?T:S;return{top:P+"px",left:E+"px",turn:$}}),y=v=>{v.target.matches(".menu, .menu *")||u("clear",null)},U=v=>{u("use",{type:v}),u("clear",null)};return(v,b)=>{const f=H("visible");return m((I(),D("div",{class:"menu_container",onClick:y},[t("div",{class:M(["menu_triangle",{"-scale-x-100":h.value.turn}]),style:Y(h.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:Y(d.value),ref_key:"menu",ref:c},[t("ul",we,[(I(),D(ce,null,de(B,_=>t("li",ye,[m(t("button",{class:M(["menu_item",_.class]),onClick:x=>U(_.type),title:_.title},j(_.title),11,be),[[k,!(["copy","edit","delete"].includes(_.type)&&a.onlyAdd)]])])),64))])],4)])),[[f,a.positions]])}}},Tt=q(xe,[["__scopeId","data-v-e4cfe076"]]),Se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Ce=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),ke=[Ce];function Le(a,L){return I(),D("svg",Se,[...ke])}const Ue={name:"ic-round-close",render:Le},$e=["disabled","placeholder"],Be={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(a,{emit:L}){const p=a,u=L,r=K(null),c=K(""),B=d=>{if(!d.ctrlKey)return;const{selectionStart:h,selectionEnd:y}=r.value;u("selected",{start:h,end:y})};return F(c,d=>u("update:value",d)),F(()=>p.value,d=>c.value=d,{immediate:!0}),(d,h)=>{const y=H("verify");return m((I(),D("textarea",{class:"scrollbar textarea","onUpdate:modelValue":h[0]||(h[0]=U=>c.value=U),disabled:a.disabled,placeholder:a.disabled?"":a.placeholder,onKeydown:_e(B,["q"]),ref_key:"textarea",ref:r},null,40,$e)),[[ve,c.value,void 0,{lazy:!0,trim:!0}],[y,void 0,void 0,{check:!0}]])}}},Z=q(Be,[["__scopeId","data-v-c1e57f9a"]]),n=a=>(fe("data-v-b7690e14"),a=a(),ge(),a),Te={class:"popup_window"},Ee={class:"popup_header"},Ge={class:"popup_close",title:"キャンセル"},Oe={class:"popup_container scrollbar"},Me={class:"contents"},Ie={class:"contents"},De={class:"popup_label"},Ne=n(()=>t("div",{class:"-col-2"},null,-1)),Pe={class:"contents"},Ve=n(()=>t("span",{class:"popup_label"},"内容",-1)),je={value:""},Ke={class:"contents"},Re={class:"contents"},ze=n(()=>t("span",{class:"popup_label"},"話し手",-1)),Ae={class:"popup_input"},Fe={class:"contents"},qe=n(()=>t("span",{class:"popup_label"},"話し手",-1)),He={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},We={class:"popup_group"},Je=n(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Qe={class:"contents"},Xe=n(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),Ye=n(()=>t("option",{value:""},"無指定",-1)),Ze={class:"contents"},et=n(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),tt=n(()=>t("option",{value:""},"引き継ぎ",-1)),st={class:"contents"},ot=n(()=>t("span",{class:"popup_label"},"エフェクト",-1)),lt=n(()=>t("option",{value:""},"なし",-1)),nt={class:"popup_group"},at=n(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),it={class:"contents"},pt=n(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),ut=n(()=>t("option",{value:""},"無指定",-1)),ct={class:"contents"},dt=n(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),vt=n(()=>t("option",{value:""},"引き継ぎ",-1)),_t={class:"contents"},rt=n(()=>t("span",{class:"popup_label"},"エフェクト",-1)),ht=n(()=>t("option",{value:""},"なし",-1)),mt={class:"contents"},ft=n(()=>t("span",{class:"popup_label"},"SE",-1)),gt={class:"contents"},wt=n(()=>t("span",{class:"popup_label"},"ボイス",-1)),yt={class:"contents"},bt=n(()=>t("span",{class:"popup_label"},"セリフ",-1)),xt={class:"-col-3 grid gap-1"},St=n(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),Ct={class:"contents"},kt=n(()=>t("span",{class:"popup_label"},"備考",-1)),Lt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(a,{emit:L}){const p=a,u=L,r=re(),{getCharacter:c}=r,{characterList:B,characterReals:d}=z(r),h=he(),{newLog:y}=h,{chapterData:U}=z(h),v=me(),{blackList:b,getEffect:f,getBackground:_,getCg:x,getBgm:N,getSe:P}=v,{uiList:$,effectList:S,backgroundList:T,cgList:E,bgmList:W,seList:J}=z(v),{isDev:R,findData:V}=ee(),e=K({}),te=w(()=>{var l;return(l=c(e.value.人物))==null?void 0:l.name}),se=w(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform},{id:"動畫",show:e.value.is_perform}]),oe=w(()=>{const l=e.value.show_time;if(l==="UI")return $.value;if(l==="BG")return T.value;if(l==="CG")return E.value;if(l==="暗場")return b}),le=w(()=>B.value.filter(l=>!l.disabled||l.unknown)),ne=w(()=>Q(e.value.顯示角色)),ae=w(()=>Q(e.value.立ち絵2)),Q=l=>{var s;return((s=c(l))==null?void 0:s.sprite)??[]},ie=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},X=l=>e.value[l]="",pe=()=>{const l={...e.value};if(p.id==="add")u("add",l);else{const G=V(U.value,p.id);Object.assign(G,l)}u("update:open",!1),(!l.is_showtime||l.show_time==="暗場")&&u("target",l.id)},ue=l=>{const s=l.target.matches(".popup_window, .popup_window *"),G=l.target.matches(".popup_close");(!s||G)&&u("update:open",!1)};return F(()=>p.open,l=>{l&&(p.id==="add"?e.value=y(p.type):e.value={...V(U.value,p.id)},R&&console.log({...e.value}))}),(l,s)=>{const G=H("visible");return m((I(),D("section",{class:"popup",onClick:ue},[t("div",Te,[t("header",Ee,[t("button",Ge,[i(O(Ue),{class:"pointer-events-none"})])]),t("div",Oe,[m(t("div",Me,[t("div",Ie,[t("span",De,j(e.value.人物),1),i(g,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:se.value,onChange:ie},null,8,["value","options"])]),Ne,t("div",Pe,[Ve,m(i(A,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[k,e.value.show_time==="BGM"]]),m(i(g,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:oe.value},{default:C(()=>[t("option",je,j(e.value.show_time==="暗場"?"フェード":"なし"),1)]),_:1},8,["value","options"]),[[k,e.value.show_time!=="BGM"]])])],512),[[k,e.value.is_showtime]]),m(t("div",Ke,[m(t("div",Re,[ze,t("span",Ae,j(te.value),1)],512),[[k,e.value.is_announce||e.value.is_system]]),m(t("div",Fe,[qe,i(g,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:le.value},null,8,["value","options"])],512),[[k,!(e.value.is_announce||e.value.is_system)]]),t("div",He,[t("button",{class:M(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:M(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:M(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",We,[Je,t("div",Qe,[Xe,i(g,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),options:O(d),onChange:s[8]||(s[8]=o=>X("角色差分"))},{default:C(()=>[Ye]),_:1},8,["value","options"])]),t("div",Ze,[et,i(g,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:ne.value},{default:C(()=>[tt]),_:1},8,["value","options"])]),t("div",st,[ot,i(g,{class:"popup_select",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o),options:O(S)},{default:C(()=>[lt]),_:1},8,["value","options"])])]),t("div",nt,[at,t("div",it,[pt,i(g,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),options:O(d),onChange:s[12]||(s[12]=o=>X("十六夜差分"))},{default:C(()=>[ut]),_:1},8,["value","options"])]),t("div",ct,[dt,i(g,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:ae.value},{default:C(()=>[vt]),_:1},8,["value","options"])]),t("div",_t,[rt,i(g,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o),options:O(S)},{default:C(()=>[ht]),_:1},8,["value","options"])])]),t("div",mt,[ft,i(A,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",gt,[wt,i(A,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",yt,[bt,t("div",xt,[i(Z,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),St])])],512),[[k,!e.value.is_showtime]]),t("div",Ct,[kt,i(Z,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:pe,title:"保存"},"保存")])])])),[[G,a.open]])}}},Et=q(Lt,[["__scopeId","data-v-b7690e14"]]);export{Et as E,Tt as M};
