import{_ as T,r as C,e as J,o as r,c as h,w as v,e9 as re,a as s,n as _,t as l,ea as Z,M as ee,g as N,m as se,b as i,h as de,e4 as E,d as _e,s as K,f as ue,k as pe,e5 as he,q as L,e6 as b,p as Q,u as f,F as z,v as F,eb as U,e2 as ve,e3 as ge}from"./index-DXMknspr.js";import{I as me}from"./round-close-yRZ1m-84.js";import{W as fe}from"./Wrap-B_Uv8EHa.js";import{C as R,D as X,u as be}from"./useDrag-BpmsjtGT.js";import{_ as ye,D as De,M as we,E as ke}from"./Image-Da9sD3jg.js";import{M as xe}from"./Mark-DPAai1ch.js";const Se=["disabled"],Ce={class:"whitespace-nowrap"},Ie={__name:"Checkbox",props:{value:{type:[Number],default:0},disabled:{type:[Boolean],default:!1},title:{type:[String],default:""},box:{type:[String],default:""}},emits:["update:value"],setup(c,{emit:g}){const D=c,x=g,d=C(0);return J(d,m=>x("update:value",m)),J(()=>D.value,m=>d.value=m,{immediate:!0}),(m,S)=>(r(),h("label",{class:_(["inline-flex items-center",c.disabled?"cursor-auto":"cursor-pointer"])},[v(s("input",{class:_(["checkbox",c.box]),"onUpdate:modelValue":S[0]||(S[0]=w=>d.value=w),disabled:c.disabled,"true-value":1,"false-value":0,type:"checkbox"},null,10,Se),[[re,d.value]]),s("span",Ce,l(c.title),1),Z(m.$slots,"default",{},void 0,!0)],2))}},Y=T(Ie,[["__scopeId","data-v-b7a95cdd"]]),Me={__name:"Switch",props:{active:{type:[Boolean],default:!1}},setup(c){return(g,D)=>(r(),h("button",{class:_(["switch",{"bg-current":c.active}])},[s("span",{class:_(["-mt-0.1em",{"text-white":c.active}])},[Z(g.$slots,"default",{},void 0,!0)],2)],2))}},B=T(Me,[["__scopeId","data-v-8bd1e4e9"]]),$e={class:"avatar"},Ae={__name:"Avatar",props:{name:{type:[String],default:""}},setup(c){const g=c,D=ee(),{getCharacter:x}=D,d=N(()=>x(g.name)),m=N(()=>g.name.replaceAll(/\s|=|＝|‧|・/g,`
`));return(S,w)=>{const I=se("visible");return r(),h("div",$e,[v(i(ye,{src:d.value.image_head},null,8,["src"]),[[I,d.value.image_head]]),v((r(),h("div",{class:"avatar_text",style:de({color:d.value.name_text,"background-color":d.value.name_bg})},[E(l(m.value),1)],4)),[[I,!d.value.image_head]])])}}},Le=T(Ae,[["__scopeId","data-v-57da6b2f"]]),y=c=>(ve("data-v-3d8f9547"),c=c(),ge(),c),Ue={class:"side_list"},Be={class:"flex"},Ee=["onClick","title"],Ne={class:"chapter_head"},Te={class:"mr-9 grid xl:mr-0"},Ve=["title"],Pe={class:"chapter_log"},ze={class:"chapter_log_tr -lock"},Fe={class:"mx-2 w-12 self-center"},Re=y(()=>s("div",{class:"chapter_log_th xl:ml-0"},"セリフ＆切り替え＆演出",-1)),We=y(()=>s("div",{class:"ml-3 w-7 shrink-0 xl:hidden"},null,-1)),qe=y(()=>s("div",{class:"chapter_log_tr_2 -lock"},[s("div",{class:"chapter_log_th -col"},"立ち絵1．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"立ち絵2．差分＆エフェクト"),s("div",{class:"chapter_log_th -col"},"SE＆ボイス"),s("div",{class:"chapter_log_th -col"},"備考")],-1)),Ge={key:0,class:"contents"},Oe=["onDragstart","onDragend"],je={class:"chapter_log_scene"},He=y(()=>s("div",{class:"chapter_log_switches xl:hidden"},null,-1)),Je={class:"chapter_log_tr_2"},Ke=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Qe=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Xe=y(()=>s("div",{class:"chapter_log_td -col"},null,-1)),Ye={class:"chapter_log_td -col"},Ze={class:"-inner"},es={key:1,class:"contents"},ss=["onDragstart","onDragend"],ts={class:"chapter_log_comment"},as={class:"chapter_log_switches"},os={class:"chapter_log_tr_2"},ls={class:"chapter_log_td -col"},cs={class:"-inner col-span-2"},ns={class:"-inner"},is={class:"-inner"},rs={class:"chapter_log_td -col"},ds={class:"-inner col-span-2"},_s={class:"-inner"},us={class:"-inner"},ps={class:"chapter_log_td -col"},hs={class:"-inner"},vs={class:"-inner"},gs={class:"chapter_log_td -col"},ms={class:"-inner"},fs={__name:"Chapters",setup(c){const g=_e();K(g);const D=ee(),{getCharacter:x}=D,d=ue(),{newChapter:m,dialogType:S}=d,{chapterIndex:w,chapterNames:I,chapterTitle:W,chapterData:p}=K(d),{findData:te,findIndex:ae}=pe(),{dragMove:oe,dropMove:le}=be(),ce=o=>x(o.人物),q=N(()=>p.value.some(o=>o.dragging)),V=N(()=>p.value.filter(o=>o.is_selected).map(o=>o.id)),M=(o,t,u)=>{u&&oe(o,{index:t}),V.value.some(n=>p.value[t].id===n)||(p.value[t].is_selected=1),V.value.forEach(n=>{const a=te(p.value,n);a.dragging=u,u||(a.is_selected=0)})},G=(o,t)=>{V.value.forEach(u=>{const e=ae(p.value,u);le(p.value,e,t)})},O=C(!1),$=C(0),j=C(null),A=(o,t)=>{$.value=t,j.value=o,O.value=t===null},ne=({type:o})=>{const t=$.value,u=p.value[t];o==="delete"?u.is_delete=!0:o==="edit"?H(u.id,{}):H("add",{type:o})},P=C(!1),k=he({id:0,type:"",index:0}),H=(o,{type:t})=>{k.id=o,k.type=t??"",k.index=$.value,P.value=!0},ie=o=>{const t=$.value===null?p.value.length:k.index+1;p.value.splice(t,0,o)};return(o,t)=>{const u=se("visible");return r(),L(fe,null,{side:b(()=>[s("ul",Ue,[(r(!0),h(z,null,Q(f(I),(e,n)=>(r(),h("li",Be,[i(xe,{class:"chapter_mark",active:n===f(w)},null,8,["active"]),s("button",{class:_(["side_item",{"side_item-active":n===f(w)}]),onClick:a=>w.value=n,title:e},l(e),11,Ee)]))),256))])]),main_head:b(()=>[s("header",Ne,[s("div",Te,[s("h1",{class:"chapter_head_title",title:f(W)},l(f(W)),9,Ve)])])]),default:b(()=>[s("div",Pe,[s("div",ze,[s("div",Fe,[i(B,{class:"chapter_plus"},{default:b(()=>[i(f(me),{class:"mt-0.1em"}),i(R,{class:"absolute left-0 top-0 opacity-0",onMore:t[0]||(t[0]=e=>A(e,null)),hasDel:!1,hasAdd:!1})]),_:1})]),Re,We]),qe,i(X,{class:"chapter_log_dragline",onDrop:t[1]||(t[1]=e=>G(e,0)),dragging:q.value},null,8,["dragging"]),(r(!0),h(z,null,Q(f(p),(e,n)=>(r(),h(z,{key:e.id},[e.is_showtime?v((r(),h("section",Ge,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:!0,onDragstart:a=>M(a,n,!0),onDragend:a=>M(a,n,!1),onDrag:t[2]||(t[2]=U(()=>{},["prevent"])),onDrop:t[3]||(t[3]=U(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[i(Y,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),i(R,{class:"chapter_log_control",onMore:a=>A(a,n),hasDel:!1,hasAdd:!1},null,8,["onMore"]),s("div",je,[s("span",null,l(e.人物),1),s("span",null,l(e.show_time),1),s("span",null,l(e.show_name),1)])],2),He],42,Oe),s("div",Je,[Ke,Qe,Xe,s("div",Ye,[s("div",Ze,l(e.備註),1)])])],512)),[[F,!e.is_delete]]):v((r(),h("section",es,[s("div",{class:_(["chapter_log_tr",{"-dragging":e.dragging}]),draggable:!0,onDragstart:a=>M(a,n,!0),onDragend:a=>M(a,n,!1),onDrag:t[4]||(t[4]=U(()=>{},["prevent"])),onDrop:t[5]||(t[5]=U(()=>{},["prevent"]))},[s("div",{class:_(["chapter_log_td -first",{"bg-secondary/60":e.is_selected}])},[i(Y,{class:"chapter_log_check",value:e.is_selected,"onUpdate:value":a=>e.is_selected=a},null,8,["value","onUpdate:value"]),i(R,{class:"chapter_log_control",onMore:a=>A(a,n),onDel:a=>e.is_delete=!0,hasDel:!1,hasAdd:!1},null,8,["onMore","onDel"]),s("div",{class:_(["chapter_log_info",{"flex-row-reverse":ce(e).is_hero,"-replay":e.is_replay}])},[i(Le,{class:"chapter_log_avatar",name:e.人物},null,8,["name"]),s("div",ts,[i(De,{class:"chapter_log_dialog",value:e.和訳,type:f(S)(e)},null,8,["value","type"])])],2)],2),s("div",as,[v((r(),L(B,{class:_(["chapter_log_switch",{"text-replay":e.is_replay}]),active:e.is_replay,title:"再放送"},{default:b(()=>[E("R")]),_:2},1032,["active","class"])),[[u,e.is_replay]]),v((r(),L(B,{class:_(["chapter_log_switch",{"text-unknown":e.is_unknown}]),active:e.is_unknown,title:"未解明"},{default:b(()=>[E("U")]),_:2},1032,["active","class"])),[[u,e.is_unknown]]),v((r(),L(B,{class:_(["chapter_log_switch",{"-monolog":e.is_monolog}]),active:e.is_monolog,title:"独り言"},{default:b(()=>[E("S")]),_:2},1032,["active","class"])),[[u,e.is_monolog]])])],42,ss),s("div",os,[s("div",ls,[s("div",cs,l(e.顯示角色),1),s("div",ns,l(e.角色差分),1),s("div",is,l(e.差分特效),1)]),s("div",rs,[s("div",ds,l(e.立ち絵2),1),s("div",_s,l(e.十六夜差分),1),s("div",us,l(e.主角特效),1)]),s("div",ps,[s("div",hs,l(e.SE),1),s("div",vs,l(e.Voice),1)]),s("div",gs,[s("div",ms,l(e.備註),1)])])],512)),[[F,!e.is_delete]]),v(i(X,{class:"chapter_log_dragline",onDrop:a=>G(a,n+1),dragging:q.value},null,8,["onDrop","dragging"]),[[F,!e.is_delete]])],64))),128))]),i(we,{positions:j.value,onClear:A,onUse:ne,onlyAdd:O.value},null,8,["positions","onlyAdd"]),i(ke,{open:P.value,"onUpdate:open":t[6]||(t[6]=e=>P.value=e),id:k.id,type:k.type,onAdd:ie},null,8,["open","id","type"])]),_:1})}}},Ss=T(fs,[["__scopeId","data-v-3d8f9547"]]);export{Ss as default};
