import{_ as P,k as J,r as N,g as B,m as A,w as m,o as f,c as g,a as t,n as I,h as W,F as R,p as j,t as G,v as $,e as E,K as Q,L as X,u as C,M as Y,C as ee,G as te,N as se,y as oe,s as F,f as le,b as h,B as z,I as ae,J as ne,d as ie}from"./index-BA0hwjmF.js";import"./IconDelete-DaMGOccu.js";const ue={class:"menu_list"},ce={class:"contents"},pe=["onClick","title"],de={__name:"Menu",props:{positions:{type:[Object],default:null},onlyAdd:{type:[Boolean],default:!1}},emits:["use","clear"],setup(l,{emit:y}){const r=l,v=y,{getClientRect:c}=J(),a=N(null),p=[{title:"セリフ",type:"dialog"},{title:"セリフ：主人公",type:"dialog_hero"},{title:"切り替え：UI",type:"scene_ui"},{title:"切り替え：背景",type:"scene_bg"},{title:"切り替え：BGM",type:"scene_bgm"},{title:"演出：CG",type:"perform_cg"},{title:"演出：CG終了",type:"perform_cg_end"},{title:"演出：暗転",type:"perform_black"},{title:"アナウンス",type:"dialog_announce",class:"!text-announce"},{title:"ナレーション",type:"dialog_system",class:"!text-announce"},{title:"コピー",type:"copy",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"編集",type:"edit",class:"!bg-secondary/50 !text-white hover:!bg-secondary/75"},{title:"削除",type:"delete",class:"!bg-red-500/50 !text-white hover:!bg-red-500/75"}],d=B(()=>{const{width:w,height:e}=c(document.documentElement),{width:x,height:b}=c(a.value),{x:k,y:M,width:O,height:D}=r.positions??{},L=(M??0)+(D??0)/2-(b??0)/2,V=(L<20?20:L)+"px",H=(e??0)-(b??0)-20+"px",n=`min(${V}, ${H})`,s=(k??0)+(x??0)>w,S=(k??0)+(O??0)+2,o=(k??0)-(x??0)-9-2,Z=(s?o:S)+"px";return{top:n,left:Z}}),_=B(()=>{const{width:w}=c(document.documentElement),{width:e}=c(a.value),{x,y:b,width:k,height:M}=r.positions??{},O=(b??0)+(M??0)/2,D=(x??0)+(e??0)>w,L=(x??0)+(k??0)+3,V=(x??0)-3.2,H=D?V:L;return{top:O+"px",left:H+"px",turn:D}}),i=w=>{w.target.matches(".menu, .menu *")||v("clear",null)},U=w=>{v("use",{type:w}),v("clear",null)};return(w,e)=>{const x=A("visible");return m((f(),g("div",{class:"menu_container",onClick:i},[t("div",{class:I(["menu_triangle",{"-scale-x-100":_.value.turn}]),style:W(_.value)},null,6),t("div",{class:"menu scrollbar overflow-y-auto",style:W(d.value),ref_key:"menu",ref:a},[t("ul",ue,[(f(),g(R,null,j(p,b=>t("li",ce,[m(t("button",{class:I(["menu_item",b.class]),onClick:k=>U(b.type),title:b.title},G(b.title),11,pe),[[$,!(["copy","edit","delete"].includes(b.type)&&l.onlyAdd)]])])),64))])],4)])),[[x,l.positions]])}}},$t=P(de,[["__scopeId","data-v-e4cfe076"]]),re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ve=t("path",{fill:"currentColor",d:"M18.3 5.71a.996.996 0 0 0-1.41 0L12 10.59L7.11 5.7A.996.996 0 1 0 5.7 7.11L10.59 12L5.7 16.89a.996.996 0 1 0 1.41 1.41L12 13.41l4.89 4.89a.996.996 0 1 0 1.41-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4"},null,-1),_e=[ve];function he(l,y){return f(),g("svg",re,[..._e])}const me={name:"ic-round-close",render:he},fe=["disabled","placeholder"],K={__name:"Input",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:y}){const r=l,v=y,c=N("");return E(c,a=>v("update:value",a)),E(()=>r.value,a=>c.value=a,{immediate:!0}),(a,p)=>{const d=A("verify");return m((f(),g("input",{"onUpdate:modelValue":p[0]||(p[0]=_=>c.value=_),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},null,8,fe)),[[Q,c.value,void 0,{lazy:!0,trim:!0}],[d,void 0,void 0,{check:!0}]])}}},ge=["disabled","placeholder"],ye=["value"],we={__name:"Select",props:{value:{type:[String,Number],default:""},options:{type:[Array],default:()=>[]},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value"],setup(l,{emit:y}){X(p=>({"4ad1a84a":C(c).light.text}));const r=l,v=y,{colors:c}=Y(),a=N("");return E(a,p=>v("update:value",p)),E(()=>r.value,p=>a.value=p,{immediate:!0}),(p,d)=>{const _=A("verify");return m((f(),g("select",{class:"select","onUpdate:modelValue":d[0]||(d[0]=i=>a.value=i),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder},[te(p.$slots,"default",{},void 0,!0),(f(!0),g(R,null,j(l.options,i=>m((f(),g("option",{value:i.id??i},G(i.title??i.id??i),9,ye)),[[$,i.show??!0]])),256))],8,ge)),[[ee,a.value,void 0,{lazy:!0,trim:!0}],[_,void 0,void 0,{check:!0}]])}}},T=P(we,[["__scopeId","data-v-1b98bee5"]]),be=["disabled","placeholder"],xe={__name:"Textarea",props:{value:{type:[String,Number],default:""},disabled:{type:[Boolean],default:!1},placeholder:{type:[String],default:""}},emits:["update:value","selected"],setup(l,{emit:y}){const r=l,v=y,c=N(null),a=N(""),p=d=>{if(!d.ctrlKey)return;const{selectionStart:_,selectionEnd:i}=c.value;v("selected",{start:_,end:i})};return E(a,d=>v("update:value",d)),E(()=>r.value,d=>a.value=d,{immediate:!0}),(d,_)=>{const i=A("verify");return m((f(),g("textarea",{class:"scrollbar textarea","onUpdate:modelValue":_[0]||(_[0]=U=>a.value=U),disabled:l.disabled,placeholder:l.disabled?"":l.placeholder,onKeydown:se(p,["q"]),ref_key:"textarea",ref:c},null,40,be)),[[Q,a.value,void 0,{lazy:!0,trim:!0}],[i,void 0,void 0,{check:!0}]])}}},q=P(xe,[["__scopeId","data-v-c1e57f9a"]]),u=l=>(ae("data-v-29eacd18"),l=l(),ne(),l),ke={class:"popup_window"},Se={class:"popup_header"},$e={class:"popup_close",title:"キャンセル"},Ce={class:"popup_container scrollbar"},Ue={class:"contents"},Te={class:"contents"},Le={class:"popup_label"},Be=u(()=>t("div",{class:"-col-2"},null,-1)),Ie={class:"contents"},Ee=u(()=>t("span",{class:"popup_label"},"内容",-1)),Me={class:"contents"},Oe={class:"contents"},De=u(()=>t("span",{class:"popup_label"},"話し手",-1)),Ge={class:"popup_input"},Ne={class:"contents"},Ve=u(()=>t("span",{class:"popup_label"},"話し手",-1)),He={class:"col-span-2 flex justify-end gap-3 sm:col-span-1"},ze={class:"popup_group"},Pe=u(()=>t("span",{class:"popup_group_title"},"・立ち絵1",-1)),Ae={class:"contents"},Ke=u(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),Re=u(()=>t("option",{value:""},"非表示",-1)),je=["value"],Fe={class:"contents"},We=u(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),qe=u(()=>t("option",{value:""},"継ぐ",-1)),Je={class:"contents"},Qe=u(()=>t("span",{class:"popup_label"},"エフェクト",-1)),Xe={class:"popup_group"},Ye=u(()=>t("span",{class:"popup_group_title"},"・立ち絵2",-1)),Ze={class:"contents"},et=u(()=>t("span",{class:"popup_label"},"キャラ指定",-1)),tt=u(()=>t("option",{value:""},"非表示",-1)),st=["value"],ot={class:"contents"},lt=u(()=>t("span",{class:"popup_label"},"キャラ差分",-1)),at=u(()=>t("option",{value:""},"継ぐ",-1)),nt={class:"contents"},it=u(()=>t("span",{class:"popup_label"},"エフェクト",-1)),ut=u(()=>t("option",{value:""},"なし",-1)),ct={class:"contents"},pt=u(()=>t("span",{class:"popup_label"},"SE",-1)),dt={class:"contents"},rt=u(()=>t("span",{class:"popup_label"},"ボイス",-1)),vt={class:"contents"},_t=u(()=>t("span",{class:"popup_label"},"セリフ",-1)),ht={class:"-col-3 grid gap-1"},mt=u(()=>t("span",{class:"text-right text-xs opacity-50"},"セリフにキーワードを指定したい場合は、文字を[ ]で囲んでください。",-1)),ft={class:"contents"},gt=u(()=>t("span",{class:"popup_label"},"備考",-1)),yt={__name:"EditPopup",props:{open:{type:[Boolean],default:!1},id:{type:[Number,String],default:""},type:{type:[String],default:""}},emits:["update:open","add","target"],setup(l,{emit:y}){const r=l,v=y,c=oe(),{getCharacter:a}=c,{characterList:p}=F(c),d=le(),{newLog:_}=d,{chapterData:i}=F(d),{isDev:U,findData:w}=J(),e=N({}),x=B(()=>[{id:"UI",show:e.value.is_scene},{id:"BG",show:e.value.is_scene},{id:"BGM",show:e.value.is_scene},{id:"CG",show:e.value.is_perform},{id:"暗場",show:e.value.is_perform}]),b=[{id:"",title:"全"},{id:"前"},{id:"後"},{id:"續"}],k=B(()=>p.value.map(n=>({id:n.name,unknown:n.unknown,disabled:n.disabled})).filter(n=>!n.disabled||n.unknown)),M=B(()=>O(e.value.顯示角色));B(()=>O(e.value.立ち絵2));const O=n=>{var S;return(((S=a(n))==null?void 0:S.sprite)??[]).map(o=>({id:o.name}))},D=()=>{e.value.show_time==="CG"&&e.value.show_name==="結束"||(e.value.show_name="")},L=n=>e.value[n]="",V=()=>{const n={...e.value};if(r.id==="add")v("add",n);else{const S=w(i.value,r.id);Object.assign(S,n)}v("update:open",!1),(!n.is_showtime||n.show_time==="暗場")&&v("target",n.id)},H=n=>{const s=n.target.matches(".popup_window, .popup_window *"),S=n.target.matches(".popup_close");(!s||S)&&v("update:open",!1)};return E(()=>r.open,n=>{n&&(r.id==="add"?e.value=_(r.type):e.value={...w(i.value,r.id)},U&&console.log({...e.value}))}),(n,s)=>{const S=A("visible");return m((f(),g("section",{class:"popup",onClick:H},[t("div",ke,[t("header",Se,[t("button",$e,[h(C(me),{class:"pointer-events-none"})])]),t("div",Ce,[m(t("div",Ue,[t("div",Te,[t("span",Le,G(e.value.人物),1),h(T,{class:"popup_select",value:e.value.show_time,"onUpdate:value":s[0]||(s[0]=o=>e.value.show_time=o),options:x.value,onChange:D},null,8,["value","options"])]),Be,t("div",Ie,[Ee,m(h(K,{class:"popup_input -col-3",value:e.value.show_name,"onUpdate:value":s[1]||(s[1]=o=>e.value.show_name=o)},null,8,["value"]),[[$,e.value.show_time!=="暗場"]]),m(h(T,{class:"popup_select -col-3",value:e.value.show_name,"onUpdate:value":s[2]||(s[2]=o=>e.value.show_name=o),options:b},null,8,["value"]),[[$,e.value.show_time==="暗場"]])])],512),[[$,e.value.is_showtime]]),m(t("div",Me,[m(t("div",Oe,[De,t("span",Ge,G(e.value.人物),1)],512),[[$,e.value.is_announce||e.value.is_system]]),m(t("div",Ne,[Ve,h(T,{class:"popup_select",value:e.value.人物,"onUpdate:value":s[3]||(s[3]=o=>e.value.人物=o),options:k.value},null,8,["value","options"])],512),[[$,!(e.value.is_announce||e.value.is_system)]]),t("div",He,[t("button",{class:I(["popup_switch text-replay",{"-active bg-replay":e.value.is_replay}]),onClick:s[4]||(s[4]=o=>e.value.is_replay=!e.value.is_replay),title:"再放送"},"再放送",2),t("button",{class:I(["popup_switch text-unknown",{"-active bg-unknown":e.value.is_unknown}]),onClick:s[5]||(s[5]=o=>e.value.is_unknown=!e.value.is_unknown),title:"未解明"},"未解明",2),t("button",{class:I(["popup_switch -monolog",{"-active":e.value.is_monolog}]),onClick:s[6]||(s[6]=o=>e.value.is_monolog=!e.value.is_monolog),title:"独り言"},"独り言",2)]),t("div",ze,[Pe,t("div",Ae,[Ke,h(T,{class:"popup_select",value:e.value.顯示角色,"onUpdate:value":s[7]||(s[7]=o=>e.value.顯示角色=o),onChange:s[8]||(s[8]=o=>L("角色差分"))},{default:z(()=>[Re,(f(!0),g(R,null,j(k.value,o=>m((f(),g("option",{value:o.id},G(o.id),9,je)),[[$,!o.unknown]])),256))]),_:1},8,["value"])]),t("div",Fe,[We,h(T,{class:"popup_select",value:e.value.角色差分,"onUpdate:value":s[9]||(s[9]=o=>e.value.角色差分=o),options:M.value},{default:z(()=>[qe]),_:1},8,["value","options"])]),t("div",Je,[Qe,h(K,{class:"popup_input",value:e.value.差分特效,"onUpdate:value":s[10]||(s[10]=o=>e.value.差分特效=o)},null,8,["value"])])]),t("div",Xe,[Ye,t("div",Ze,[et,h(T,{class:"popup_select",value:e.value.立ち絵2,"onUpdate:value":s[11]||(s[11]=o=>e.value.立ち絵2=o),onChange:s[12]||(s[12]=o=>L("十六夜差分"))},{default:z(()=>[tt,(f(!0),g(R,null,j(k.value,o=>m((f(),g("option",{value:o.id},G(o.id),9,st)),[[$,!o.unknown]])),256))]),_:1},8,["value"])]),t("div",ot,[lt,h(T,{class:"popup_select",value:e.value.十六夜差分,"onUpdate:value":s[13]||(s[13]=o=>e.value.十六夜差分=o),options:M.value},{default:z(()=>[at]),_:1},8,["value","options"])]),t("div",nt,[it,h(T,{class:"popup_select",value:e.value.主角特效,"onUpdate:value":s[14]||(s[14]=o=>e.value.主角特效=o)},{default:z(()=>[ut]),_:1},8,["value"])])]),t("div",ct,[pt,h(K,{class:"popup_input",value:e.value.SE,"onUpdate:value":s[15]||(s[15]=o=>e.value.SE=o)},null,8,["value"])]),t("div",dt,[rt,h(K,{class:"popup_input",value:e.value.Voice,"onUpdate:value":s[16]||(s[16]=o=>e.value.Voice=o)},null,8,["value"])]),t("div",vt,[_t,t("div",ht,[h(q,{class:"popup_input -textarea",value:e.value.和訳,"onUpdate:value":s[17]||(s[17]=o=>e.value.和訳=o)},null,8,["value"]),mt])])],512),[[$,!e.value.is_showtime]]),t("div",ft,[gt,h(q,{class:"popup_input -textarea -col-3",value:e.value.備註,"onUpdate:value":s[18]||(s[18]=o=>e.value.備註=o)},null,8,["value"])])]),t("footer",{class:"popup_footer"},[t("button",{class:"popup_submit",onClick:V,title:"保存"},"保存")])])])),[[S,l.open]])}}},Ct=P(yt,[["__scopeId","data-v-29eacd18"]]),wt={class:"dialog_wrap"},bt=["data-content","innerHTML"],xt={__name:"Dialog",props:{value:{type:[String],default:""},type:{type:[String],default:""}},setup(l){X(i=>({"35896f63":C(a).lineHeight,"4d5ca058":C(a).letterSpace,"15be853d":C(a).fontLength,f66c4386:C(p).keyword.dark,"729921a5":C(p).monolog.dark,"0085a039":C(p).announce.dark}));const y=l,r=ie(),{fontFamily:v,fontWeight:c,fontStyle:a}=F(r),{colors:p}=Y(),d=B(()=>{const i=new RegExp("((\\[.*?\\])|(\\[.+))","gs"),U=_("keyword"),e=y.value.replace(i,`<span class="${U}" data-content="$1">$1</span>`).replace(/\[|\]/g,"");return{value:y.value.replace(/\[|\]/g,""),html:e}}),_=i=>({keyword:"text-keyword stroke",monolog:"text-monolog stroke",announce:"text-announce stroke"})[i]??"text-white";return(i,U)=>(f(),g("div",{class:I(["dialog",[C(v).dialog,C(c).dialog]])},[t("div",wt,[t("pre",{class:I(_(l.type)),"data-content":d.value.value,innerHTML:d.value.html},null,10,bt)])],2))}},Ut=P(xt,[["__scopeId","data-v-0b46230a"]]);export{Ut as D,Ct as E,$t as M,K as _};
